if(typeof Sina=="undefined"){Sina={}}Sina.pkg=function(c){if(!c||!c.length){return null}var d=c.split(".");var b=Sina;for(var a=(d[0]=="Sina")?1:0;a<d.length;++a){b[d[a]]=b[d[a]]||{};b=b[d[a]]}return b};function $E(b){var a=typeof b=="string"?document.getElementById(b):b;if(a!=null){return a}return null}function $C(a){return document.createElement(a)}function $N(a){return document.getElementsByName(a)}function $T(b,a){return b.getElementsByTagName(a)}try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}(function(){var b=function(f,d){var c=f;return function(){return c.apply(d,arguments)}};var a="Debug";if(window[a]==null||typeof window[a].log=="undefined"){window[a]={cacheData:[],base_url:"http://sjs.sinajs.cn/bind2/",product:scope.$PRODUCT_NAME,baseColor:{1:{color:"#FFF",bgcolor:"#E00"},2:{color:"#F00"},3:{color:"#FFF000"},4:{color:"#0F0"},5:{color:"#FFF"}},fatal:function(c){this.addData(c,1)},error:function(c){this.addData(c,2)},warning:function(c){this.addData(c,3)},info:function(c){this.addData(c,4)},log:function(c){this.addData(c,5)},dir:function(c){this.addData(c,5)},addData:function(d,c,f,g){if(d==null){return}if(typeof d!="object"){d=d.toString()}var i={type:c||"5",color:f||this.baseColor[c].color,bgcolor:g||this.baseColor[c].bgcolor};this.cacheData.push([d,i]);if(this.initFinished==true){this.showCurrentData([d,i])}}};window.trace=b(window[a].log,window[a]);window.traceError=b(window[a].error,window[a])}})();Sina.pkg("Core");if(typeof Core=="undefined"){Core=Sina.Core}Sina.pkg("Core.Array");Core.Array.foreach=function(d,c){if(d==null&&d.constructor!=Array){return[]}var f=0,b=d.length,g=[];while(f<b){var a=c(d[f],f);if(a!==null){g[g.length]=a}f++}return g};Sina.pkg("Core.Events");(function(k){var g=navigator.userAgent.toLowerCase();var a={$winXP:/windows nt 5.1/.test(g),$winVista:/windows nt 6.0/.test(g),$win7:/windows nt 6.1/.test(g),$macOS:/mac/.test(g)};var c={$OPERA:false,$IE6:false,$IE7:false,$IE8:false,$IE9:false,$SAFARI:false,$FF2:false,$FF3:false,$FF4:false,$FF:false,$CHROME:false,$TT:false,$360:false,$SOGO:false,$Maxthon:false};var i={$IE:0,$MOZ:false,$WEBKIT:false,$KHTML:false};if(/opera/.test(g)||k.opera){c.$OPERA=true}else{if(/chrome\/(\S+)/.test(g)){c.$CHROME=true}else{if(/safari\/(\S+)/.test(g)){c.$SAFARI=true}else{if(/msie/.test(g)){i.$IE=true;if(/360se/.test(g)){c.$360=true}else{if(/tencenttraveler/.test(g)){c.$TT=true}else{if(/se\s\S+\smetasr\s\d+\.\d+/.test(g)){c.$SOGO=true}}}var b=g.match(/msie (\d+)/);var f=parseInt(b[1]);i.$IE=f;if(f===8){c.$IE8=true}else{if(f===6){c.$IE6=true}else{if(f===9){c.$IE9=true}else{if(f===7){c.$IE7=true}else{if(f===10){c.$IE10=true}}}}}}else{if(/firefox/.test(g)){var b=g.match(/firefox\/(\d+)/);c.$FF=parseInt(b[1]);if(/firefox\/3/.test(g)){c.$FF3=true}else{if(/firefox\/4/.test(g)){c.$FF4=true}else{if(/firefox\/2/.test(g)){c.$FF2=true}}}}}}}}try{var l=window.external;c.$Maxthon=l.max_version?true:false}catch(d){}if(/applewebkit\/(\S+)/.test(g)){i.$WEBKIT=true}else{if(/khtml\/(\S+)/.test(g)){i.$KHTML=true}else{if(/rv:([^\)]+)\) gecko\/\d{8}/.test(g)){i.$MOZ=true}}}c.$MOBILE=/mobile/i.test(g);if(!c.$MOBILE){c.$MOBILE=/HTC/.test(g)}function j(o,m){var n;for(n in m){o[n]=m[n]}}j(k,c);j(k,i);j(k,a)})(window);Core.Events.addEvent=function(g,d,c,a){var f=typeof g=="string"?$E(g):g;if(f==null){trace("addEvent 找不到对象："+g);return}if(typeof a=="undefined"){a=false}if(typeof c=="undefined"){c="click"}if(f.addEventListener){if(c=="mousewheel"&&$FF){c="DOMMouseScroll"}f.addEventListener(c,d,a);return true}else{if(f.attachEvent){var b=f.attachEvent("on"+c,d);return true}else{f["on"+c]=d}}};Core.Events.removeEvent=function(a,b,c){var d=$E(a);if(d==null){trace("removeEvent 找不到对象："+a);return}if(typeof b!="function"){return}if(typeof c=="undefined"){c="click"}if(d.addEventListener){d.removeEventListener(c,b,false)}else{if(d.attachEvent){d.detachEvent("on"+c,b)}}b[c]=null};Sina.pkg("Core.Function");Core.Function.bind3=function(d,c,b){b=b==null?[]:b;var a=d;return function(){return a.apply(c,b)}};Core.Array.findit=function(a,c){var b=-1;Core.Array.foreach(a,function(f,d){if(c==f){b=d}});return b};window.onerror=function(c,b,a){trace("Error occured:"+c+"<br/>file:"+b+"<br/>line:"+a+"<br/>");return true};function Jobs(a){this.option=a||{};this._jobTable=[[],[],[],[]]}Jobs.prototype={_registedJobTable:{},errorMsg:[],_registJob:function(b,a){this._registedJobTable[b]=a},error:function(a){Debug.error(a);this.errorMsg.push(a)},add:function(b,a){a=a||1;if(Core.Array.findit(this._jobTable[a],b)==-1){this._jobTable[a].push(b)}else{this.error("Error: Job <b>"+b+"</b> is existed now.")}},start:function(){if(this.option.onStart!=null){this.option.onStart()}var c=this._registedJobTable;var a=this._jobTable[1].concat(this._jobTable[2]);var d=this;this.fe=Core.Function.bind3(d.focus,d,[]);var b=function(){if(d._jobTable[3].length==0){if(d.option.onEnd!=null){d.option.onEnd()}return}Core.Events.addEvent(document.body,d.fe,"focus");Core.Events.addEvent(window,d.fe,"scroll");Core.Events.addEvent(document.body,d.fe,"mousemove");Core.Events.addEvent(document.body,d.fe,"mouseover")};this.queue(a,b)},focus:function(){var b=this;if(this.focusdown){Core.Events.removeEvent(document.body,b.fe,"focus");Core.Events.removeEvent(window,b.fe,"scroll");Core.Events.removeEvent(document.body,b.fe,"mousemove");Core.Events.removeEvent(document.body,b.fe,"mouseover");b.fe=null;return}this.focusdown=true;var a=this._jobTable[3];this.queue(a,this.option.onEnd)},queue:function(a,k){var j=this;var b=function(){return new Date().valueOf()};var c=this._registedJobTable;var g=a.length;var f=0;var d=window.setInterval(function(){if(f>=g){clearInterval(d);d=null;if(k!=null){k()}return}var p=a[f];var n=c[p];f++;if(typeof n=="undefined"){j.error("<b>Job["+p+"] is undefiend!!!</b>");return}var m=true;var l=b();try{n.call()}catch(o){j.error("<b>Job["+p+"] failed!!!</b>"+o.message+"");if(k!=null){k()}m=false;throw o}finally{if(m){var i=b();Debug.info("<b>Job["+p+"] done in "+(i-l)+"ms.</b>")}}},10)},call:function(b,a){if(typeof this._registedJobTable[b]!="undefined"){this._registedJobTable[b].apply(this,a)}else{trace("<b>Job["+b+"] is undefined!!!</b>",{color:"#900",bgColor:"#FFF;"})}}};$registJob=function(b,a){Jobs.prototype._registJob(b,a)};$callJob=function(b){var a=[];if(arguments.length>1){Core.Array.foreach(arguments,function(c,d){a[d]=c});a.shift()}Jobs.prototype.call(b,a)};if(typeof Lib=="undefined"){Lib={}}Lib.pkg=function(c){if(!c||!c.length){return null}var d=c.split(".");var b=Lib;for(var a=(d[0]=="Lib")?1:0;a<d.length;++a){b[d[a]]=b[d[a]]||{};b=b[d[a]]}return b};(function(){function a(c){function b(){}b.prototype=c;return new b()}Function.prototype.$define=function(c){var b;for(b in c){this.prototype[b]=c[b]}if(this.__interface__){for(b in this.prototype){if(this.prototype[b]==="NI"){throw new Error("类定义错误，接口方法["+b+"]未实现")}}}this.prototype.constructor=this;this.$extends=this.$define=this.$implements=function(){throw new Error("$define语句定义后面不能再作其它定义")};return this};Function.prototype.$extends=function(){var f=this,c=arguments.length,b,d;if(c===0){throw new Error("$extends语句错误：未指定父类")}b=arguments[0];d=function(){b.apply(this,arguments);f.apply(this,arguments)};d.prototype=a(b.prototype);d.prototype.constructor=d;d.$super=b.prototype;return d};Function.prototype.$implements=function(){var b=Array.prototype.slice.call(arguments,0),f,d=b.length,c;while(d--){if(typeof b[d]!=="object"){throw new Error("$implements语句错误：参数必须为object类型")}for(c in b[d]){typeof this.prototype[c]==="undefined"&&(this.prototype[c]="NI")}}this.__interface__=true;this.$extends=function(){throw new Error("$extends语句错误:$extends语句不能出现在$implements定义之后")};return this}})();Core.Events.getEvent=function(){return window.event};if(!$IE||$IE>8){Core.Events.getEvent=function(){if(!$IE&&window.event){return window.event}var b=arguments.callee.caller;var a;var c=0;while(b!=null&&c<40){a=b.arguments[0];if(a&&(a.constructor==Event||a.constructor==MouseEvent)){return a}c++;b=b.caller}return a}}Core.Events.stopEvent=function(a){var b=a?a:Core.Events.getEvent();if(b!=null){b.cancelBubble=true;b.returnValue=false}};if(!$IE||$IE>8){Core.Events.stopEvent=function(a){var b=a?a:Core.Events.getEvent();if(b!=null){b.preventDefault();b.stopPropagation()}}}Sina.pkg("Ui");if(typeof Ui=="undefined"){Ui=Sina.Ui}Core.Function.bind2=function(c,b){var a=c;return function(){return a.apply(b,arguments)}};Function.prototype.bind2=function(b){var a=this;return function(){return a.apply(b,arguments)}};Ui.Template=function(a){this.tmpl=a;this.pattern=/(#\{(.*?)\})/g};Ui.Template.prototype={evaluate:function(a){return this.tmpl.replace(this.pattern,function(){return a[arguments[2]]||""})},evaluateMulti:function(c,a){var b=[];Core.Array.foreach(c,Core.Function.bind2(function(d,f){f=a?c.length-f:f;b[f]=this.evaluate(d)},this));return b.join("")}};Sina.pkg("Core.Dom");Core.Dom.setStyle=function(a,b,c){switch(b){case"opacity":a.style.filter="alpha(opacity="+(c*100)+")";if(!a.currentStyle||!a.currentStyle.hasLayout){a.style.zoom=1}break;case"float":b="styleFloat";default:a.style[b]=c}};if(!$IE||!($IE<9)){Core.Dom.setStyle=function(a,b,c){if(b=="float"){b="cssFloat"}a.style[b]=c}}(function(){Core.Function.defineGetter=function(g,f,d){if(f instanceof Array&&d instanceof Array){var c=Math.min(f.length,d.length);while(c--){if(typeof f[c]==="string"&&b(d[c])){g[f[c]]={valueOf:(function(i){return function(){return a(g,d[i])}})(c),toString:this.valueOf}}}}else{if(typeof f==="string"&&b(d)){g[f]={valueOf:function(){return a(g,d)},toString:this.valueOf}}}};function b(c){return typeof c!=="string"&&String.prototype.slice.call(c,0,8)=="function"}function a(f,d){var c=d.call(f);return typeof c==="string"||typeof c==="number"?c:null}})();Ui.IE6FixedController=function(){var a=this;this.node=null;this.iframeNode=null;this.__orgX=0;this.__orgY=0;this.__isBindScroll=false;this.__fixedHandle=function(){if(a.node){a.node.style.left=document.documentElement.scrollLeft+a.__orgX+"px";a.node.style.top=document.documentElement.scrollTop+a.__orgY+"px"}if(a.iframeNode){a.iframeNode.style.left=a.node.style.left;a.iframeNode.style.top=a.node.style.top}}}.$define({setFixed:function(a,b){this.updateOrgPosition();if(b&&!this.__isBindScroll){Core.Events.addEvent(window,this.__fixedHandle,"scroll");this.__isBindScroll=true}if(!b&&this.__isBindScroll){Core.Events.removeEvent(window,this.__fixedHandle,"scroll");this.__isBindScroll=false}},setPosition:function(b,a,c){if(typeof c.x!=="undefined"){if(a){b.style.left=c.x+document.documentElement.scrollLeft+"px";this.__orgX=parseInt(this.node.style.left)-document.documentElement.scrollLeft}else{b.style.left=c.x+"px"}}if(typeof c.y!=="undefined"){if(a){b.style.top=c.y+document.documentElement.scrollTop+"px";this.__orgY=parseInt(this.node.style.top)-document.documentElement.scrollTop}else{b.style.top=c.y+"px"}}typeof c.z!=="undefined"&&(b.style.zIndex=c.z)},getX:function(b,a){if(a){return parseInt(b.style.left)-document.documentElement.scrollLeft}else{return parseInt(b.style.left)}},getY:function(b,a){if(a){return parseInt(b.style.top)-document.documentElement.scrollTop}else{return parseInt(b.style.top)}},updateIframe:function(a){this.setFixed(this.iframeNode,a);a&&this.__fixedHandle()},updateOrgPosition:function(){if(!this.node){return}this.__orgX=parseInt(this.node.style.left)-document.documentElement.scrollLeft;this.__orgY=parseInt(this.node.style.top)-document.documentElement.scrollTop},destroy:function(){Core.Events.removeEvent(window,this.__fixedHandle,"scroll");this.__isBindScroll=false;this.node=null;this.iframeNode=null}});Core.Events.EventDispatcher=function(a){this.__target=a;this.__events={}}.$define({addEventListener:function(b,c){if(!this.__checkFunction(c)){return}var a=this.__events;b=b.toLowerCase();!a[b]&&(a[b]=[]);a[b].push(c)},removeEventListener:function(c,d){var a=this.__events[c];c=c.toLowerCase();if(!this.__checkFunction(d)||!a||!a.length){return}for(var b=a.length-1;b>=0;b--){(a[b]==d)&&a.splice(b,1)}},dispatchEvent:function(f){f=f.toLowerCase();var b=this.__events[f];if(!b||!b.length){return}var c=Array.prototype.slice.call(arguments,0);c.shift();for(var d=0,a=b.length;d<a;d++){b[d].apply(this.__target,c)}},__checkFunction:function(a){return typeof a!=="string"&&String.prototype.slice.call(a,0,8)=="function"}});Ui.IRenderer={setCanShow:function(a){},setCanHidden:function(a){},show:function(a){},hidden:function(a){},addEventListener:function(a,b){},removeEventListener:function(a,b){}};Ui.SimpleRenderer=function(){this.__canShow=true;this.__canHidden=true;this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$implements(Ui.IRenderer).$define({setCanShow:function(a){this.__canShow=!!a},setCanHidden:function(a){this.__canHidden=!!a},show:function(a){this.__eventDispatcher.dispatchEvent("beforeShow");if(this.__canShow){a.style.display="";this.__eventDispatcher.dispatchEvent("show")}return this},hidden:function(a){this.__eventDispatcher.dispatchEvent("beforeHidden");if(this.__canHidden){a.style.display="none";this.__eventDispatcher.dispatchEvent("hidden")}return this},addEventListener:function(a,b){this.__eventDispatcher.addEventListener(a,b);return this},removeEventListener:function(a,b){this.__eventDispatcher.removeEventListener(a,b);return this}});Ui.DisplayObject=function(b,c){Core.Function.defineGetter(this,["x","y","z","width","height"],[this.__getX,this.__getY,this.__getZ,this.__getWidth,this.__getHeight]);this.__renderer=null;this.__entity=c;this.__isInited=false;this.__parent=b||document.body;this.__eventDispatcher=new Core.Events.EventDispatcher(this);var a=this.__eventDispatcher;this.__onBeforeShow=function(){a.dispatchEvent("beforeShow")};this.__onShow=function(){a.dispatchEvent("show")};this.__onBeforeHidden=function(){a.dispatchEvent("beforeHidden")};this.__onHidden=function(){a.dispatchEvent("hidden")};this.__updateRenderer(Ui.SimpleRenderer)}.$define({isShow:!1,isHidden:!0,setPosition:function(a){!this.__isInited&&this.__initEntity();typeof a.x!=="undefined"&&(this.__entity.style.left=a.x+"px");typeof a.y!=="undefined"&&(this.__entity.style.top=a.y+"px");typeof a.z!=="undefined"&&(this.__entity.style.zIndex=a.z);return this},setSize:function(a){!this.__isInited&&this.__initEntity();typeof a.width!=="undefined"&&(this.__entity.style.width=a.width+"px");typeof a.height!=="undefined"&&(this.__entity.style.height=a.height+"px");return this},setRenderer:function(a){!this.__isInited&&this.__initEntity();this.__updateRenderer(a);return this},show:function(a){this.isHidden=!1;this.isShow=!0;!this.__isInited&&this.__initEntity();this.__updateRenderer(a);this.__renderer.show(this.__entity);return this},hidden:function(a){return this.hide(a)},hide:function(a){this.isHidden=!0;this.isShow=!1;!this.__isInited&&this.__initEntity();this.__updateRenderer(a);this.__renderer.hidden(this.__entity);return this},setCanShow:function(a){this.__renderer.setCanShow(a);return this},setCanHidden:function(a){this.__renderer.setCanHidden(a);return this},addEventListener:function(a,b){this.__eventDispatcher.addEventListener(a,b);return this},removeEventListener:function(a,b){this.__eventDispatcher.removeEventListener(a,b);return this},destroy:function(){if(!this.__entity){return}!this.__isInited&&this.__initEntity();this.__entity.parentNode&&this.__entity.parentNode.removeChild(this.__entity);this.__entity=null},__initEntity:function(){var a;!this.__entity&&(this.__entity=$C("div"));a=this.__entity.style;a.position="absolute";a.left=0;a.top=0;!this.__entity.parentNode&&this.__parent.appendChild(this.__entity);this.__isInited=true},__updateRenderer:function(a){if(!a){return}var b=function(){this.__renderer.addEventListener("beforeShow",this.__onBeforeShow).addEventListener("show",this.__onShow).addEventListener("beforeHidden",this.__onBeforeHidden).addEventListener("hidden",this.__onHidden)};if(!this.__renderer){this.__renderer=new a();b.call(this)}else{if(this.__renderer.constructor!==a){this.__renderer.removeEventListener("beforeShow",this.__onBeforeShow).removeEventListener("show",this.__onShow).removeEventListener("beforeHidden",this.__onBeforeHidden).removeEventListener("hidden",this.__onHidden);this.__renderer=new a();b.call(this)}}},__getX:function(){!this.__isInited&&this.__initEntity();return parseInt(this.__entity.style.left)},__getY:function(){!this.__isInited&&this.__initEntity();return parseInt(this.__entity.style.top)},__getZ:function(){!this.__isInited&&this.__initEntity();return parseInt(this.__entity.style.zIndex)},__getWidth:function(){!this.__isInited&&this.__initEntity();return this.__getSize(this.__entity,"offsetWidth")},__getHeight:function(){!this.__isInited&&this.__initEntity();return this.__getSize(this.__entity,"offsetHeight")},__getSize:function(c,f){var d=c,a,b=d.style.visibility;if(d.style.display=="none"){d.style.visibility="hidden";d.style.display="";a=d[f];d.style.display="none";d.style.visibility=b}else{a=d[f]}return a}});Ui.Panel=function(a,b){this.nodes={};this.uniqueID=this.__getUniqueID();this.entity=null;this.__iframe=null;this.__isSetAdamant=false;this.__templateNodesIDs=[];this.__isFixed=false;$IE6&&(this.__ie6FixedController=new Ui.IE6FixedController())}.$extends(Ui.DisplayObject).$define({setTemplate:function(a){var b=$C("div");b.innerHTML=new Ui.Template(a).evaluate(this.__getNodes(a,"i"));b.style.display="none";this.__parent.appendChild(b);this.__updateTemplate(b);this.nodes=this.__getNodes(a);this.entity=this.__entity;this.nodes.panel=this.entity;return this},setFixed:function(b){!this.__isInited&&this.__initEntity();var a=parseInt(this.__entity.style.left),c=parseInt(this.__entity.style.top);if($IE6){this.__ie6FixedController.setFixed(this.__entity,b);this.__isSetAdamant&&this.__ie6FixedController.setFixed(this.__iframe,b)}else{if(b&&!this.__isFixed){this.setPosition({x:a-Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),y:c-Math.max(document.documentElement.scrollTop,document.body.scrollTop)});this.__entity.style.position="fixed"}if(!b&&this.__isFixed){this.setPosition({x:a+Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),y:c+Math.max(document.documentElement.scrollTop,document.body.scrollTop)});this.__entity.style.position="absolute"}}this.__isFixed=!!b;this.__updateIframe();return this},setAdamant:function(a){this.__isSetAdamant=!!a;this.__isSetAdamant&&!this.__iframe&&this.__createIframe();this.__updateIframe();return this},destroy:function(){if(!this.__entity){return}Ui.Panel.$super.destroy.call(this);this.__ie6FixedController&&this.__ie6FixedController.destroy();this.__iframe&&this.__iframe.parentNode.removeChild(this.__iframe)},setPosition:function(a){!this.__isInited&&this.__initEntity();if($IE6){this.__ie6FixedController.setPosition(this.__entity,this.__isFixed,a)}else{Ui.Panel.$super.setPosition.call(this,a)}this.__updateIframe();return this},setSize:function(a){Ui.Panel.$super.setSize.call(this,a).__updateIframe();return this},show:function(a){Ui.Panel.$super.show.call(this,a).__updateIframe();return this},hidden:function(a){Ui.Panel.$super.hidden.call(this,a).__updateIframe();return this},__getX:function(){!this.__isInited&&this.__initEntity();if($IE6){return this.__ie6FixedController.getX(this.__entity,this.__isFixed)}else{return parseInt(this.__entity.style.left)}},__getY:function(){!this.__isInited&&this.__initEntity();if($IE6){return this.__ie6FixedController.getY(this.__entity,this.__isFixed)}else{return parseInt(this.__entity.style.top)}},__createIframe:function(){this.__iframe=$C("iframe");this.__iframe.frameBorder="none";this.__parent.insertBefore(this.__iframe,this.__entity);Core.Dom.setStyle(this.__iframe,"opacity",0);this.__ie6FixedController&&(this.__ie6FixedController.iframeNode=this.__iframe);this.__updateIframe()},__updateIframe:function(){if(this.__iframe){var a=this.__iframe.style;a.backgroundColor="#ffffff";a.left=this.x+"px";a.top=this.y+"px";a.width=this.width+"px";a.height=this.height+"px";a.position=this.__entity.style.position;a.display=this.__entity.style.display;a.zIndex=this.__entity.style.zIndex;$IE6&&this.__ie6FixedController.updateIframe(this.__isFixed)}},__updateIE6FCOrgPosition:function(){this.__ie6FixedController&&this.__ie6FixedController.updateOrgPosition()},__updateTemplate:function(j){var a,b,i,f,g,c=this.__entity;if(c){c.parentNode&&c.parentNode.removeChild(c);a=c.style.left;b=c.style.top;i=c.style.zIndex;f=c.style.position;g=c.style.display}else{g="none"}c=this.__entity=$E("_"+this.uniqueID+"_panel");if(!c){c=this.__entity=$E("_"+this.uniqueID+"_entity")}if(!c){throw new Error("[Panel Error]there missing identifier #{panel} in panel template")}c.style.left=a||0;c.style.top=b||0;c.style.zIndex=i||0;c.style.position=f||"absolute";c.style.display=g;this.__parent.replaceChild(c,j);this.__ie6FixedController&&(this.__ie6FixedController.node=this.__entity)},__getNodes:function(d,k){var a=k||"o",j=/\{[^\}]+(?=\})/g,c,b={},g,f;this.__templateNodesIDs=d.match(j);g=this.__templateNodesIDs;if(g){c=g.length;while(c--){f=g[c].replace("{","");switch(a){case"o":b[f]=$E("_"+this.uniqueID+"_"+f);break;case"i":b[f]="_"+this.uniqueID+"_"+f;break}}}return b},__getUniqueID:function(){return parseInt(Math.random()*1000).toString()+(new Date).getTime().toString()},setContent:function(a){this.nodes.content&&(this.nodes.content.innerHTML=a)},getNodes:function(){return this.nodes}});Ui.Drag=function(c,a,d){var b=this;this.canDrag=true;this.isLock=false;this.lockArea={left:0,right:0,top:0,bottom:0};this.__captureNode=c;this.__dragNodes=[];this.__deltaX=[];this.__deltaY=[];this.__eventDispatcher=new Core.Events.EventDispatcher(this);this.__isDraging=false;this.__canDragX=true;this.__canDragY=true;this.__dragHandle=function(){b.__drag()};this.__mouseDownHandle=function(){b.__isDraging=true;b.__eventDispatcher.dispatchEvent("beforeDrag");b.__setCapture(true)};this.__mouseUpHandle=function(){b.__isDraging&&b.__eventDispatcher.dispatchEvent("afterDrag");b.__isDraging=false;b.__setCapture(false)};this.__initNodes(c,a,d);this.__initCaputerNode()}.$define({addEventListener:function(a,b){this.__eventDispatcher.addEventListener(a,b);return this},removeEventListener:function(a,b){this.__eventDispatcher.removeEventListener(a,b);return this},destroy:function(){Core.Events.removeEvent(this.__captureNode,this.__mouseDownHandle,"mousedown");Core.Events.removeEvent(document,this.__mouseUpHandle,"mouseup");this.__captureNode=null;this.__dragNodes=null},__initNodes:function(d,b,f){if(b){b instanceof Array?this.__dragNodes=b:this.__dragNodes.push(b);(typeof f==="undefined"||f)&&this.__dragNodes.push(this.__captureNode)}else{this.__dragNodes.push(this.__captureNode)}var a=this.__dragNodes,c=a.length;while(c--){!a[c].style.position&&(a[c].style.position="absolute");!a[c].style.left&&(a[c].style.left=0);!a[c].style.top&&(a[c].style.top=0)}},__initCaputerNode:function(){var b=this.__captureNode,a=this;Core.Events.addEvent(b,this.__mouseDownHandle,"mousedown");Core.Events.addEvent(document,this.__mouseUpHandle,"mouseup")},__setCapture:function(d){var f=this.__captureNode,b=this.__dragNodes,a=Core.Events.getEvent(),c=b.length;while(c--){this.__deltaX[c]=a.clientX-parseInt(b[c].style.left);this.__deltaY[c]=a.clientY-parseInt(b[c].style.top)}if(d){if($IE){f.setCapture();Core.Events.addEvent(f,this.__dragHandle,"mousemove")}else{Core.Events.addEvent(document,this.__dragHandle,"mousemove")}}else{if($IE){f.releaseCapture();Core.Events.removeEvent(f,this.__dragHandle,"mousemove")}else{Core.Events.removeEvent(document,this.__dragHandle,"mousemove")}}},__drag:function(){if(!this.canDrag){return}var d=this.__dragNodes,c=Core.Events.getEvent(),f=d.length,g=this.lockArea,b=0,a=0;this.__eventDispatcher.dispatchEvent("drag");while(f--){b=c.clientX-this.__deltaX[f];a=c.clientY-this.__deltaY[f];if(this.isLock){b=Math.min(Math.max(b,g.left),g.right);a=Math.min(Math.max(a,g.top),g.bottom)}d[f].style.left=b+"px";d[f].style.top=a+"px"}}});Ui.IDragger={addEventListener:function(a,b){},removeEventListener:function(a,b){},setDrag:function(b,a,c){},setLock:function(a){},setArea:function(a){},destroy:function(){}};Ui.SimpleDragger=function(){this.__drag=null;this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$implements(Ui.IDragger).$define({addEventListener:function(a,b){if(a.toLowerCase()==="afterdrag"){this.__eventDispatcher.addEventListener(a,b)}else{this.__drag.addEventListener(a,b)}return this},removeEventListener:function(a,b){if(a.toLowerCase()==="afterdrag"){this.__eventDispatcher.removeEventListener(a,b)}else{this.__drag.removeEventListener(a,b)}return this},setDrag:function(c,a,d){var b=this;this.__drag=new Ui.Drag(c,a,d);this.__drag.addEventListener("afterDrag",function(){b.__eventDispatcher.dispatchEvent("afterDrag")});return this},setLock:function(a){this.__drag.isLock=!!a;return this},setArea:function(a){this.__drag.lockArea=a;return this},destroy:function(){this.__drag.destroy()}});Ui.Dialog=function(a,c){var b=this;this.__dragger=null;this.__isBindUpadateAreaEvent=false;this.__isBindUpdateIE6AreaEvent=false;this.__beforeDragHandle=function(){b.__updateDraggerArea();b.__eventDispatcher.dispatchEvent("beforedrag")};this.__dragHandle=function(){b.__isSetAdamant&&b.__updateIframe();b.__eventDispatcher.dispatchEvent("drag")};this.__afterDragHandle=function(){b.__isFixed&&$IE6&&b.__updateIE6FCOrgPosition();b.__eventDispatcher.dispatchEvent("afterdrag")};this.__updateDraggerAreaHandle=function(){setTimeout(function(){b.__updateDraggerArea()},1)};this.__setMiddleHandle=function(){b.setMiddle()}}.$extends(Ui.Panel).$define({setTemplate:function(a){Ui.Dialog.$super.setTemplate.call(this,a);this.__initTitleBar();this.setDragger(Ui.SimpleDragger);return this},setContent:function(a){if(!this.nodes.content){return this}this.nodes.content.innerHTML=new Ui.Template(a).evaluate(this.__getNodes(a,"i"));this.__addContentNodes(this.__getNodes(a));return this},setFixed:function(a){Ui.Dialog.$super.setFixed.call(this,a);if(a){Core.Events.addEvent(window,this.__setMiddleHandle,"resize")}else{Core.Events.removeEvent(window,this.__setMiddleHandle,"resize")}this.__updateDraggerArea();return this},setMiddle:function(){var c=this.__getDocumentSize().height-this.height,b=(Math.sqrt(5)-1)/2,d=1,a=c*b/(b+d),f=this.__getDocumentSize().width/2-this.width/2;if(!this.__isFixed){a+=Math.max(document.documentElement.scrollTop,document.body.scrollTop);f+=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft)}this.setPosition({x:Math.max(f,0),y:Math.max(a,0)});return this},setAreaLocked:function(a){if(!this.__dragger){return this}this.__dragger.setLock(a);return this},setSize:function(a){!this.__isInited&&this.__initEntity();if(this.nodes.content){typeof a.width!=="undefined"&&(this.nodes.content.style.width=a.width+"px");typeof a.height!=="undefined"&&(this.nodes.content.style.height=a.height+"px")}else{typeof a.width!=="undefined"&&(this.__entity.style.width=a.width+"px");typeof a.height!=="undefined"&&(this.__entity.style.height=a.height+"px")}return this},setDragger:function(a){if(!this.nodes.titleBar||!a){return this}if(!this.__dragger){this.__dragger=new a()}else{if(this.__dragger.constructor===a){return this}}this.__updateDragger(a);return this},destroy:function(){if(!this.__entity){return}Ui.Dialog.$super.destroy.call(this);Core.Events.removeEvent(window,this.__updateDraggerAreaHandle,"resize");Core.Events.removeEvent(window,this.__setMiddleHandle,"resize")},__addContentNodes:function(b){var c=this.nodes,a;for(a in b){c[a]=b[a]}},__updateDragger:function(a){if(this.__dragger.constructor!==a){this.__dragger.removeEventListener("beforedrag",this.__beforeDragHandle).removeEventListener("drag",this.__dragHandle).removeEventListener("afterdrag",this.__afterDragHandle);this.__dragger.destroy();this.__dragger=new a()}this.__dragger.setDrag(this.nodes.titleBar,this.__entity,false);this.__dragger.addEventListener("beforedrag",this.__beforeDragHandle).addEventListener("drag",this.__dragHandle).addEventListener("afterdrag",this.__afterDragHandle)},__updateDraggerArea:function(){var c,d,f,a;if(this.__isFixed){c=$IE6?document.documentElement.scrollLeft:0;d=$IE6?document.documentElement.scrollTop:0;f=$IE6?document.documentElement.scrollLeft+this.__getDocumentSize().width-this.width:this.__getDocumentSize().width-this.width;a=$IE6?document.documentElement.scrollTop+this.__getDocumentSize().height-this.height:this.__getDocumentSize().height-this.height}else{c=0;d=0;f=document.documentElement.scrollWidth-this.width;a=document.documentElement.scrollHeight-this.height}this.__dragger.setArea({left:c,top:d,right:f,bottom:a})},__initTitleBar:function(){if(!this.nodes.titleBar){return}var a=this.nodes.titleBar;a.style.cursor="move";if($IE){Core.Events.addEvent(a,function(){return false},"selectstart")}else{a.style.MozUserSelect="none"}},__getDocumentSize:function(){var a=document.documentElement.clientWidth||document.body.clientWidth,b=document.documentElement.clientHeight||document.body.clientHeight;return{width:a,height:b}}});Ui.ModuleDialog=function(c,b,a){this.__bgShadow=null;this.__dialog=null;this.__isInitBgShadow=false;this.__tplConfig=c;this.__iconSet=b;this.__dialogQueue=[];this.__zIndex=(a&&a.zIndex)||5000;this.__cfg=a||{};this.__initDialogEvent()}.$define({alert:function(c,a){a=a||{};var b=this.__createMessageDialog(a.tplConfig||this.__tplConfig.alert,a);b.nodes.text&&(b.nodes.text.innerHTML=c||"");b.show(a.renderer||this.__cfg.renderer).addEventListener("hidden",function(){this.destroy()});b.nodes.linkOk&&b.nodes.linkOk.style.display!=="none"&&b.nodes.linkOk.focus();return b},newAlert:function(c,a,b){a.tplConfig=this.__tplConfig.newAlert;this.alert(c,a,b)},confirm:function(d,a){a=a||{};var c=this.__createMessageDialog(a.tplConfig||this.__tplConfig.confirm,a),b=this;c.nodes.text&&(c.nodes.text.innerHTML=d||"");if(c.nodes.btnCancel){c.nodes.btnCancel.innerHTML=a.textCancel||"取消";Core.Events.addEvent(c.nodes.btnCancel,function(){a.funcCancel&&a.funcCancel.call(c);c.hidden(a.renderer||b.__cfg.renderer);Core.Events.stopEvent()},"click");c.nodes.linkCancel&&Core.Events.addEvent(c.nodes.linkCancel,function(){var f=Core.Events.getEvent();if(f.keyCode=="13"){a.funcCancel&&a.funcCancel.call(c);c.hidden(a.renderer||b.__cfg.renderer)}},"keydown")}c.show(a.renderer||b.__cfg.renderer).addEventListener("hidden",function(){this.destroy()});if(a.defaultButton==0){c.nodes.linkCancel&&c.nodes.linkCancel.style.display!=="none"&&c.nodes.linkCancel.focus()}else{c.nodes.linkOk&&c.nodes.linkOk.style.display!=="none"&&c.nodes.linkOk.focus()}return c},newConfirm:function(c,a,b){a.tplConfig=this.__tplConfig.newConfirm;this.confirm(c,a,b)},create:function(a){var b=this;a=a||{};var c=new Ui.Dialog();c.setTemplate(a.tpl||this.__tplConfig.customs);a.content&&c.setContent(a.content);a.width&&!isNaN(a.width)&&c.setSize({width:a.width});a.height&&!isNaN(a.height)&&c.setSize({height:a.height});return this.__initDialog(c,a)},__initDialogEvent:function(){var a=this.__dialogQueue;Core.Events.addEvent(document,function(){var b=Core.Events.getEvent();if(a.length&&b.keyCode=="27"){a[a.length-1].hidden()}},"keydown")},__createMessageDialog:function(b,a){var f=new Ui.Dialog(),d=this,c;f.setTemplate(b);a.width&&!isNaN(a.width)&&f.setSize({width:a.width});a.height&&!isNaN(a.height)&&f.setSize({height:a.height});f.nodes.subText&&(f.nodes.subText.innerHTML=a.subText||"");if(f.nodes.icon){f.nodes.icon.className=this.__iconSet[a.icon||"01"]["class"];f.nodes.icon.alt=this.__iconSet[a.icon||"01"]["alt"]}if(f.nodes.btnOk){f.nodes.btnOk.innerHTML=a.textOk||"确定";Core.Events.addEvent(f.nodes.btnOk,function(){f.hidden(a.renderer||d.__cfg.renderer);a.funcOk&&a.funcOk.call(f);Core.Events.stopEvent()},"click")}f.nodes.linkOk&&Core.Events.addEvent(f.nodes.linkOk,function(){var g=Core.Events.getEvent();if(g.keyCode=="13"){f.hidden(a.renderer||d.__cfg.renderer);a.funcOk&&a.funcOk.call(f)}},"keydown");f.setDragger(a.dragger||d.__cfg.dragger).setFixed(true).setAreaLocked(true);return this.__initDialog(f,a)},__initDialog:function(c,a){var b=this;a.zIndex&&(b.__zIndex=a.zIndex);c.nodes.titleName&&(c.nodes.titleName.innerHTML=a.title||"提示");if(c.nodes.btnClose){Core.Events.addEvent(c.nodes.btnClose,function(){var d=true;a.funcBeforeClose&&(d=a.funcBeforeClose.call(c)!==false);a.funcClose&&a.funcClose.call(c);d&&c.hidden()},"click");Core.Events.addEvent(c.nodes.btnClose,function(){Core.Events.stopEvent()},"mousedown")}c.setPosition({z:a.zIndex||b.__zIndex});c.setRenderer(a.renderer||this.__cfg.renderer);c.setDragger(a.dragger||this.__cfg.dragger);c.setMiddle();c.addEventListener("beforeHidden",function(){b.__updateDialogQueue(this,"remove")});c.addEventListener("beforeShow",function(){this.nodes.panel.parentNode.appendChild(this.nodes.panel);var d=this;if(!b.__isInitBgShadow){b.__initBGShadow(this,a.isAdamant||b.__cfg.isAdamant)}b.__setBGShadowOpacity(a.bgShadowOpacity!==0?a.bgShadowOpacity||0.4:a.bgShadowOpacity);window.setTimeout(function(){b.__bgShadow.show();b.__updateDialogQueue(d,"add")},1)});c.setTitle=function(d){this.nodes.titleName&&(this.nodes.titleName.innerHTML=d)};c.setHelp=function(d){this.nodes.btnHelp&&(this.nodes.btnHelp.href=d)};c.close=function(){this.hidden()};c.getNodes=function(){return this.nodes};c.getX=function(){return this.x};c.getY=function(){return this.y};c.getWidth=function(){return this.width};c.getHeight=function(){return this.height};return c},__initBGShadow:function(f,d){var a=this.__getDocumentSize().width,b=this.__getDocumentSize().height,c=this;this.__bgShadow=new Ui.Panel();this.__bgShadow.setTemplate('<div id="#{panel}" style="background-color:black"></div>').setSize({width:a,height:b}).setAdamant(d).setFixed(true).setPosition({x:0,y:0,z:c.__zIndex});Core.Events.addEvent(window,function(){c.__bgShadow.setPosition({x:0,y:0}).setSize({width:c.__getDocumentSize().width,height:c.__getDocumentSize().height})},"resize");this.__isInitBgShadow=true},__updateDialogQueue:function(b,d){var a,c;if(d==="add"){this.__dialogQueue.push(b)}else{if(d==="remove"){a=this.__dialogQueue.length;while(a--){this.__dialogQueue[a]===b&&this.__dialogQueue.splice(a,1)}}}if(this.__dialogQueue.length===0){this.__bgShadow.hidden()}else{c=this.__dialogQueue[this.__dialogQueue.length-1];this.__bgShadow.nodes.panel.parentNode.insertBefore(this.__bgShadow.nodes.panel,c.nodes.panel);this.__bgShadow.__iframe&&this.__bgShadow.__iframe.parentNode.insertBefore(this.__bgShadow.__iframe,this.__bgShadow.nodes.panel);c.nodes.linkOk&&c.nodes.linkOk.style.display!=="none"&&c.nodes.linkOk.focus()}},__setBGShadowOpacity:function(a){a=isNaN(a)?0:Math.max(Math.min(a,1),0);Core.Dom.setStyle(this.__bgShadow.nodes.panel,"opacity",a)},__getDocumentSize:function(){var a=document.documentElement.clientWidth||document.body.clientWidth,b=document.documentElement.clientHeight||document.body.clientHeight;return{width:a,height:b}}});Ui.Transition={simple:function(f,a,i,g){return i*f/g+a},backEaseIn:function(f,a,j,i){var g=1.70158;return j*(f/=i)*f*((g+1)*f-g)+a},backEaseOut:function(f,a,j,i){var g=1.70158;return j*((f=f/i-1)*f*((g+1)*f+g)+1)+a},backEaseInOut:function(f,a,j,i){var g=1.70158;if((f/=i/2)<1){return j/2*(f*f*(((g*=(1.525))+1)*f-g))+a}return j/2*((f-=2)*f*(((g*=(1.525))+1)*f+g)+2)+a},bounceEaseOut:function(f,a,i,g){if((f/=g)<(1/2.75)){return i*(7.5625*f*f)+a}else{if(f<(2/2.75)){return i*(7.5625*(f-=(1.5/2.75))*f+0.75)+a}else{if(f<(2.5/2.75)){return i*(7.5625*(f-=(2.25/2.75))*f+0.9375)+a}else{return i*(7.5625*(f-=(2.625/2.75))*f+0.984375)+a}}}},bounceEaseIn:function(f,a,i,g){return i-Transition.bounceEaseOut(g-f,0,i,g)+a},bounceEaseInOut:function(f,a,i,g){if(f<g/2){return Transition.bounceEaseIn(f*2,0,i,g)*0.5+a}else{return Transition.bounceEaseOut(f*2-g,0,i,g)*0.5+i*0.5+a}},regularEaseIn:function(f,a,i,g){return i*(f/=g)*f+a},regularEaseOut:function(f,a,i,g){return -i*(f/=g)*(f-2)+a},regularEaseInOut:function(f,a,i,g){if((f/=g/2)<1){return i/2*f*f+a}return -i/2*((--f)*(f-2)-1)+a},strongEaseIn:function(f,a,i,g){return i*(f/=g)*f*f*f*f+a},strongEaseOut:function(f,a,i,g){return i*((f=f/g-1)*f*f*f*f+1)+a},strongEaseInOut:function(f,a,i,g){if((f/=g/2)<1){return i/2*f*f*f*f*f+a}return i/2*((f-=2)*f*f*f*f+2)+a},elasticEaseIn:function(i,f,m,l){var g,k;if(i==0){return f}if((i/=l)==1){return f+m}k=l*0.3;if(!g||g<Math.abs(m)){g=m;var j=k/4}else{var j=k/(2*Math.PI)*Math.asin(m/g)}return -(g*Math.pow(2,10*(i-=1))*Math.sin((i*l-j)*(2*Math.PI)/k))+f},elasticEaseOut:function(i,f,m,l){var g,k;if(i==0){return f}if((i/=l)==1){return f+m}if(!k){k=l*0.3}if(!g||g<Math.abs(m)){g=m;var j=k/4}else{var j=k/(2*Math.PI)*Math.asin(m/g)}return(g*Math.pow(2,-10*i)*Math.sin((i*l-j)*(2*Math.PI)/k)+m+f)},elasticEaseInOut:function(i,f,m,l){var g,k;if(i==0){return f}if((i/=l/2)==2){return f+m}if(!k){var k=l*(0.3*1.5)}if(!g||g<Math.abs(m)){var g=m;var j=k/4}else{var j=k/(2*Math.PI)*Math.asin(m/g)}if(i<1){return -0.5*(g*Math.pow(2,10*(i-=1))*Math.sin((i*l-j)*(2*Math.PI)/k))+f}return g*Math.pow(2,-10*(i-=1))*Math.sin((i*l-j)*(2*Math.PI)/k)*0.5+m+f}};Ui.TweenStrategy=function(c,a,d,b){this.startValue=c||0;this.endValue=a||0;this.duration=d||0;this.motion=b||Ui.Transition.simple;this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$define({motion:null,duration:0,startValue:0,endValue:0,_itvID:0,_isTweenning:false,addEventListener:function(a,b){this.__eventDispatcher.addEventListener(a,b);return this},removeEventListener:function(a,b){this.__eventDispatcher.removeEventListener(a,b);return this},start:function(){if(this._isTweenning){return}this._isTweenning=true;var g=this,b,a=this.startValue,f=this.endValue,j=this.duration,i,c=(new Date()).getTime();this._itvID=window.setInterval(function(){b=((new Date()).getTime()-c)/1000;b>g.duration&&(b=g.duration);i=g.motion(b,a,f-a,j);g.onTween&&g.onTween(i);g.__eventDispatcher.dispatchEvent("tween",i);b==g.duration&&g.stop()},25);return this},stop:function(){window.clearInterval(this._itvID);this._isTweenning=false;this.onEnd&&this.onEnd();this.__eventDispatcher.dispatchEvent("end");return this},onTween:function(a){},onEnd:function(){}});Ui.OpacityRenderer=function(){this.__canShow=true;this.__canHidden=true;this.__node=null;this.__tween=new Ui.TweenStrategy(0,0,0.6,Ui.Transition.strongEaseOut);this.__state="";this.__lastState="";this.__value=0;this.__node=null;this.__eventDispatcher=new Core.Events.EventDispatcher(this);this.__initTweenEvent()}.$implements(Ui.IRenderer).$define({setCanShow:function(a){this.__canShow=!!a},setCanHidden:function(a){this.__canHidden=!!a},show:function(b){var a=this.__tween;a.stop();Core.Dom.setStyle(b,"opacity",this.__value);b.style.display="";this.__node=b;this.__state="show";this.__eventDispatcher.dispatchEvent("beforeShow");if(this.__canShow){a.startValue=this.__value;a.endValue=1;a.start()}return this},hidden:function(b){var a=this.__tween;a.stop();this.__node=b;this.__state="hidden";this.__eventDispatcher.dispatchEvent("beforeHidden");if(this.__canHidden){a.startValue=this.__value;a.endValue=0;a.start()}return this},addEventListener:function(a,b){this.__eventDispatcher.addEventListener(a,b);return this},removeEventListener:function(a,b){this.__eventDispatcher.removeEventListener(a,b);return this},__initTweenEvent:function(){var a=this;this.__tween.addEventListener("tween",function(b){a.__value=b;Core.Dom.setStyle(a.__node,"opacity",b)});this.__tween.addEventListener("end",function(){a.__node&&a.__node.style.filter&&(a.__node.style.filter="");if(a.__state!==""&&a.__state!==a.__lastState){a.__lastState=a.__state;a.__eventDispatcher.dispatchEvent(a.__state)}a.__state==="hidden"&&(a.__node.style.display="none")})}});Ui.BorderDragger=function(){this.__drag=null;this.__isBindEvent=false;this.__border=null;this.__dragNode=null;this.__isCreated=false;this.__tweenX=new Ui.TweenStrategy(0,0,0.5,Ui.Transition.strongEaseOut);this.__tweenY=new Ui.TweenStrategy(0,0,0.5,Ui.Transition.strongEaseOut);this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$implements(Ui.IDragger).$define({addEventListener:function(a,b){if(a.toLowerCase()==="afterdrag"){this.__eventDispatcher.addEventListener(a,b)}else{this.__drag.addEventListener(a,b)}return this},removeEventListener:function(a,b){if(a.toLowerCase()==="afterdrag"){this.__eventDispatcher.removeEventListener(a,b)}else{this.__drag.removeEventListener(a,b)}return this},setDrag:function(b,a,c){if(!this.__isCreated){this.__createBorder(a);this.__initTweenEvent(a)}this.__drag=new Ui.Drag(b,this.__border,c);this.__dragNode=a;this.__initDragEvent();return this},setLock:function(a){this.__drag.isLock=!!a;return this},setArea:function(a){this.__drag.lockArea=a;return this},destroy:function(){this.__drag.destroy()},__createBorder:function(b){this.__border=$C("div");var a=this.__border.style;a.border="2px dashed #BCC4D0";a.position="absolute";a.display="none";a.backgroundColor="transparent";a.MozUserSelect="none";document.body.appendChild(this.__border);this.__isCreated=true},__initDragEvent:function(){if(this.__isBindEvent){return}var d=this,f=this.__border.style,b=this.__dragNode.style,c=this.__tweenX,a=this.__tweenY;this.__drag.addEventListener("beforeDrag",function(){f.zIndex=b.zIndex+1;f.position=b.position;f.width=d.__dragNode.offsetWidth-4+"px";f.height=d.__dragNode.offsetHeight-4+"px";f.left=parseInt(b.left)+"px";f.top=parseInt(b.top)+"px";f.display=""});this.__drag.addEventListener("afterDrag",function(){if($IE6){b.left=parseInt(f.left)+"px";b.top=parseInt(f.top)+"px";f.display="none";d.__eventDispatcher.dispatchEvent("afterDrag")}else{c.startValue=parseInt(b.left);c.endValue=parseInt(f.left);a.startValue=parseInt(b.top);a.endValue=parseInt(f.top);c.start();a.start()}});this.__isBindEvent=true},__initTweenEvent:function(c){var a=c.style,d=this.__border.style,b=this;this.__tweenX.addEventListener("tween",function(f){a.left=f+"px"});this.__tweenY.addEventListener("tween",function(f){a.top=f+"px"});this.__tweenX.addEventListener("end",function(){d.display="none";b.__eventDispatcher.dispatchEvent("afterDrag")})}});var winDialog={};var DialogTemplate={};(function(){var c={alert:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示标题</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div id="#{content}" class="CP_layercon1">','<div class="CP_prompt">','<img id="#{icon}" class="SG_icon SG_icon201" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="50" height="50" align="absmiddle"/>','<table class="CP_w_ttl"><tr><td id="#{text}"></td></tr></table>','<div id="#{subText}" class="CP_w_cnt SG_txtb"></div>','<p class="CP_w_btns_Mid"><a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnOk}"> </cite></a></p>',"</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),newAlert:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div class="CP_layercon2 pop_v">','<div class="v_prompt">','<img id="#{icon}" class="SG_icon SG_icon148" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="20" height="20" align="absmiddle" />','<div id="#{text}" class="v_cnt SG_txtb"></div>','<div id="#{subText}"></div>','<p class="v_btns">','<a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#"><cite id="#{btnOk}">确定</cite></a>',"</p>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),confirm:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示标题</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div id="#{content}" class="CP_layercon1">','<div class="CP_prompt">','<img id="#{icon}" class="SG_icon SG_icon201" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="50" height="50" align="absmiddle"/>','<table class="CP_w_ttl"><tr><td id="#{text}"></td></tr></table>','<div id="#{subText}" class="CP_w_cnt SG_txtb"></div>','<p class="CP_w_btns">','<a  id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnOk}"></cite></a>','<a style="margin-left:5px;" id="#{linkCancel}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnCancel}"> <span id="#{cancel}"></span> </cite></a></p>',"</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),newConfirm:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div class="CP_layercon2 pop_v">','<div class="v_prompt">','<img id="#{icon}" class="SG_icon SG_icon148" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="20" height="20" align="absmiddle" />','<div id="#{text}" class="v_cnt SG_txtb"></div>','<div id="#{subText}"></div>','<p class="v_btns">','<a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#"><cite id="#{btnOk}">确定</cite></a>&nbsp;&nbsp;','<a id="#{linkCancel}" class="SG_aBtn SG_aBtnB SG_aBtn_g" href="#"><cite id="#{btnCancel}">取消</cite></a>',"</p>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),customs:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">提示标题</strong>','<cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">',"</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join("")};var b={"01":{"class":"SG_icon SG_icon201",alt:"警告"},"02":{"class":"SG_icon SG_icon202",alt:"失败"},"03":{"class":"SG_icon SG_icon203",alt:"成功"},"04":{"class":"SG_icon SG_icon204",alt:"询问"},"05":{"class":"SG_icon SG_bigLoading",alt:"正在加载"},"06":{"class":"SG_icon SG_icon148",alt:"警告"}};var d={};var a=new Ui.ModuleDialog(c,b,{renderer:Ui.OpacityRenderer,dragger:Ui.BorderDragger,isAdamant:$IE6});winDialog.create=winDialog.createCustomsDialog=function(g,f){if(f&&typeof f==="string"){d[f]=a.create(g);return d[f]}else{return a.create(g)}};winDialog.alert=function(i,f,g){if(g&&typeof g==="string"){d[g]=a.alert(i,f);return d[g]}else{return a.alert(i,f)}};winDialog.newAlert=function(i,f,g){if(g&&typeof g==="string"){d[g]=a.newAlert(i,f);return d[g]}else{return a.newAlert(i,f)}};winDialog.confirm=function(i,f,g){if(g&&typeof g==="string"){d[g]=a.confirm(i,f);return d[g]}else{return a.confirm(i,f)}};winDialog.newConfirm=function(i,f,g){if(g&&typeof g==="string"){d[g]=a.newConfirm(i,f);return d[g]}else{return a.newConfirm(i,f)}};winDialog.getDialog=function(f){if(f&&typeof f==="string"){return d[f]}};DialogTemplate=c})();Sina.pkg("Core.Class");Core.Class.AsPrototype={};Core.Class.create=function(){return function(a){if(a!=Core.Class.AsPrototype){this.initialize.apply(this,arguments)}}};Sina.pkg("Core.Math");Core.Math.getUniqueId=function(b,a){return parseInt(Math.random()*10000).toString()+(new Date).getTime().toString()};Lib.IframeDialog=Core.Class.create();Lib.IframeDialog.prototype={dialog:null,initialize:function(a){this.id=Core.Math.getUniqueId();this.option=a},initDialog:function(){var d=this,a=this.option;var c={ad:false,drag:true,tpl:a.tpl||d.tpl,title:a.title,content:'<iframe frameborder="0" id="ifrDialog_'+d.id+'" scrolling="no"></iframe>',renderer:Ui.SimpleRenderer,width:a.width,height:a.height};this.dialog=winDialog.createCustomsDialog(c);this.dialog.setAreaLocked(true);var b=$E("ifrDialog_"+this.id);b.src=a.url;b.style.width=a.width+"px";b.style.height=a.height+"px";a.funcClose&&this.bindColseFunc()},tpl:'<table id="#{entity}" class="CP_w"><thead id="#{titleBar}"><tr><th class="tLeft"><span></span></th><th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示</strong><cite><a id="#{btnClose}" href="javascript:;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th><th class="tRight"><span></span></th></tr></thead><tfoot><tr><td class="tLeft"><span></span></td><td class="tMid"><span></span></td><td class="tRight"><span></span></td></tr></tfoot><tbody><tr><td class="tLeft"><span></span></td><td class="tMid" id="#{content}"></td><td class="tRight"><span></span></td></tr></tbody></table>',reset:function(){if(this.dialog){this.hidden();var a=this.dialog.nodes.panel||this.dialog.nodes.entity;a.parentNode.removeChild(a);this.dialog=null}},bindColseFunc:function(){Core.Events.addEvent(this.dialog.nodes.btnClose,this.option.funcClose)},setSize:function(b,a){var c=this.dialog.nodes.content.firstChild;this.dialog.setSize(b,a);c.style.width=b+"px";c.style.height=a+"px"},show:function(){this.reset();this.initDialog();this.dialog.show();this.dialog.setMiddle()},close:function(){this.dialog.hidden()}};Core.Events.fireEvent=function(b,c){var a;b=$E(b);if(b.fireEvent){b.fireEvent("on"+c)}else{if($MOBILE){a=document.createEvent("HTMLEvents")}else{a=document.createEvent("MouseEvents")}a.initEvent(c,true,true);b.dispatchEvent(a)}};Lib.AccountChecker=Core.Class.create();Lib.AccountChecker.prototype={initialize:function(a){if(a.indexOf("vt=1")>0||a.indexOf("vt=2")>0){this.showDialog(a)}else{window.location.href=a}},showDialog:function(a){document.domain="sina.com.cn";if(!window.accDialog){window.accDialog=new Lib.IframeDialog({url:a,title:"账号安全",width:300,height:165});scope.accCallback=function(){window.accDialog.close()}}window.accDialog.show();var b=window.accDialog.dialog.nodes;var c=b.content;c.firstChild.style.marginLeft="25px";b.btnClose.style.display="none";var d=document.createElement("p");d.style.lineHeight="70px";d.innerHTML="　　为了您的账号安全，请输入验证码后再进行操作";c.insertBefore(d,c.firstChild)},hideDialog:function(){window.accDialog&&window.accDialog.hidden()}};$registJob("checkAccount",function(){var a=scope.$ssoUseUrl;if(a&&a!=="0"){new Lib.AccountChecker(a)}});Core.Dom.getChildrenByClass=function(j,g){var b=[];var f=j.childNodes||j.children;var g=" "+g+" ";var a=f.length;for(var d=0;d<a;++d){var k=f[d];var c=" "+k.className+" ";if(c.indexOf(g)!=-1){b[b.length]=k}}return b};Core.Dom.insertHTML=function(d,c,b){d=$E(d)||document.body;b=b.toLowerCase()||"beforeend";if(d.insertAdjacentHTML){switch(b){case"beforebegin":d.insertAdjacentHTML("BeforeBegin",c);return d.previousSibling;case"afterbegin":d.insertAdjacentHTML("AfterBegin",c);return d.firstChild;case"beforeend":d.insertAdjacentHTML("BeforeEnd",c);return d.lastChild;case"afterend":d.insertAdjacentHTML("AfterEnd",c);return d.nextSibling}throw'Illegal insertion point -> "'+b+'"'}var a=d.ownerDocument.createRange();var f;switch(b){case"beforebegin":a.setStartBefore(d);f=a.createContextualFragment(c);d.parentNode.insertBefore(f,d);return d.previousSibling;case"afterbegin":if(d.firstChild){a.setStartBefore(d.firstChild);f=a.createContextualFragment(c);d.insertBefore(f,d.firstChild);return d.firstChild}else{d.innerHTML=c;return d.firstChild}break;case"beforeend":if(d.lastChild){a.setStartAfter(d.lastChild);f=a.createContextualFragment(c);d.appendChild(f);return d.lastChild}else{d.innerHTML=c;return d.lastChild}break;case"afterend":a.setStartAfter(d);f=a.createContextualFragment(c);d.parentNode.insertBefore(f,d.nextSibling);return d.nextSibling}throw'Illegal insertion point -> "'+b+'"'};if(document.documentElement.contains){Core.Dom.contains=function(a,b){return a.contains?a.contains(b):true}}else{if(document.documentElement.compareDocumentPosition){Core.Dom.contains=function(a,b){return a===b||!!(a.compareDocumentPosition(b)&16)}}else{Core.Dom.contains=function(a,b){while(b){if(a===b){return true}b=b.parentNode}return false}}}Core.Dom.insertAfter=function(c,a){var b=a.parentNode;if(b.lastChild==a){b.appendChild(c)}else{b.insertBefore(c,a.nextSibling)}return c};Sina.pkg("Utils");if(typeof Utils=="undefined"){Utils=Sina.Utils}Sina.pkg("Utils.Cookie");Utils.Cookie.getCookie=function(a){a=a.replace(/([\.\[\]\$])/g,"\\$1");var c=new RegExp(a+"=([^;]*)?;","i");var d=document.cookie+";";var b=d.match(c);if(b){return b[1]||""}else{return""}};Utils.Cookie.setCookie=function(b,g,c,k,f,a){var i=[];i.push(b+"="+escape(g));if(c){var j=new Date();var d=j.getTime()+c*3600000;j.setTime(d);i.push("expires="+j.toGMTString())}if(k){i.push("path="+k)}if(f){i.push("domain="+f)}if(a){i.push(a)}document.cookie=i.join(";")};Lib.applyIf=function(d,a,c){if(c){Lib.applyIf(d,c)}if(d&&a&&(typeof d==="object")){for(var b in a){if(!d[b]){d[b]=a[b]}}}return d};Lib.apply=function(d,a,c){if(c){Lib.applyIf(d,c)}if(d&&a&&(typeof d==="object")){for(var b in a){d[b]=a[b]}}return d};Lib.register=function(a,f){var d=a.split(".");var g={},c,b=Lib;while(c=d.shift()){if(d.length){if(b[c]===undefined){b[c]={}}b=b[c]}else{if(b[c]===undefined){b[c]=f(Lib)}}}};Core.Dom.getTop=function(a){var c=0;var b=$E(a);if(typeof b.offsetParent!="unknown"){while(b.offsetParent){c+=b.offsetTop;b=b.offsetParent}}else{if(b.y){c+=b.y}}return c};Core.Dom.getLeft=function(a){var c=0;var b=$E(a);if(typeof b.offsetParent!="unknown"){while(b.offsetParent){c+=b.offsetLeft;b=b.offsetParent}}else{if(b.x){c+=b.x}}return c};Lib.HtmlTemplate=function(a,b){this.uniqueID=b}.$extends(Ui.Template).$define({getHtmlString:function(){if(!this._htmlStr){this._htmlStr=this.evaluate(this.getNodeIds())}return this._htmlStr},getNodeIds:function(){if(!this._nodes){var f=/\{[^\}]+(?=\})/g,b,a={},d,c,g=this._getUniqueID();this.__templateNodesIDs=this.tmpl.match(f);d=this.__templateNodesIDs;if(d){b=d.length;while(b--){c=d[b].replace("{","");a[c]="_"+g+"_"+c}}this._nodes=a}return this._nodes},getNodeId:function(a){if(!this._nodes){this.getNodeIds()}return this._nodes[a]},getNode:function(a){var b=this.getNodeId(a);return !b?null:$E(b)},_getUniqueID:function(){if(!this.uniqueID){this.uniqueID=parseInt(Math.random()*1000).toString()+(new Date).getTime().toString()}return this.uniqueID}});Lib.Panel=Core.Class.create();Lib.Panel.prototype={noIframe:!1,isPostion:!0,appendTo:null,entity:null,backIframe:null,uniqueID:null,isFixed:false,isShow:!1,isHidden:!0,x:0,y:0,template:"",initialize:function(a){Lib.apply(this,a);var b=this;this.uniqueID=this._getUniqueID();this._ie6Fixed=function(){if(b.entity){b.entity.style.left=document.documentElement.scrollLeft+b.x+"px";b.entity.style.top=document.documentElement.scrollTop+b.y+"px"}if(b.backIframe){b.backIframe.style.left=b.entity.style.left;b.backIframe.style.top=b.entity.style.top}}},getNode:function(a){return this.tpl.getNode(a)},setTemplate:function(c){this.template=c;if(this.entity&&this.entity.parentNode){this.entity.parentNode.removeChild(this.entity);this.backIframe&&this.backIframe.parentNode.removeChild(this.backIframe)}this.entity=$C("div");var b=$C("div");var a=new Lib.HtmlTemplate(this.template,this.uniqueID);this.tpl=a;b.innerHTML=a.getHtmlString();b.style.display="none";if(this.appendTo){$E(this.appendTo).appendChild(b)}else{document.body.appendChild(b)}this.entity=$E("_"+this.uniqueID+"_panel");if(this.isPostion){this.entity.style.position="absolute"}this.entity.style.display="none";if(this.appendTo){$E(this.appendTo).replaceChild(this.entity,b)}else{document.body.replaceChild(this.entity,b)}b=null;if(!this.noIframe){this.backIframe=$C("iframe");this.backIframe.style.display="none";this.backIframe.style.border="none";this.backIframe.style.zIndex=this.entity.style.zIndex-1;document.body.appendChild(this.backIframe);this._updateBackIframe()}},setPosition:function(a,b){this.x=a;this.y=b;this.entity.style.left=a+"px";this.entity.style.top=b+"px";if($IE6&&this.isFixed){this.entity.style.left=a+document.documentElement.scrollLeft+"px";this.entity.style.top=b+document.documentElement.scrollTop+"px"}if(this.backIframe){this.backIframe.style.left=this.entity.style.left;this.backIframe.style.top=this.entity.style.top}},setFixed:function(a){this.isFixed=a;if($IE6){var b=this;this.entity.style.position="absolute";if(this.isFixed){b._ie6Fixed();Core.Events.addEvent(window,b._ie6Fixed,"scroll")}else{Core.Events.removeEvent(window,b._ie6Fixed,"scroll")}return}this.entity.style.position=this.isFixed?"fixed":"absolute";if(this.backIframe){this.backIframe.style.position=this.entity.style.position}},show:function(){this.entity.style.display="";this.isHidden=!1;this.isShow=!0;if(this.backIframe){this._updateBackIframe();this.backIframe.style.display=""}},hidden:function(){this.hide()},hide:function(){this.entity.style.display="none";this.isHidden=!0;this.isShow=!1;if(this.backIframe){this.backIframe.style.display="none"}},close:function(){this.hidden();this.destroy()},destroy:function(){Core.Events.removeEvent(window,this._ie6Fixed,"scroll");this.entity.parentNode.removeChild(this.entity);this.entity=null;if(this.backIframe){this.backIframe.parentNode.removeChild(this.backIframe);this.backIframe=null}},showWithDom:function(d,c,b){var a=Core.Dom.getLeft(d)+d.offsetWidth+c;var f=Core.Dom.getTop(d)+d.offsetHeight+b;if($IE6&&this.isFixed){a=a-document.documentElement.scrollLeft;f=f-document.documentElement.scrollTop}this.setPosition(a,f);this.show()},getWidth:function(){var a=this.entity.style.display;var b=this.entity.style.visibility;this.entity.style.visibility="hidden";this.entity.style.display="";w=this.entity.offsetWidth;this.entity.style.display=a;this.entity.style.visibility=b;return w},getHeight:function(){var a=this.entity.style.display;var b=this.entity.style.visibility;this.entity.style.visibility="hidden";this.entity.style.display="";h=this.entity.offsetHeight;this.entity.style.display=a;this.entity.style.visibility=b;return h},getX:function(){return parseInt(this.entity.style.left)},getY:function(){return parseInt(this.entity.style.top)},getNodes:function(j){var b=j||"o";var g=/[^\{\}]+(?=\})/g;var d;var c={};var a=this.template.match(g);if(a){for(d=0;d<a.length;d++){var f=a[d];switch(b){case"o":c[f]=$E("_"+this.uniqueID+"_"+f);break;case"i":c[f]="_"+this.uniqueID+"_"+f;break}}}return c},_updateBackIframe:function(){Core.Dom.setStyle(this.backIframe,"opacity",0);this.backIframe.style.display="";this.backIframe.style.position=this.entity.style.position;this.backIframe.style.width=this.entity.offsetWidth+"px";this.backIframe.style.height=this.entity.offsetHeight+"px";this.backIframe.style.left=this.entity.style.left;this.backIframe.style.top=this.entity.style.top},_getUniqueID:function(){return parseInt(Math.random()*1000).toString()+(new Date).getTime().toString()}};Lib.register("Listener",function(){var a={};a.listeners={};return{add:function(b){if(a.listeners[b]){throw new Error("listener '"+b+"' has registed!")}a.listeners[b]=[]},remove:function(b){if(a.listeners[b]){a.listeners[b]=null;return true}return false},notify:function(c,j){var f=a.listeners[c],g=null;if(!f){return}for(var d=0,b=f.length;d<b;d++){g=f[d];g.callBack.call(g.scope,j)}},on:function(g){var c=arguments,f=null;for(var d=0,b=c.length;d<b;d++){f=c[d];if(!this.isListen(f)){if(!a.listeners[f.name]){a.listeners[f.name]=[]}a.listeners[f.name].push(f)}}},off:function(g){var c=a.listeners[g.name];if(!c){return true}var f=null;for(var d=0,b=c.length;d<b;d++){f=c[d];if(f.callBack==g.callBack&&f.scope==g.scope){c.splice(d,1)}}},isListen:function(g){var c=a.listeners[g.name];var f=null;if(!c){return false}for(var d=0,b=c.length;d<b;d++){f=c[d];if(f.callBack==g.callBack&&f.scope==g.scope){return true}}return false}}});Lib.register("util.JSON",function(b){var a=(function(d,f){if(d.JSON){return d.JSON}var c={parse:function(g){return new Function("return "+g)()},stringify:function(i){if(i instanceof Object){var k="";if(i.constructor===Array){for(var g=0;g<i.length;k+=this.stringify(i[g])+",",g++){}return"["+k.substr(0,k.length-1)+"]"}if(i.toString!==Object.prototype.toString){return'"'+i.toString().replace(/"/g,"\\$&")+'"'}for(var j in i){k+='"'+j.replace(/"/g,"\\$&")+'":'+this.stringify(i[j])+","}return"{"+k.substr(0,k.length-1)+"}"}return typeof i==="string"?'"'+i.replace(/"/g,"\\$&")+'"':String(i)}};return c})(window);return a});Core.Events.fixEvent=function(a){if(typeof a=="undefined"){a=window.event}if(!a.target){a.target=a.srcElement;a.pageX=a.x;a.pageY=a.y}if(typeof a.layerX=="undefined"){a.layerX=a.offsetX}if(typeof a.layerY=="undefined"){a.layerY=a.offsetY}return a};Core.Events.getEventTarget=function(a){a=a||Core.Events.getEvent();Core.Events.fixEvent(a);return a.target};Lib.pkg("util");Lib.util.hoverJq=function(g){var k={elm:document.body,mouseenter:function(i,n,m){},mouseleave:function(i,n,m){},delay:0};g=Lib.apply(k,g);var l=$IE?"mouseenter":"mouseover",f=$IE?"mouseleave":"mouseout";if(!("length" in g.elm)){g.elm=[g.elm]}else{try{g.elm=Array.prototype.slice.call(g.elm,0)}catch(d){var a=[];for(var b=0,c=g.elm.length;b<c;b++){a.push(g.elm[b])}g.elm=a}}Core.Array.foreach(g.elm,function(m,i){Core.Events.removeEvent(m,l);Core.Events.removeEvent(m,f);Core.Events.addEvent(m,(function(o,p,n){return function(q){q=q||window.event;if($IE){p.apply(o,[q,o,n])}else{j(q,"mouseenter",o,n)}}})(m,g[l],i),l);Core.Events.addEvent(m,(function(o,p,n){return function(q){if($IE){p.apply(o,[q,o,n])}else{j(q,"mouseleave",o,n)}}})(m,g[f],i),f)});var j=function(p,o,r,m){var n=p.relatedTarget;try{if(n&&n!==document&&!n.parentNode){return}while(n&&n!==r){n=n.parentNode}if(n!==r){g[o].apply(r,[p,r,m])}}catch(q){}return false}};Lib.register("tray.tpl.loginMemu",function(){var a=['<div class="ntopbar_menu" id="#{panel}">','<div id="#{openBlog}" style="display:none;">','<span class="link" id="#{userMenu}"><a id="#{userNick}" onclick="v7sendLog(\'40_01_21\');return false;" href="###">读取中...</a><a href="javascript:;" class="link_arrow" title=""></a></span>','<span id="#{msnHolder}" class="ico_msn" style="display:none"><a id="#{msnLink}" href="http://control.blog.sina.com.cn/blogprofile/msnbind.php?c=" target="_blank"><img height="18" width="18" align="absmiddle" class="SG_icon SG_icon136" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif"></a></span>','<span class="line_s"></span>','<span class="link"><a onclick="v7sendLog(\'40_01_27\')" href="http://i.blog.sina.com.cn/blogprofile/index.php?com=1">个人中心</a></span>','<span class="line_s"></span>','<em id="#{newFeed}" class="mtip" style="left:341px;display:none;cursor:pointer;"></em>','<span class="link" id="#{blogMenu}"><a target="_blank" onclick="v7sendLog(\'40_01_24\')" href="http://control.blog.sina.com.cn/admin/article/article_add.php">发博文</a><a id="#{addArticle}" onclick="v7sendLog(\'40_01_25\');return false;" href="###" class="link_arrow"></a></span>','<span class="line_s"></span>','<span class="link"><a onclick="v7sendLog(\'40_01_28\')" target="_blank" href="http://wanwan.sina.com.cn/bloggame/">游戏</a></span>','<span class="line_s"></span>','<span class="link" id="#{trayMsg}" msg-panel-show-state="0"><a onclick="v7sendLog(\'40_01_30\');return false;" href="###">消息</a><a href="javascript:return false;" class="link_arrow" title=""></a></span>','<em id="#{newTips}" onclick="v7sendLog(\'40_01_29\')" class="mtip" style="left:341px;display:none;cursor:pointer;"></em>',"</div>",'<div id="#{noOpenBlog}" style="display:none;">','<span class="link"><a id="#{ssoNick}" onclick="v7sendLog(\'40_01_40\');return false;" href="###">读取中...</a></span>','<span class="line_s"></span>','<span class="link"><a id="#{ssoLoginOut}" onclick="v7sendLog(\'40_01_41\');return false;" href="###">退出</a></span>','<div class="ntopbar_login" style="float:left;"><a id="#{openBlogBtn}" onclick="v7sendLog(\'40_01_42\')" class="login" href="###"><span>立即拥有一个新博客</span></a></div>',"</div>","</div>"].join("");return a});Lib.register("tray.tpl.loginOutMemu",function(){var b=scope.$uid||"";var c="http://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid="+b+"&src=";if(scope.$channel==2){c+="baby"}else{c+="blogicp"}var a=['<div id="#{panel}" class="ntopbar_login">','<a class="login" onclick="v7sendLog(\'40_01_38\');return false;" href="###" action-type="tray-login-btn"><span>登录</span></a>','<a class="register" onclick="v7sendLog(\'40_01_39\')" target="_blank" href="',c,'">注册</a></div>'].join("");return a});Core.Class.extend=function(a,b,c){for(var d in b){if(c!=null){if(!a[d]){a[d]=b[d]}}else{a[d]=b[d]}}return a};Core.Class.define=function(f,b,a){if(f&&f.__isClass&&f.__isClass()){throw new Error("class cnt be used as another class' constructor : "+f)}b=b||Object;a=a||{};a.initialize=f||a.initialize||b.prototype.initialize||(function(){});if(typeof(a.initialize)!="function"){throw new Error("only function can be used as constructor")}a.__isClass=function(){return true};var c=Core.Class.create();c.__isClass=a.__isClass;var d=b==Object?{}:new b(Core.Class.AsPrototype);c.prototype=Core.Class.extend(d,a);return c};Sina.pkg("Utils.Io");Sina.pkg("Core.System");(function(){var a=function(c,b){var d;try{if(typeof b!="undefined"){for(d in c){if(b[d]!=null){c[d]=b[d]}}}}finally{d=null;return c}};Core.System.parseParam=a})();Sina.pkg("Core.String");Utils.Url=function(a){a=a||"";this.url=a;this.query={};this.parse()};Utils.Url.prototype={parse:function(a){if(a){this.url=a}this.parseAnchor();this.parseParam()},parseAnchor:function(){var a=this.url.match(/\#(.*)/);a=a?a[1]:null;this._anchor=a;if(a!=null){this.anchor=this.getNameValuePair(a);this.url=this.url.replace(/\#.*/,"")}},parseParam:function(){var a=this.url.match(/\?([^\?]*)/);a=a?a[1]:null;if(a!=null){this.url=this.url.replace(/\?([^\?]*)/,"");this.query=this.getNameValuePair(a)}},getNameValuePair:function(b){var a={};b.replace(/([^&=]*)(?:\=([^&]*))?/gim,function(c,f,d){if(f==""){return}a[f]=d||""});return a},getParam:function(a){return this.query[a]||""},clearParam:function(){this.query={}},setParam:function(a,b){if(a==null||a==""||typeof(a)!="string"){throw new Error("no param name set")}this.query=this.query||{};this.query[a]=b},setParams:function(a){this.query=a},serialize:function(c){var a=[];for(var b in c){if(c[b]==null||c[b]==""){a.push(b+"=")}else{a.push(b+"="+c[b])}}return a.join("&")},toString:function(){var a=this.serialize(this.query);return this.url+(a.length>0?"?"+a:"")+(this.anchor?"#"+this.serialize(this.anchor):"")},getHashStr:function(a){return this.anchor?"#"+this.serialize(this.anchor):(a?"#":"")}};Core.String.encodeDoubleByte=function(a){if(typeof a!="string"){return a}return encodeURIComponent(a)};Utils.Io.JsLoad={};(function(){function a(l,g){b(l,g);var k=l.urls;var f,d=k.length;for(f=0;f<d;f++){var j=$C("script");j.src=k[f].url;j.charset=k[f].charset;j.onload=j.onerror=j.onreadystatechange=function(){if(j&&j.readyState&&j.readyState!="loaded"&&j.readyState!="complete"){return}g.script_loaded_num++;j.onload=j.onreadystatechange=j.onerror=null;if((!1)!==l.isRemove){j.src="";j.parentNode.removeChild(j)}j=null};document.getElementsByTagName("head")[0].appendChild(j)}}function b(n,j){var m=n.urls;var p=n.GET;var k,l=m.length;var o,f,d,g;for(k=0;k<l;k++){g=window.parseInt(Math.random()*100000000);f=new Utils.Url(m[k].url);for(o in p){if(n.noencode==true){f.setParam(o,p[o])}else{f.setParam(o,Core.String.encodeDoubleByte(p[o]))}}d=f.getParam("varname")||"requestId_"+g;if(n.noreturn!=true){f.setParam("varname",d)}j.script_var_arr.push(d);m[k].url=f.toString();m[k].charset=m[k].charset||n.charset}}function c(g,i){var f={isRemove:!0,urls:[],charset:"utf-8",noreturn:false,noencode:false,timeout:-1,POST:{},GET:{},onComplete:null,onException:null};var d={script_loaded_num:0,is_timeout:false,is_loadcomplete:false,script_var_arr:[]};f.urls=typeof g=="string"?[{url:g}]:g;Core.System.parseParam(f,i);a(f,d);(function(){if(f.noreturn==true&&f.onComplete==null){return}var j,k=[];if(d.script_loaded_num==f.urls.length){d.is_loadcomplete=true;if(f.onComplete!=null){for(j=0;j<d.script_var_arr.length;j++){k.push(window[d.script_var_arr[j]])}if(d.script_var_arr.length<2){f.onComplete(k[0])}else{f.onComplete(k)}}return}if(d.is_timeout==true){return}setTimeout(arguments.callee,50)})();if(f.timeout>0){setTimeout(function(){if(d.is_loadcomplete!=true){if(f.onException!=null){f.onException()}d.is_timeout=true}},f.timeout)}}Utils.Io.JsLoad.request=function(d,f){new c(d,f)}})();Core.System.keyValue=function(b,c){var a=b.match(new RegExp("(\\?|&)"+c+"=([^&]*)(&|$)"));if(a!=null){return a[2]}return null};Lib.checkAuthor=function(){var a=unescape(Utils.Cookie.getCookie("SUP"));if(a&&a!=""){$UID=Core.System.keyValue(a,"uid");$nick=decodeURIComponent(Core.System.keyValue(a,"nick"));$isLogin=!!($UID);if(typeof scope.$uid=="undefined"){$isAdmin=false}else{$isAdmin=(scope.$uid==$UID)}}else{a=Utils.Cookie.getCookie("SU");if(a&&a!=""){var b=a.match(/^([^:]*:){2}(\d{5,11})/);$UID=(b&&b[2])||null;window.$isLogin=!!($UID);if(typeof scope.$uid=="undefined"){window.$isAdmin=false}else{window.$isAdmin=(scope.$uid==$UID)}}else{$UID=null;$isLogin=false;$isAdmin=false}}};function v6SendLog(b,a){}function v7sendLog(b,a,c){if(!b){return false}if(b.split("_").length==3){Lib.checkAuthor();if($isLogin){b+="_"+$UID}}if(typeof scope=="undefined"){window.scope={};scope.$pageid=""}a=a||scope.$pageid;c=c||"";Utils.Io.JsLoad.request("http://hits.sinajs.cn/A2/b.html?type="+b+"&pageid="+a+"&msg="+c,{onComplete:function(){}})}Lib.register("tray.tpl.userMenu",function(){var a=['<div id="#{panel}" class="mUserMenu">',"<ul>","<li>",'<span class="tb_ps_nm"><a id="#{linkBlog}" onclick="v7sendLog(\'40_01_22\')" href="###"><img class="SG_icon SG_icon15" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="博客" align="absmiddle">博客</a></span>','<span class="rlink"><a target="_blank" onclick="v7sendLog(\'40_01_22\')" id="#{linkPostBlog}" href="http://control.blog.sina.com.cn/admin/article/article_add.php">发博文</a></span>',"</li>",'<li> <span class="tb_ps_nm"><a id="#{linkPhoto}" onclick="v7sendLog(\'40_01_22\')" href="###"><img class="SG_icon SG_icon18" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="相册" align="absmiddle">相册</a></span> <span class="rlink"><a target="_blank" id="#{linkPostPhoto}" onclick="v7sendLog(\'40_01_22\')" href="http://photo.blog.sina.com.cn/upload/upload.php">发图片</a></span> </li>','<li> <span class="tb_ps_nm"><a target="_blank" id="#{linkVBlog}" onclick="v7sendLog(\'40_01_22\')" href="###"><img class="SG_icon SG_icon16" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="播客" align="absmiddle">播客</a></span> <span class="rlink"><a target="_blank" id="#{linkUpload}" onclick="v7sendLog(\'40_01_22\')" href="http://vupload.you.video.sina.com.cn/u.php?m=1">发视频</a>&nbsp;&nbsp;<a id="#{linkRecord}" onclick="v7sendLog(\'40_01_22\')" href="http://vupload.you.video.sina.com.cn/r.php" target="_blank">录视频</a></span> </li>','<li> <span class="tb_ps_nm"><a id="#{miniblog}" onclick="v7sendLog(\'40_01_22\')" href="###" target="_blank"><img class="SG_icon SG_icon110" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="17" title="微博" align="absmiddle">微博</a></span> </li>','<li> <span class="tb_ps_nm"><a id="#{qingblog}" onclick="v7sendLog && v7sendLog(\'79_01_02\',scope.$pageid,\'qingLink\');" onclick="v7sendLog(\'40_01_22\')" href="###" target="_blank"><img class="SG_icon SG_icon205" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="Qing" align="absmiddle">Qing</a></span> </li>','<li style="display:none;" id="#{mail}"> <span class="tb_ps_nm"><a id="#{bindEmail}" target="_blank" href="http://mail.sina.com.cn/?s=2" onclick="v7sendLog(\'40_01_22\')"><img class="SG_icon SG_icon212" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="13" title="邮件" align="absmiddle">邮件</a></span> </li>','<li> <span class="tb_ps_nm"><a id="#{mySpace}" onclick="v7sendLog(\'40_01_22\')" href="###"><img class="SG_icon SG_icon41" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="关于我" align="absmiddle">关于我</a></span> </li>',"</ul>",'<div class="links">','<p><a target="_blank" id="#{linkChangeFace}" onclick="v7sendLog(\'40_01_22\')" href="###">修改头像昵称&gt;&gt;</a></p>','<p><a target="_blank" id="#{linkChangePassword}" onclick="v7sendLog(\'40_01_22\')" href="###">修改登录密码&gt;&gt;</a></p>','<p><a target="_blank" id="#{linkAccountSetup}" onclick="v7sendLog(\'40_01_22\')" href="###">帐号安全设置&gt;&gt;</a></p>','<p><a id="#{loginOut}" onclick="v7sendLog(\'40_01_23\');return false;" href="#">退出&gt;&gt;</a></p>',"</div>","</div>"].join("");return a});Core.String.j2o=function(str){if(!str||str==""){return null}try{var o=window.eval("("+str+")");return o}catch(e){trace("j2o : 数据分析出错");traceError(e);return null}};Core.Dom.getElementsByClass=function(c,b,j){c=c||document;var d=[];j=" "+j+" ";var l=c.getElementsByTagName(b),g=l.length;for(var f=0;f<g;++f){var a=l[f];if(a.nodeType==1){var k=" "+a.className+" ";if(k.indexOf(j)!=-1){d[d.length]=a}}}return d};Core.Dom.byClz=Core.Dom.getElementsByClass;Utils.Io.Ijax={arrTaskLists:[],createLoadingIframe:function(){if(this.loadFrames!=null){return false}var d="loadingIframe_thread"+Math.ceil(Math.random()*10000);var c="loadingIframe_thread"+Math.ceil((Math.random()+1)*10000);this.loadFrames=[d,c];var b='<iframe id="'+d+'" name="'+d+'" class="invisible"	              scrolling="no" src=""	              allowTransparency="true" style="display:none;" frameborder="0"	              ></iframe>				  <iframe id="'+c+'" name="'+c+'" class="invisible"	              scrolling="no" src=""	              allowTransparency="true" style="display:none;" frameborder="0"	              ></iframe>';var a=$C("div");a.id="ijax_iframes";a.innerHTML=b;trace("创建 Ijax 需要的 iframe");document.body.appendChild(a);var f=setInterval(Core.Function.bind2(function(){if($E(this.loadFrames[0])!=null&&$E(this.loadFrames[1])!=null){clearInterval(f);f=null;this.loadingIframe={thread1:{container:$E(this.loadFrames[0]),isBusy:false},thread2:{container:$E(this.loadFrames[1]),isBusy:false}};this.loadByList()}},this),10)},isIjaxReady:function(){if(typeof this.loadingIframe=="undefined"){return false}for(var a in this.loadingIframe){if(this.loadingIframe[a].isBusy==false){this.loadingIframe[a].isBusy=true;return this.loadingIframe[a]}}return false},request:function(a,c){var b={};b.url=a;b.option=c||{};this.arrTaskLists.push(b);if(this.loadFrames==null){this.createLoadingIframe()}else{this.loadByList()}},loadByList:function(){if(this.arrTaskLists.length==0){return false}var a=this.isIjaxReady();if(a==false){return false}var b=this.arrTaskLists[0];this.loadData(b.url,b.option,a);this.arrTaskLists.shift()},loadData:function(b,d,l){var c=new Utils.Url(b);if(d.GET){for(var m in d.GET){c.setParam(m,Core.String.encodeDoubleByte(d.GET[m]))}}if(!/\bdomain\b/.test(b)){c.setParam("domain","1")}c=c.toString();var i=l.container;i.listener=Core.Function.bind2(function(){try{var n=i.contentWindow.document,o;var p=Core.Dom.byClz(n,"textarea","")[0];if(typeof p!="undefined"){o=p.value}else{o=n.body.innerHTML}if(d.onComplete){d.onComplete(o)}else{d.onException()}}catch(q){traceError(q);if(d.onException){d.onException(q.message,c.toString())}}l.isBusy=false;Core.Events.removeEvent(i,i.listener,"load");this.loadByList()},this);Core.Events.addEvent(i,i.listener,"load");if(d.POST){var a=$C("form");a.id="IjaxForm";a.action=c;a.method="post";a.target=i.id;for(var j in d.POST){var k;if(d.noEncode){k=Core.String.encodeDoubleByte(d.POST[j])}else{k=d.POST[j]}var g=$C("input");g.type="hidden";g.name=j;g.value=k;a.appendChild(g)}document.body.appendChild(a);a.submit()}else{try{window.frames(i.id).location.href=c}catch(f){i.src=c}}}};Utils.Io.Ajax={createRequest:function(){var c=null;try{c=new XMLHttpRequest()}catch(b){try{c=new ActiveXObject("Msxml2.XMLHTTP")}catch(d){try{c=ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}}if(c==null){}else{return c}},request:function(a,b){b=b||{};b.onComplete=b.onComplete||function(){};b.onException=b.onException||function(){};b.returnType=b.returnType||"txt";b.method=b.method||"get";b.data=b.data||{};if(typeof b.GET!="undefined"&&typeof b.GET.url_random!="undefined"&&b.GET.url_random==0){this.rand=false;b.GET.url_random=null}return this.loadData(a,b)},loadData:function(url,option){var request=this.createRequest(),tmpArr=[];var _url=new Utils.Url(url);if(option.POST){for(var postkey in option.POST){var postvalue=option.POST[postkey];if(postvalue!=null){tmpArr.push(postkey+"="+Core.String.encodeDoubleByte(postvalue))}}}var sParameter=tmpArr.join("&")||"";if(option.GET){for(var key in option.GET){if(key!="url_random"){_url.setParam(key,Core.String.encodeDoubleByte(option.GET[key]))}}}if(this.rand!=false){}request.onreadystatechange=function(){if(request.readyState==4){var response,type=option.returnType;try{switch(type){case"txt":response=request.responseText;break;case"xml":if($IE){response=request.responseXML}else{var Dparser=new DOMParser();response=Dparser.parseFromString(request.responseText,"text/xml")}break;case"json":response=eval("("+request.responseText+")");break}option.onComplete(response)}catch(e){option.onException(e.message,_url);return false}}};try{if(option.POST){request.open("POST",_url,true);request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");request.send(sParameter)}else{request.open("GET",_url,true);request.send(null)}}catch(e){option.onException(e.message,_url);return false}return request}};if($IE6&&typeof Utils.Io.Ijax!="undefined"){Utils.Io.Ijax.loadData=function(b,d,n){var c=new Utils.Url(b);if(d.GET){for(var o in d.GET){c.setParam(o,Core.String.encodeDoubleByte(d.GET[o]))}}if(!/\bdomain\b/.test(b)){c.setParam("domain","1")}c=c.toString();var i=n.container;i.listener=Core.Function.bind2(function(){try{var p=i.contentWindow.document,q;var r=Core.Dom.byClz(p,"textarea","")[0];if(typeof r!="undefined"){q=r.value}else{q=p.body.innerHTML}if(d.onComplete){d.onComplete(q)}else{d.onException()}}catch(t){traceError(t);if(d.onException){d.onException(t.message,c.toString())}}n.isBusy=false;Core.Events.removeEvent(i,i.listener,"load");this.loadByList()},this);Core.Events.addEvent(i,i.listener,"load");if(d.POST){var a=$C("form");a.id="IjaxForm";a.action=c;a.method="post";a.target=i.id;for(var j in d.POST){var m;if(d.noEncode){m=Core.String.encodeDoubleByte(d.POST[j])}else{m=d.POST[j]}var g=$C("input");g.type="hidden";g.name=j;g.value=m;a.appendChild(g)}document.body.appendChild(a);var l=100;function k(){if(l>0){try{a.submit()}catch(p){setTimeout(k,10)}}l--}k()}else{try{window.frames(i.id).location.href=c}catch(f){i.src=c}}}}var Interface=function(a,b){this.url=new Utils.Url(a);this.type=b.toLowerCase()};Interface.prototype={url:null,type:"",request:function(b){var d=b.onError;var a=b.onSuccess;b.onComplete=b.onSuccess=function(f){try{if(typeof f=="string"){f=f.replace(/;$/,"")}f=(typeof f=="string"&&(/\s*{/.test(f)))?Core.String.j2o(f):f;if(f!=null&&typeof f.code=="undefined"){trace("接口数据异常："+this.url,"#F00");return}if(f!=null){if(f.code=="A00006"){a(f.data)}else{d(f)}}else{d(f)}}catch(g){traceError(g)}}.bind2(this);b.onException=b.onError=b.onFail||function(){trace("接口失败："+this.url,"#F00");if(arguments.length>0){for(var g=0,f=arguments.length;g<f;g++){if(arguments[g]&&typeof arguments[g]!="undefined"){trace("错误信息："+arguments[g].toString())}}}}.bind2(this);var c=this.url.toString();switch(this.type){case"ijax":Utils.Io.Ijax.request(c,b);break;case"ajax":Utils.Io.Ajax.request(c,b);break;case"script":case"jsload":Utils.Io.JsLoad.request(c,b);break;default:throw new Error("未指定有效的数据传输类型")}}};Lib.register("tray.loginOut",function(b){var a=b.Listener;return function(c,d){var f=encodeURIComponent(window.location.href);new Interface("http://control.blog.sina.com.cn/blog_rebuild/msn/api/msnLoginOut.php","jsload").request({onSuccess:function(g){a.notify("global-login-out",g);c&&c(g);if(d){window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+f}},onError:function(g){a.notify("global-login-out",g);if(d){window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+f}},onFail:function(g){a.notify("global-login-out",g);if(d){window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+f}}})}});Lib.register("tray.UserMenuPanel",function(b){var a=Core.Class.define(function(){b.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(b.tray.tpl.userMenu)},b.Panel,{initUserInfo:function(d){var c=this.getNodes();c.linkBlog.href="http://blog.sina.com.cn/u/"+d;c.linkPhoto.href="http://photo.blog.sina.com.cn/u/"+d;c.linkVBlog.href="http://you.video.sina.com.cn/m/"+d;c.miniblog.href="http://control.blog.sina.com.cn/t_sina_blog/tb.php?uname="+d;c.qingblog.href="http://qing.weibo.com/fancy.html";c.mySpace.href="http://blog.sina.com.cn/s/profile_"+d+".html";c.linkChangeFace.href="http://control.blog.sina.com.cn/blogprofile/nick.php";c.linkChangePassword.href="http://login.sina.com.cn/member/security/password.php";c.linkAccountSetup.href="http://login.sina.com.cn/member/security.php";this.initLoginOut(c.loginOut)},initLoginOut:function(c){c.onclick=function(){return false};Core.Events.addEvent(c,function(){b.tray.loginOut(null,!0)})}});return a});Lib.register("tray.tpl.blogMenu",function(){var a=['<div id="#{panel}" class="wrtBlog_sub">','<div class="wrtBlog_sub3">','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="http://control.blog.sina.com.cn/admin/article/article_add.php?tag365">写365</a></p>','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="http://control.blog.sina.com.cn/admin/article/changWeiBo.php">长微博</a></p>','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="http://control.blog.sina.com.cn/weiyulu/weiyulu.php">微语录</a></p>','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="http://control.blog.sina.com.cn/admin/article/daily.php">九宫格</a></p>','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="http://photo.blog.sina.com.cn/upload/upload.php">发照片</a></p>','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="http://vupload.you.video.sina.com.cn/u.php?m=1">发视频</a></p>',"</div>","</div>"].join("");return a});Lib.register("tray.BlogMenuPanel",function(b){var a=Core.Class.define(function(){b.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(b.tray.tpl.blogMenu)},b.Panel,{});return a});Core.String.trimHead=function(a){return a.replace(/^(\u3000|\s|\t)*/gi,"")};Core.String.trimTail=function(a){return a.replace(/(\u3000|\s|\t)*$/gi,"")};Core.String.trim=function(a){return Core.String.trimHead(Core.String.trimTail(a))};Lib.register("tray.tpl.searchForm",function(){var a=['<div class="ntopbar_input" id="#{panel}">','<form id="#{searchForm}" method="get" target="_blank" action="http://search.sina.com.cn">','<input id="#{queryTxt}" class="ntopbar_txt" type="text" name="q" autocomplete="off"/>','<input id="#{submit}" type="submit" onclick="v7sendLog(\'40_01_44\')" class="ntopbar_searchBtn" value=""/>','<input type="hidden" name="ie" value="utf-8"/>','<input type="hidden" name="e" value="utf-8"/>','<input id="#{range}" type="hidden" name="range" value="article"/>','<input id="#{t}" type="hidden" name="t" value=""/>','<input id="#{s}" type="hidden" name="s" value="sup"/>','<input id="#{by}" type="hidden" name="by" value="all"/>','<input id="#{type}" type="hidden" name="type" value=""/>','<input id="#{stype}" type="hidden" name="stype" value="1"/>','<input id="#{c}" type="hidden" name="c" value="blog"/>',"</form>","</div>"].join("");return a});Core.Dom.addClass=function(f,g){var l=Core.String.trim;g=l(g);if(!g){return f}f=$E(f);var b=l(f.className||"");var k=" "+b+" ";if(!b){f.className=l(g);return f}var c=g.split(" ");var a,j=[];for(var d=0;d<c.length;d++){a=c[d];if(a&&-1===k.indexOf(" "+a+" ")){j.push(a)}}f.className=b+" "+j.join(" ");return f};Core.Dom.removeClass=function(b,a){b=$E(b);b.className=b.className.replace(new RegExp("\\s*\\b"+a+"\\b"),"")};Core.String.byteLength=function(b){if(typeof b=="undefined"){return 0}var a=b.match(/[^\x00-\x80]/g);return(b.length+(!a?0:a.length))};Core.String.leftB=function(c,a){var b=c.replace(/\*/g," ").replace(/[^\x00-\xff]/g,"**");c=c.slice(0,b.slice(0,a).replace(/\*\*/g," ").replace(/\*/g,"").length);if(Core.String.byteLength(c)>a){c=c.slice(0,c.length-1)}return c};Lib.util.getActionData=function(p,d,b,a){if(!d){throw"[Lib.util.getActionData] param actionType is undefined!"}p=p||window.event;var c=Core.Events.getEventTarget,k,f,o,m,n,j,b=b||"action-type",a=a||"action-data";k=c(p);f=p.currentTarget||(document.documentElement||document.body);while(k&&k!=f){o=k.getAttribute(b)||"";m=o.split(",");for(var g=0,l=m.length;g<l;g++){n=m[g];if(d===n){j=k.getAttribute(a);return{actionType:d,targetEl:k,data:j}}}k=k.parentNode}return null};Lib.register("tray.tpl.cateSearch",function(){var a=['<div id="#{panel}" class="mCatSearch">',"<ul>",'<li action-type="tray-search" onclick="v7sendLog(\'40_01_43\')" action-data="article" class="current">含“<span id="#{article}"></span>”的博文</li>','<li action-type="tray-search" onclick="v7sendLog(\'40_01_43\')" action-data="bloger">含“<span id="#{bloger}"></span>”的博主</li>','<li action-type="tray-search" onclick="v7sendLog(\'40_01_43\')" action-data="music">含“<span id="#{music}"></span>”的音乐</li>','<li action-type="tray-search" onclick="v7sendLog(\'40_01_43\')" action-data="video">含“<span id="#{video}"></span>”的视频</li>',"</ul>","</div>"].join("");return a});Lib.register("tray.CateSearchPanel",function(d){var c=Core.Events.addEvent;var b=Core.String.leftB;var a=Core.String.byteLength;var f=Core.Class.define(function(){d.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(d.tray.tpl.cateSearch);this.initEvt()},d.Panel,{initEvt:function(){var g=this.getNodes();var i=$T(g.panel,"li");d.util.hoverJq({elm:i,mouseenter:function(j,l,k){Core.Dom.addClass(l,"current")},mouseleave:function(j,l,k){Core.Dom.removeClass(l,"current")},delay:50});c(g.panel,function(j){j=j||window.event;var k=d.util.getActionData(j,"tray-search");if(k){d.Listener.notify("tray-categroy-search",k.data)}})},updateSearch:function(i){if(5<a(i)){i=b(i,4)+"..."}var j=i.replace(/(<|>)/g,function(k){if("<"===k){return"&lt;"}else{return"&gt;"}});var g=this.getNodes();g.article.innerHTML=j;g.bloger.innerHTML=j;g.music.innerHTML=j;g.video.innerHTML=j}});return f});Lib.register("tray.SearchFormPanel",function(d){var b=Core.Events.addEvent;var c=Core.String.trim;var a=Core.Class.define(function(f){d.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(d.tray.tpl.searchForm);this.initEvt();this.catePanel=new d.tray.CateSearchPanel();this.catePanel.entity.style.zIndex=512;d.Listener.on({name:"tray-categroy-search",callBack:this.search,scope:this})},d.Panel,{initEvt:function(){var f=this;var g=this.getNode("queryTxt");b(g,function(i){i=i||window.event;var j=i.target||i.srcElement;var k=j.offsetWidth;f.showCateSearch(j,k,j.value)},"input");b(g,function(i){console.log(i);i=i||window.event;if("value"!==i.propertyName){return}var j=i.target||i.srcElement;var k=j.offsetWidth;f.showCateSearch(j,k,j.value)},"propertychange");b(g,function(i){i=i||window.event;var j=i.target||i.srcElement;var k=j.offsetWidth;f.showCateSearch(j,k,j.value)},"focus");b(this.getNode("searchForm"),function(i){i=i||window.event;var j=i.target||i.srcElement;if(!f.checkValidate(j)){Core.Events.stopEvent(i)}else{setTimeout(function(){f.hideCateSearch();f.resetForm()},100)}},"submit");b(window,function(){if(f.catePanel.isShow){var i=g.offsetWidth;f.catePanel.showWithDom(g,-i,4)}},"resize")},checkValidate:function(f){if(("q" in f)&&!c(f.q.value)){return false}else{if(("k" in f)&&!c(f.k.value)){return false}else{return true}}},setForm:function(k,i){var g={queryTxt:"q",ie:"utf-8",range:"",t:"",s:"",by:"",type:"",stype:"",e:"utf-8",c:""};var j=this.getNode("searchForm");j.action=k;d.apply(g,i);var n=this.getNode("queryTxt");n.name=g.queryTxt;delete g.queryTxt;var f,l;for(var m in g){f=g[m];if(typeof f==="string"&&(l=this.getNode(m))){l.value=f}}},resetForm:function(){this.setForm("http://search.sina.com.cn",{queryTxt:"q",range:"article",s:"sup",by:"all",stype:"1",c:"blog"})},search:function(j){var i=this.getNode("searchForm");var g="http://search.sina.com.cn";var f="http://video.sina.com.cn/search/index.php";var k="http://music.sina.com.cn/yueku/search/s.php";switch(j){case"video":this.setForm(f,{queryTxt:"k",s:"sup",type:"boke",stype:"1"});break;case"bloger":this.setForm(g,{queryTxt:"q",range:"author",s:"sup",by:"all",stype:"1",c:"blog"});break;case"music":this.setForm(k,{queryTxt:"k",t:"song"});break;default:this.setForm(g,{queryTxt:"q",range:"article",s:"sup",by:"all",stype:"1",c:"blog"})}if($IE){this.getNode("submit").click()}else{Core.Events.fireEvent(this.getNode("submit"),"click")}},showCateSearch:function(f,i,g){var j=this.catePanel;if(g&&j.isHidden){j.showWithDom(f,-i,4)}else{if(!g){this.hideCateSearch()}}j.updateSearch(g)},hideCateSearch:function(){var f=this.catePanel;f.hide();f.updateSearch("")}});return a});Lib.register("util.LS",function(a){var b=(function(c,d){if(c.localStorage){return c.localStorage}else{if(c.sessionStorage){return c.sessionStorage}else{if(c.globalStorage){return c.globalStorage}}}return(function(){var g={},i="data-userdata",j=document,f=j.body,k=function(n,p,l,o){f.load(i);l=f.getAttribute(i)||"";o=RegExp("\\b"+n+"\\b,?","i");var m=o.test(l)?1:0;l=p?l.replace(o,""):m?l:l===""?n:l.split(",").concat(n).join(",");f.setAttribute(i,l);f.save(i)};f.addBehavior("#default#userData");g.getItem=function(l){f.load(l);return f.getAttribute(l)};g.setItem=function(l,m){f.setAttribute(l,m);f.save(l);k(l)};g.removeItem=function(l){f.removeAttribute(l);f.save(l);k(l,1)};g.clear=function(){f.load(i);var m=f.getAttribute(i).split(","),l=m.length;if(m[0]===""){return}for(var n=0;n<l;n++){f.removeAttribute(m[n]);f.save(m[n])}f.setAttribute(i,"");f.save(i)};return g})()})(window);return b});Lib.register("tray.loadUserInfo",function(d){var a=d.util.LS;var c=d.util.JSON;var b=function(i,f){var g="http://interface.blog.sina.com.cn/riaapi/profile/getNickName.php";Utils.Io.JsLoad.request(g,{GET:{uid:i},onComplete:function(k){if(k&&"A00006"===k.code){var l=k.data.nickname;var j={time:new Date().getTime()/1000};d.apply(j,k.data);a.setItem("uid"+i,c.stringify(j));f(j)}},onException:function(){},timeout:10000})};return function(j,f,l){var i=a.getItem("uid"+j);if(!l&&i){i=c.parse(i);var k=new Date().getTime()/1000;var g=k-i.time;if(g<4*60&&i.nickname){f(i);return}}b(j,f)}});Sina.pkg("Utils.Flash");if(typeof deconcept=="undefined"){var deconcept=new Object()}if(typeof deconcept.util=="undefined"){deconcept.util=new Object()}if(typeof deconcept.SWFObjectUtil=="undefined"){deconcept.SWFObjectUtil=new Object()}deconcept.SWFObject=function(g,d,n,i,k,m,o,j,a,f){if(!document.getElementById){return}this.DETECT_KEY=f?f:"detectflash";this.skipDetect=deconcept.util.getRequestParameter(this.DETECT_KEY);this.params=new Object();this.variables=new Object();this.attributes=new Array();if(g){this.setAttribute("swf",g)}if(d){this.setAttribute("id",d)}if(n){this.setAttribute("width",n)}if(i){this.setAttribute("height",i)}if(k){this.setAttribute("version",new deconcept.PlayerVersion(k.toString().split(".")))}this.installedVer=deconcept.SWFObjectUtil.getPlayerVersion();if(!window.opera&&document.all&&this.installedVer.major>7){deconcept.SWFObject.doPrepUnload=true}if(m){this.addParam("bgcolor",m)}var b=o?o:"high";this.addParam("quality",b);this.setAttribute("useExpressInstall",false);this.setAttribute("doExpressInstall",false);var l=(j)?j:window.location;this.setAttribute("xiRedirectUrl",l);this.setAttribute("redirectUrl","");if(a){this.setAttribute("redirectUrl",a)}};deconcept.SWFObject.prototype={useExpressInstall:function(a){this.xiSWFPath=!a?"expressinstall.swf":a;this.setAttribute("useExpressInstall",true)},setAttribute:function(a,b){this.attributes[a]=b},getAttribute:function(a){return this.attributes[a]},addParam:function(a,b){this.params[a]=b},getParams:function(){return this.params},addVariable:function(a,b){this.variables[a]=b},getVariable:function(a){return this.variables[a]},getVariables:function(){return this.variables},getVariablePairs:function(){var a=new Array();var b;var c=this.getVariables();for(b in c){a[a.length]=b+"="+c[b]}return a},getSWFHTML:function(){var d="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","PlugIn");this.setAttribute("swf",this.xiSWFPath)}d='<embed pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+this.getAttribute("style")+'"';d+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" ';var c=this.getParams();for(var a in c){d+=[a]+'="'+c[a]+'" '}var b=this.getVariablePairs().join("&");if(b.length>0){d+="flashvars="+b+'&realfull=1&moz=1"'}d+="/>"}else{if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","ActiveX");this.setAttribute("swf",this.xiSWFPath)}d='<object id="'+this.getAttribute("id")+'" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,28,0" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+this.getAttribute("style")+'">';d+='<param name="movie" value="'+this.getAttribute("swf")+'" />';var c=this.getParams();for(var a in c){d+='<param name="'+a+'" value="'+c[a]+'" />'}var b=this.getVariablePairs().join("&");if(b.length>0){d+='<param name="flashvars" value="'+b+'" />'}d+="</object>"}return d},write:function(a){if(this.getAttribute("useExpressInstall")){var c=new deconcept.PlayerVersion([6,0,65]);if(this.installedVer.versionIsValid(c)&&!this.installedVer.versionIsValid(this.getAttribute("version"))){this.setAttribute("doExpressInstall",true);this.addVariable("MMredirectURL",escape(this.getAttribute("xiRedirectUrl")));document.title=document.title.slice(0,47)+" - Flash Player Installation";this.addVariable("MMdoctitle",document.title)}}if(this.skipDetect||this.getAttribute("doExpressInstall")||this.installedVer.versionIsValid(this.getAttribute("version"))){}else{if(this.getAttribute("redirectUrl")!=""){document.location.replace(this.getAttribute("redirectUrl"))}}var d=(typeof a=="string")?document.getElementById(a):a;var b=document.title;d.innerHTML=this.getSWFHTML();if(b!==document.title){document.title=b}return true}};deconcept.SWFObjectUtil.getPlayerVersion=function(){var c=new deconcept.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var a=navigator.plugins["Shockwave Flash"];if(a&&a.description){c=new deconcept.PlayerVersion(a.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."))}}else{if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0){var d=1;var b=3;while(d){try{b++;d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+b);c=new deconcept.PlayerVersion([b,0,0])}catch(f){d=null}}}else{try{var d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(f){try{var d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");c=new deconcept.PlayerVersion([6,0,21]);d.AllowScriptAccess="always"}catch(f){if(c.major==6){return c}}try{d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(f){}}if(d!=null){c=new deconcept.PlayerVersion(d.GetVariable("$version").split(" ")[1].split(","))}}}return c};deconcept.PlayerVersion=function(a){this.major=a[0]!=null?parseInt(a[0]):0;this.minor=a[1]!=null?parseInt(a[1]):0;this.rev=a[2]!=null?parseInt(a[2]):0};deconcept.PlayerVersion.prototype.versionIsValid=function(a){if(this.major<a.major){return false}if(this.major>a.major){return true}if(this.minor<a.minor){return false}if(this.minor>a.minor){return true}if(this.rev<a.rev){return false}return true};deconcept.util={getRequestParameter:function(d){var c=document.location.search||document.location.hash;if(d==null){return c}if(c){var b=c.substring(1).split("&");for(var a=0;a<b.length;a++){if(b[a].substring(0,b[a].indexOf("="))==d){return b[a].substring((b[a].indexOf("=")+1))}}}return""}};deconcept.SWFObjectUtil.cleanupSWFs=function(){var c=document.getElementsByTagName("OBJECT");for(var b=c.length-1;b>=0;b--){c[b].style.display="none";for(var a in c[b]){if(typeof c[b][a]=="function"){c[b][a]=function(){}}}}};if(deconcept.SWFObject.doPrepUnload){if(!deconcept.unloadSet){deconcept.SWFObjectUtil.prepUnload=function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};window.attachEvent("onunload",deconcept.SWFObjectUtil.cleanupSWFs)};window.attachEvent("onbeforeunload",deconcept.SWFObjectUtil.prepUnload);deconcept.unloadSet=true}}if(!document.getElementById&&document.all){document.getElementById=function(a){return document.all[a]}}var getQueryParamValue=deconcept.util.getRequestParameter;var FlashObject=deconcept.SWFObject;Utils.Flash.swfObject=deconcept.SWFObject;Lib.register("tray.MsgLoader",function(f){var a=function(g){var i=$C("div");g.write(i);document.body.appendChild(i)};var c="",b;if(window.$Maxthon||window.$360||window.$TT){c="?t="+Core.Math.getUniqueId()}var d=function(g){f.apply(this,g);if(!b){try{var i=new Utils.Flash.swfObject($_GLOBAL.flashBasicURL+"blogMessageReminding.swf"+c,"__msgTipsPlayer","1px","1px","9","#00ff00");i.addParam("quality","high");i.addParam("wmode","transparent");i.addParam("allowScriptAccess","always");i.addParam("freeTime",27*1000);if("complete"===document.readyState){a(i);b=$E("__msgTipsPlayer")}else{_addEvt(window,function(){a(i);b=$E("__msgTipsPlayer")},"load")}}catch(j){}}}.$define({time:30,url:"http://comet.blog.sina.com.cn/notice",getFlaDom:function(){return b},play:function(){if($_GLOBAL.msgPlaySound&&b&&b.PlaySound){try{b.PlaySound()}catch(g){}}},load:function(j,g){var k=this;var i=scope.$articleid||"";if(!j){return}Utils.Io.JsLoad.request(this.url,{GET:{uid:j||"",blogid:i},onComplete:function(o){if(o&&"A00006"==o.code){var p,n;if(j&&(p=o.data[j])){var m={};m.sum=0;for(var l in p){m[l]=p[l];m.sum+=p[l]}m.blogrecomment=m.blogrecomment?m.blogrecomment:0;f.Listener.notify("tray-newmsg-loaded",m)}if(i&&(n=o.data[i])){f.Listener.notify("article-msg-loaded",n)}}},onException:function(){},timeout:10000})}});return d});Lib.register("tray.tpl.notice",function(){var a=['<div id="#{panel}" class="horn">','<div id="#{tj}" class="horn_con" style="display:none;">推荐：<a id="#{noticeAd1}" target="_blank" href="#"></a><a id="#{noticeAd2}" target="_blank" href="#"></a></div>','<div id="#{announce}" class="horn_con" style="display:none;"><p id="#{announceCon}">公告：<em>请您及时更换请请请您正在使用的模版将于2周后被下线，请您及时更换</em></p></div>','<a class="close" title="关闭" id="#{close}" style="float:none;">×</a>',"</div>"].join("");return a});Lib.register("tray.BlogNotice",function(f){var d=Core.Events.addEvent,b=Utils.Cookie.setCookie,a=scope.$pageid;var c=Core.Class.define(function(){f.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(f.tray.tpl.notice);this.initEvt()},f.Panel,{initEvt:function(){var g=this;d(this.getNode("close"),function(i){i=i||window.event;b("closeNotice_fzp",$UID,24,"/",".blog.sina.com.cn");f.Listener.notify("tray-announce-close",{});g.destroy()})},update:function(p){var m=this.getNode("tj"),k=this.getNode("announce");var i="";var o=["SLOT_58","SLOT_59","SLOT_98","SLOT_99","SLOT_100","SLOT_101","SLOT_102"];var l="http://interface.blog.sina.com.cn/riaapi/pageslot/pageslot.php";var j={id:o};if(typeof scope!="undefined"){j.blogeruid=scope.$uid}if($UID){j.loginuid=$UID}if($isLogin&&p.announce.result&&(a==="indexM"||a==="articleM"||a==="articlelistM")){k.innerHTML=p.announce.announce_con;k.style.display=""}else{var q=this.getNode("noticeAd1");var n=this.getNode("noticeAd2");var g=function(u){var t=0;var r=u[o[0]].res;var v=u[o[1]].res;if(r||v){if(r){t=0;if(r.length>1){t=Math.floor((r.length+1)*Math.random())}q.innerHTML=r[t].words;q.href=r[t].a_href;q.title=r[t].a_title;q.setAttribute("suda-uatrack",r[t].a_c_suda.replace("suda-uatrack=","").replace('"',"").replace('"',""));if(typeof SUDA!=="undefined"){SUDA.uaTrack(r[t].a_v_suda_key,r[t].a_v_suda_value)}}if(v){t=0;if(v.length>1){t=Math.floor((v.length+1)*Math.random())}n.innerHTML=v[t].words;n.href=v[t].a_href;n.title=v[t].a_title;n.setAttribute("suda-uatrack",v[t].a_c_suda.replace("suda-uatrack=","").replace('"',"").replace('"',""));if(typeof SUDA!=="undefined"){SUDA.uaTrack(v[t].a_v_suda_key,v[t].a_v_suda_value)}}m.style.display=""}};if(scope.__subscribeSlot==="waitting"){scope.__subscribeSlotFunc=g}else{if(typeof scope.__subscribeSlot==="object"){g(scope.__subscribeSlot)}else{scope.__subscribeSlot="waitting";Utils.Io.JsLoad.request(l,{GET:j,onComplete:function(r){g(r);scope.__subscribeSlot=r;if("function"==typeof scope.__subscribeSlotFunc){scope.__subscribeSlotFunc(r)}},onException:function(){}})}}}},setTemplate:function(i){this.template=i;var g=new Lib.HtmlTemplate(this.template,this.uniqueID);this.tpl=g;Core.Dom.insertHTML($E(this.appendTo),g.getHtmlString(),"afterbegin");this.entity=$E("_"+this.uniqueID+"_panel");this.entity.style.display="none";tempEntity=null}});return c});Core.Dom.getStyle=function(a,c){switch(c){case"opacity":var f=100;try{f=a.filters["DXImageTransform.Microsoft.Alpha"].opacity}catch(d){try{f=a.filters("alpha").opacity}catch(d){}}return f/100;case"float":c="styleFloat";default:var b=a.currentStyle?a.currentStyle[c]:null;return(a.style[c]||b)}};if(!$IE||$IE>8){Core.Dom.getStyle=function(a,c){if(c=="float"){c="cssFloat"}try{var b=document.defaultView.getComputedStyle(a,"")}catch(d){traceError(d)}return a.style[c]||b?b[c]:null}}Core.System.getScrollPos=function(c){c=c||document;var a=c.documentElement;var b=c.body;return[Math.max(a.scrollTop,b.scrollTop),Math.max(a.scrollLeft,b.scrollLeft),Math.max(a.scrollWidth,b.scrollWidth),Math.max(a.scrollHeight,b.scrollHeight)]};Core.Dom.getXY=function(b){if((b.parentNode==null||b.offsetParent==null||Core.Dom.getStyle(b,"display")=="none")&&b!=document.body){return false}var a=null;var g=[];var c;var d=b.ownerDocument;c=b.getBoundingClientRect();var f=Core.System.getScrollPos(b.ownerDocument);return[c.left+f[1],c.top+f[0]];a=b.parentNode;while(a.tagName&&!/^body|html$/i.test(a.tagName)){if(Core.Dom.getStyle(a,"display").search(/^inline|table-row.*$/i)){g[0]-=a.scrollLeft;g[1]-=a.scrollTop}a=a.parentNode}return g};if(!$IE){Core.Dom.getXY=function(b){if((b.parentNode==null||b.offsetParent==null||Core.Dom.getStyle(b,"display")=="none")&&b!=document.body){return false}var a=null;var g=[];var c;var d=b.ownerDocument;g=[b.offsetLeft,b.offsetTop];a=b.offsetParent;var f=Core.Dom.getStyle(b,"position")=="absolute";if(a!=b){while(a){g[0]+=a.offsetLeft;g[1]+=a.offsetTop;if($SAFARI&&!f&&Core.Dom.getStyle(a,"position")=="absolute"){f=true}a=a.offsetParent}}if($SAFARI&&f){g[0]-=b.ownerDocument.body.offsetLeft;g[1]-=b.ownerDocument.body.offsetTop}a=b.parentNode;while(a.tagName&&!/^body|html$/i.test(a.tagName)){if(Core.Dom.getStyle(a,"display").search(/^inline|table-row.*$/i)){g[0]-=a.scrollLeft;g[1]-=a.scrollTop}a=a.parentNode}return g}}Lib.register("tray.unReadMsgPanel",function(a){var b=Core.Class.define(function(d){a.Panel.prototype.initialize();if(scope.$pageid=="editor"){return}this._lockstate=0;this._scrolling=0;this._srcPot=d;var c=['<div class="cor"></div>','<div class="bd">','<a href="#" id="j-unread-msg-close" class="close" title="关闭">×</a>','<ul id="j-unre-list">',"</ul>","</div>"].join("");this.setTemplate('<div class="messageTips" id="#{panel}" style="left:850px; top:10px;">'+c+"</div>");this.entity.style.zIndex=500;this._bindEvent()},a.Panel,{show:function(){if(this.isShow){return}v7sendLog("40_02_01");this.entity.style.display="";this._srcPot&&this._srcPot.setAttribute("unread-show-state",1);this.isHidden=!1;this.isShow=!0;if(this.backIframe){this._updateBackIframe();this.backIframe.style.display=""}a.Listener.notify("tray-unread-panel-show",{})},hide:function(){a.Panel.prototype.hide.call(this);this._srcPot&&this._srcPot.setAttribute("unread-show-state",0);a.Listener.notify("tray-unread-panel-hide",{})},_updatePanelIframe:function(){if(this.backIframe){this._updateBackIframe()}},_updateCont:function(i){var f=[];if((i.comment+i.message+i.notice+i.gbook)==0){this.hide();return}if(i.comment>0){f.push("<li>"+i.comment+'条新评论，<a onclick="v7sendLog(\'40_02_02\')" href="http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1">查看评论</a></li>')}if(i.message>0){f.push("<li>"+i.message+'条新纸条，<a onclick="v7sendLog(\'40_02_03\')" href="http://control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1">查看纸条</a></li>')}if(i.gbook>0){f.push("<li>"+i.gbook+'条新留言，<a onclick="v7sendLog(\'40_02_04\')" href="http://i.blog.sina.com.cn/blogprofile/wall.php">查看留言</a></li>')}if(i.notice>0){var g={notice:"http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote",like:"http://i.blog.sina.com.cn/profilelist/profilelikelist.php",notice_favourite:"http://i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice",notice_quote:"http://i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice",invite:"http://control.blog.sina.com.cn/blogprofile/profileinvitelist.php",unreadnotices:"http://i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice"};var c=g.notice;for(var d in i.notices){if(i.notices[d]>0){c=g[d];break}}f.push("<li>"+i.notice+'条新通知，<a onclick="v7sendLog(\'40_02_05\')" href="'+c+'">查看通知</a></li>')}$E("j-unre-list").innerHTML=f.join("");this.show();this._setThePos()},_setThePos:function(){var g=Core.Dom.getXY(this._srcPot);var d=this._srcPot.className=="link"?-2:0;var i=($IE7||$IE6)?this.entity.offsetWidth:this.entity.clientWidth;if(g[0]){var c=g[0]+this._srcPot.clientWidth-i+d;var f=0;if(this._srcPot.getAttribute("adshow")==1&&this._scrolling==0){f=g[1]}var j=this._srcPot.clientHeight+f+10;this.setPosition(c,j)}},_bindEvent:function(){var c=this;Lib.Listener.on({name:"tray-newmsg-loaded",callBack:function(d){if(c._lockstate){return}c._eventHandle(d);c._setThePos()}});Lib.Listener.on({name:"tray-scrolling-fix",callBack:function(d){c._scrolling=1;if(c._lockstate){return}c.setFixed(1);c._setThePos()}});Lib.Listener.on({name:"tray-scrolling-nofix",callBack:function(d){c._scrolling=0;if(c._lockstate){return}c.setFixed(0);c._setThePos()}});Lib.Listener.on({name:"topad680-show-end",callBack:function(d){c._srcPot.setAttribute("adshow",1);if(c.isShow){c._setThePos()}}});Core.Events.addEvent($E("j-unread-msg-close"),function(f){var d=f||window.event;if(d.preventDefault){d.preventDefault()}else{d.returnValue=false}c.hide();c._lockstate=1},"click");Core.Events.addEvent(window,function(){if(c.isShow){c._setThePos()}},"resize")},_eventHandle:function(d){var c={};c.comment=(d.blogcomment-0)+(d.photocomment-0)+d.blogrecomment;c.notice=d.notice+d.like+d.notice_favourite+d.notice_quote+d.invite+d.unreadnotices;c.notices={notice:d.notice,like:d.like,notice_favourite:d.notice_favourite,notice_quote:d.notice_quote,invite:d.invite,unreadnotices:d.unreadnotices};c.message=d.message;c.gbook=d.gbook;this._updateCont(c)}});return b});Lib.register("tray.msgSummaryPanel",function(d){var c=d.util.JSON;var b=['<li><a onclick="v7sendLog(\'40_02_12\')" href="http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1"><span class="icoms_comment"></span>查看评论</a></li>','<li><a onclick="v7sendLog(\'40_02_13\')" href="http://control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1"><span class="icoms_tips"></span>查看纸条</a></li>','<li><a onclick="v7sendLog(\'40_02_14\')" href="http://i.blog.sina.com.cn/blogprofile/wall.php"><span class="icoms_message"></span>查看留言</a></li>','<li><a onclick="v7sendLog(\'40_02_15\')" href="http://i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice"><span class="icoms_notice"></span>查看通知</a></li>'];var a=Core.Class.define(function(g){d.Panel.prototype.initialize();this._srcPot=g;this._lock=1;this._scrolling=0;this._requirestate=1;this._nums={};var f=['<div class="bd">','<ul id="j-summary-list">',b.join(""),"</ul>","</div>"].join("");this.setTemplate('<div class="messageBox" id="#{panel}">'+f+"</div>");this.entity.style.zIndex=500;this._bindEvent();this._initNums()},d.Panel,{show:function(){var f=this;if(this._checkNumChange()){this._updateCont()}else{this._showAction()}},_showAction:function(){if(this.isHidden){this._srcPot&&this._srcPot.setAttribute("msg-panel-show-state",1);this.entity.style.display="";this.isHidden=!1;this.isShow=!0;if(this.backIframe){this._updateBackIframe();this.backIframe.style.display=""}this._setThePos()}else{this._setThePos()}},_checkNumChange:function(){var f=this._srcPot.getAttribute("msg-count");var g=this._srcPot.getAttribute("old-msg-count");if(f==g){return false}else{return true}},hide:function(){d.Panel.prototype.hide.call(this);this._srcPot&&this._srcPot.setAttribute("msg-panel-show-state",0);d.Listener.notify("tray-msg-panel-hide",{})},_initNums:function(){var f=c.parse(this._srcPot.getAttribute("msg-count"));this._formatData(f)},_setThePos:function(){if($IE6||$IE7||$IE8){this.entity.style.width="auto"}var j=Core.Dom.getXY(this._srcPot);var g=this._srcPot.className=="link"?-2:0;var k=($IE7||$IE6)?this.entity.offsetWidth:this.entity.clientWidth;var f=j[0]+this._srcPot.clientWidth-k+g;var i=0;if(this._srcPot.getAttribute("adshow")==1&&this._scrolling==0){if($IE6||$IE7||$IE8){i=j[1]-2}else{i=j[1]}}var l=this._srcPot.clientHeight+i+1;if($IE6||$IE7||$IE8){this.entity.style.width=this.entity.clientWidth+1+"px";this.entity.style.width=this.entity.clientWidth-1+"px"}this.setPosition(f,l)},_updatePanelIframe:function(){if(this.backIframe){this._updateBackIframe()}},_updateCont:function(f){var g=[];var i=this;this._lock=0;if(this._requirestate){this._getDate({},function(j){g.push(i._getComment(j));g.push(i._getMessage(j));g.push(i._getGbook(j));g.push(i._getNotice(j));$E("j-summary-list").innerHTML=g.join("");i._srcPot.setAttribute("old-msg-count",i._srcPot.getAttribute("msg-count"));if($IE6){$E("j-summary-list").style.width="270px"}i._showAction()},function(j){});this._requirestate=0}},_getDate:function(j,g,i){g=g||function(){};i=i||function(){};var k=this;Lib.checkAuthor();var f=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/notelist.php","jsload");f.request({GET:{uid:$UID},onSuccess:function(l){g(l)}.bind2(this),onError:function(l){i({num:0})}.bind2(this),onFail:function(){i({num:0})}.bind2(this)})},_getUserPicUrl:function(g,f){var f=f||50;var i=parseInt(g)%8+1;return"http://portrait"+i+".sinaimg.cn/"+g+"/blog/"+f},getLen:function(g){if(!g){return 0}var f=g.match(/[^\x00-\xff]/g);return g.length+(f?f.length:0)},strTruncate:function(i,f,g){i=i||"";if(typeof g=="undefined"){g="..."}return(this.getLen(i)>f)?(this.truncete(i,f)+g):i},truncete:function(f,i){var g=f.replace(/\*/g," ").replace(/[^\x00-\xff]/g,"**");f=f.slice(0,g.slice(0,i).replace(/\*\*/g," ").replace(/\*/g,"").length);this.getLen(f)>i&&i>0&&(f=f.slice(0,f.length-1));return f},getVipIcon:function(g){if(!g){return""}var i={1:{icon:"SG_icon146",info:"新浪个人认证"},2:{icon:"SG_icon147",info:"新浪机构认证"}};var g=g||1;var f='<img class="SG_icon '+i[g].icon+'" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="13" title="'+i[g].info+'" alt="'+i[g].info+'" align="absmiddle" />';return f},_setNameforIE6:function(f){if($IE6){return this.strTruncate(f,4)}else{return f}},_getComment:function(j){var u="";if(this._nums._comment>0){var n=j.msg.cms;if(n.length>0){var k={1:"评论了你的博文",2:"评论了你的图片",6:"回复了你的评论"};var f={1:"http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1",2:"http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=2",6:"http://i.blog.sina.com.cn/blogprofile/profilereplylist.php"};var q=[];for(var o=0,r=n.length;o<r;o++){var v=n[o];var g=v.nick_name||v.name;g=this._setNameforIE6(g);var m=this._getUserPicUrl(v.uid,30);var t=v.msg_type;q.push(t);var p=v.user_type||0;var l=v.time;u+='<li><a onclick="v7sendLog(\'40_02_06\')" href="'+f[t]+'"><img src="'+m+'"><em class="nl">'+g+"</em>"+this.getVipIcon(p)+'<em class="tm">'+l+"</em>"+k[t]+"</a></li>"}q.sort();if(this._nums._comment>3){u+='<li class="lcount"><a onclick="v7sendLog(\'40_02_07\')" href="'+f[q[0]]+'">总共'+this._nums._comment+"条新评论</a></li>"}else{}}else{u=b[0]}}else{u=b[0]}return u},_getMessage:function(j){var l="";if(this._nums._message>0){var k=j.msg.note[0];var i=k.name||k.nick_name;i=this._setNameforIE6(i);var f=this._nums._message>1?"等"+this._nums._message+"人":"";var g=k.user_type||0;l+='<li class="bgc"><a onclick="v7sendLog(\'40_02_08\')" href="http://control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1"><span class="icoms_tips"></span><em class="nl">'+i+"</em>"+this.getVipIcon(g)+f+'发来纸条<em class="nr">查看纸条</em></a></li>'}else{l=b[1]}return l},_getGbook:function(j){var l="";if(this._nums._gbook>0){var k=j.msg.note[1];var i=k.name||k.nick_name;if(i){i=this._setNameforIE6(i);var f=this._nums._gbook>1?"等"+this._nums._gbook+"人":"给你";var g=k.user_type||0;l+='<li class="bgc"><a onclick="v7sendLog(\'40_02_09\')" href="http://i.blog.sina.com.cn/blogprofile/wall.php"><span class="icoms_message"></span><em class="nl">'+i+"</em>"+this.getVipIcon(g)+f+'留言<em class="nr">查看留言</em></a></li>'}}else{l=b[2]}return l},_getNotice:function(i){var l="";var f="http://i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice";var m="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote";var k={3:"http://control.blog.sina.com.cn/blogprofile/profileinvitelist.php",7:f,8:f,9:f,23:f,13:"http://i.blog.sina.com.cn/profilelist/profilelikelist.php",100:m,101:m,102:m,103:m,104:m,105:m,106:m,107:m,108:m,109:m,110:m,111:m,112:m};if(this._nums._notice>0){var j=i.msg.note[2];var g=j.msg_type;l+='<li class="bgc last"><a onclick="v7sendLog(\'40_02_10\')" href="'+k[g]+'"><span class="icoms_notice"></span>'+this._nums._notice+'条新通知<em class="nr">查看通知</em></a></li>'}else{l=b[3]}return l},_bindEvent:function(){var f=this;Lib.Listener.on({name:"tray-newmsg-loaded",callBack:function(g){f._requirestate=1;f._eventHandle(g)}});Lib.Listener.on({name:"tray-scrolling-nofix",callBack:function(g){f._scrolling=0;if(f._lockstate){return}f.setFixed(0);f._setThePos()}});Lib.Listener.on({name:"tray-scrolling-fix",callBack:function(g){f._scrolling=1;if(f._lockstate){return}f.setFixed(1);f._setThePos()}});Lib.Listener.on({name:"topad680-show-end",callBack:function(g){if(f.isShow){f._setThePos()}}})},_eventHandle:function(f){this._formatData(f);if(this.isShow){this._updateCont()}},_formatData:function(g){var f={};f._comment=(g.blogcomment-0)+(g.photocomment-0)+g.blogrecomment;f._notice=g.notice+g.like+g.notice_favourite+g.notice_quote+g.invite+g.unreadnotices;f._message=g.message;f._gbook=g.gbook;this._cacheNums(g,f)},_cacheNums:function(j,i){for(var f in j){this._nums[f]=j[f]}for(var g in i){this._nums[g]=i[g]}}});return a});Core.System.winSize=function(b){var a,c;if(b){target=b.document}else{target=document}if(self.innerHeight){if(b){target=b.self}else{target=self}a=target.innerWidth;c=target.innerHeight}else{if(target.documentElement&&target.documentElement.clientHeight){a=target.documentElement.clientWidth;c=target.documentElement.clientHeight}else{if(target.body){a=target.body.clientWidth;c=target.body.clientHeight}}}return{width:a,height:c}};Core.System.pageSize=function(c){if(c){target=c.document}else{target=document}var f=(target.compatMode=="CSS1Compat"?target.documentElement:target.body);var d,b;if(window.innerHeight&&window.scrollMaxY){d=f.scrollWidth;b=window.innerHeight+window.scrollMaxY}else{if(f.scrollHeight>f.offsetHeight){d=f.scrollWidth;b=f.scrollHeight}else{d=f.offsetWidth;b=f.offsetHeight}}var a=Core.System.winSize(c);if(b<a.height){pageHeight=a.height}else{pageHeight=b}if(d<a.width){pageWidth=a.width}else{pageWidth=d}return[pageWidth,pageHeight,a.width,a.height]};(function(){function b(f,c){this.node=f;this.config=c;for(var d in this.defaultConfig){this.config[d]=this.defaultConfig[d]}this.initialize();return this}b.prototype={defaultConfig:{preloadPixel:500},initialize:function(){this.viewableHeight=a.getViewableHeight();a.enrol(this)},callback:function(d){if(this.node.length==0){return}this.viewableHeight=d||this.viewableHeight;var g=[];for(var f=0,c=this.node.length;f<c;f++){if(this.node[f]&&this.node[f].dom==null&&Core.Dom.getXY(this.node[f])[1]<this.viewableHeight+this.config.preloadPixel){this.config.callback(this.node[f]);this.node[f]=null}else{if(this.node[f]&&this.node[f].dom&&Core.Dom.getXY(this.node[f].dom)[1]<this.viewableHeight+this.config.preloadPixel){this.node[f].callback(this.node[f].dom);this.node[f]=null}else{g.push(this.node[f])}}}this.node=g}};var a={_isInit:null,_binder:null,_isWindow:null,_member:[],initialize:function(){var c=window,d=c==window||c==document||!c.tagName||(/^(?:body|html)$/i).test(c.tagName);if(d){var f=c.document;c=(f.compatMode=="CSS1Compat"&&($IE||$FF||$OPERA))?f.documentElement:f.body}this._container=c;this._binder=d?window:c;this._isWindow=d;this._isInit=true;this.delayResize();this.bindEvent()},getViewableHeight:function(){var c=a._container.scrollTop+Core.System.winSize().height;this.eyeableHeight=c;return c},bindEvent:function(){if(!this._isInit){this.initialize();return}Core.Events.addEvent(this._binder,a.delayLoad,"scroll");if(this._isWindow){Core.Events.addEvent(this._binder,a.delayResize,"resize")}this.binded=true},unbindEvent:function(){Core.Events.removeEvent(a._binder,a.delayLoad,"scroll");if(this._isWindow){Core.Events.removeEvent(a._binder,a.delayResize,"resize")}this.binded=false},delayLoad:function(){if(a.scrollWatch){clearTimeout(a.scrollWatch)}a.scrollWatch=setTimeout(function(){a.callback();clearTimeout(a.scrollWatch);a.scrollWatch=null},100)},delayResize:function(){if(a.resizeWatch){clearTimeout(a.resizeWatch)}a.resizeWatch=setTimeout(function(){a.callback();clearTimeout(a.resizeWatch);a.resizeWatch=null},100)},enrol:function(c){a._member.push(c)},callback:function(){a.getViewableHeight();if(a._member.length>0){for(var d=0,c=a._member.length;d<c;d++){a._member[d].callback(a.eyeableHeight)}}if(a.eyeableHeight==Core.System.pageSize()[1]){a.unbindEvent()}}};Lib.LazyLoad=function(d,c){if(a.binded!=true){a.bindEvent(d,c)}new b(d,c)}})();var Layer=function(b){this.entity=null;this.ifm=null;var d=this;var c={width:0,height:0,x:0,y:0,isFixed:false,uniqueID:"",entityID:"",contentID:"",template:b,templateString:"",nodes:{}};this.getProperty=function(){return c};(function a(){var f=d.getProperty();f.uniqueID="_"+d.getUniqueID();f.entityID=f.uniqueID+"_entity";f.contentID=f.uniqueID+"_content";d.setTemplate(f.template);f.width=parseInt(d.entity.style.width);if($IE6){d.addIframe()}document.body.appendChild(d.entity);d.hidden()})();this._ie6Fixed=function(){d.entity.style.left=document.documentElement.scrollLeft+d.getProperty().x+"px";d.entity.style.top=document.documentElement.scrollTop+d.getProperty().y+"px";if(d.ifm){d.ifm.style.left=document.documentElement.scrollLeft+d.getProperty().x+"px";d.ifm.style.top=document.documentElement.scrollTop+d.getProperty().y+"px"}}};Layer.prototype={setTemplate:function(c){var f=this.getProperty();if(this.entity){this.entity.parentNode.removeChild(this.entity);this.entity=null}if(typeof c=="object"){f.nodes=c;if(this.entity){this.entity.parentNode.removeChild(this.entity);this.entity=null}this.entity=f.nodes.entity;document.body.appendChild(this.entity);if(!f.nodes.entity||!f.nodes.content){throw new Error("[layer.js] missing entity or content in layer nodes")}else{this.entity.style.position="absolute";this.entity.style.zIndex="1024";this.entity.style.left=f.x+"px";this.entity.style.top=f.y+"px"}return}var d=/[^\{\}]+(?=\})/g;f.template=c;f.templateString=f.template.match(d);this.entity=$C("div");var b=$C("div");var a=new Ui.Template(f.template);b.innerHTML=a.evaluate(this.getNodes("i"));document.body.appendChild(b);if(!$E(f.entityID)||!$E(f.contentID)){throw new Error("[layer.js] there missing #{entityID} or #{contentID} in layer template")}else{this.entity=$E(f.entityID);this.entity.style.position="absolute";this.entity.style.zIndex="1024";this.entity.style.left=f.x+"px";this.entity.style.top=f.y+"px";document.body.replaceChild(this.entity,b);b=null}f.nodes=this.getNodes()},setSize:function(a){var b=this.getProperty();Core.System.parseParam(b,a);if(a.width){b.nodes.content.style.width=b.width+"px"}if(a.height){b.nodes.content.style.height=b.height+"px"}this.updateIfmSize()},setPosition:function(a){var b=this.getProperty();Core.System.parseParam(b,a);this.entity.style.left=b.x+"px";this.entity.style.top=b.y+"px";if($IE6&&b.isFixed){this.entity.style.left=b.x+document.documentElement.scrollLeft+"px";this.entity.style.top=b.y+document.documentElement.scrollTop+"px"}if(this.ifm){this.ifm.style.left=this.entity.style.left;this.ifm.style.top=this.entity.style.top}},getWidth:function(){var a=this.entity.style.display;var b=this.entity.style.visibility;this.entity.style.visibility="hidden";this.entity.style.display="";w=this.entity.offsetWidth;this.entity.style.display=a;this.entity.style.visibility=b;return w},getHeight:function(){var a=this.entity.style.display;var b=this.entity.style.visibility;this.entity.style.visibility="hidden";this.entity.style.display="";h=this.entity.offsetHeight;this.entity.style.display=a;this.entity.style.visibility=b;return h},getX:function(){return parseInt(this.entity.style.left)},getY:function(){return parseInt(this.entity.style.top)},updateIfmSize:function(){if(this.ifm){var a=this;a.ifm.style.width=a.entity.offsetWidth+"px";a.ifm.style.height=a.entity.offsetHeight+"px"}},setFixed:function(b){var a=this.getProperty();a.isFixed=b;var c=this;if($IE6){c.entity.style.position="absolute";if(a.isFixed){c._ie6Fixed();Core.Events.addEvent(window,c._ie6Fixed,"scroll")}else{Core.Events.removeEvent(window,c._ie6Fixed,"scroll")}return}if(a.isFixed&&$FF2){c.updateFixed();return}this.entity.style.position=a.isFixed?"fixed":"absolute"},updateFixed:function(){var c=this.getProperty();if(c.isFixed&&$FF2){var d=this;var b=c.x,a=c.y;d.entity.style.position="absolute";d.setPosition({x:c.x+document.documentElement.scrollLeft,y:c.y+document.documentElement.scrollTop});d.entity.style.position="fixed";d.setPosition({x:b,y:a})}},show:function(){this.entity.style.display="";if(this.ifm){this.ifm.style.display="";this.updateIfmSize()}},hidden:function(){this.entity.style.display="none";if(this.ifm){this.ifm.style.display="none"}},addIframe:function(){this.ifm=$C("iframe");this.ifm.style.position="absolute";this.ifm.style.zIndex="1024";this.ifm.style.left=this.entity.style.left;this.ifm.style.top=this.entity.style.top;document.body.appendChild(this.ifm);Core.Dom.setStyle(this.ifm,"opacity",0)},getNodes:function(j){var g=this.getProperty();var b=j||"o";var d;var c={};var a=g.templateString;if(a){for(d=0;d<a.length;d++){var f=a[d];switch(b){case"o":c[f]=$E(g.uniqueID+"_"+f);break;case"i":c[f]=g.uniqueID+"_"+f;break}}}return"entity" in c?c:g.nodes},getUniqueID:function(){return parseInt(Math.random()*10000).toString()+(new Date).getTime().toString()},setContent:function(a){var b=this.getProperty();if(a){b.nodes.content.innerHTML=a}}};(function(){var m={simple:function(r,o,p,q){return p*r/q+o},backEaseIn:function(p,o,u,r){var q=1.70158;return u*(p/=r)*p*((q+1)*p-q)+o},backEaseOut:function(r,o,z,y,q,v){var u=1.70158;return z*((r=r/y-1)*r*((u+1)*r+u)+1)+o},backEaseInOut:function(r,o,z,y,q,v){var u=1.70158;if((r/=y/2)<1){return z/2*(r*r*(((u*=(1.525))+1)*r-u))+o}return z/2*((r-=2)*r*(((u*=(1.525))+1)*r+u)+2)+o},bounceEaseOut:function(p,o,r,q){if((p/=q)<(1/2.75)){return r*(7.5625*p*p)+o}else{if(p<(2/2.75)){return r*(7.5625*(p-=(1.5/2.75))*p+0.75)+o}else{if(p<(2.5/2.75)){return r*(7.5625*(p-=(2.25/2.75))*p+0.9375)+o}else{return r*(7.5625*(p-=(2.625/2.75))*p+0.984375)+o}}}},bounceEaseIn:function(p,o,r,q){return r-m.bounceEaseOut(q-p,0,r,q)+o},bounceEaseInOut:function(p,o,r,q){if(p<q/2){return m.bounceEaseIn(p*2,0,r,q)*0.5+o}else{return m.bounceEaseOut(p*2-q,0,r,q)*0.5+r*0.5+o}},strongEaseInOut:function(p,o,r,q){return r*(p/=q)*p*p*p*p+o},regularEaseIn:function(p,o,r,q){return r*(p/=q)*p+o},regularEaseOut:function(p,o,r,q){return -r*(p/=q)*(p-2)+o},regularEaseInOut:function(p,o,r,q){if((p/=q/2)<1){return r/2*p*p+o}return -r/2*((--p)*(p-2)-1)+o},strongEaseIn:function(p,o,r,q){return r*(p/=q)*p*p*p*p+o},strongEaseOut:function(p,o,r,q){return r*((p=p/q-1)*p*p*p*p+1)+o},strongEaseInOut:function(p,o,r,q){if((p/=q/2)<1){return r/2*p*p*p*p*p+o}return r/2*((p-=2)*p*p*p*p+2)+o},elasticEaseIn:function(r,o,z,y,q,v){if(r==0){return o}if((r/=y)==1){return o+z}if(!v){v=y*0.3}if(!q||q<Math.abs(z)){q=z;var u=v/4}else{var u=v/(2*Math.PI)*Math.asin(z/q)}return -(q*Math.pow(2,10*(r-=1))*Math.sin((r*y-u)*(2*Math.PI)/v))+o},elasticEaseOut:function(r,o,z,y,q,v){if(r==0){return o}if((r/=y)==1){return o+z}if(!v){v=y*0.3}if(!q||q<Math.abs(z)){q=z;var u=v/4}else{var u=v/(2*Math.PI)*Math.asin(z/q)}return(q*Math.pow(2,-10*r)*Math.sin((r*y-u)*(2*Math.PI)/v)+z+o)},elasticEaseInOut:function(r,o,z,y,q,v){if(r==0){return o}if((r/=y/2)==2){return o+z}if(!v){var v=y*(0.3*1.5)}if(!q||q<Math.abs(z)){var q=z;var u=v/4}else{var u=v/(2*Math.PI)*Math.asin(z/q)}if(r<1){return -0.5*(q*Math.pow(2,10*(r-=1))*Math.sin((r*y-u)*(2*Math.PI)/v))+o}return q*Math.pow(2,-10*(r-=1))*Math.sin((r*y-u)*(2*Math.PI)/v)*0.5+z+o}};var i=function(o){return o.uniqueID};if(!$IE){i=function(p){try{var o;if(p.getAttribute("uniqueID")==null){o="moz__id"+parseInt(Math.random()*100)+"_"+new Date().getTime();p.setAttribute("uniqueID",o);return o}return p.getAttribute("uniqueID")}finally{o=null}}}function k(p){try{var o=p.constructor.toString().toLowerCase();return o.slice(o.indexOf("function")+9,o.indexOf("()"))}finally{o=null}}function j(t,r){var q,p,o=[];p=r.length;for(q=0;q<p;q++){o[o.length]=parseFloat(Core.Dom.getStyle(t,r[q]))}return o}function l(o){return k(o)!="array"?[o]:o}function c(o,v){try{var r=k(o);var y=[],u=[],t,q,p;if(r!="array"){p=g(o);p[1]=v=="opacity"?"":p[1];y=[p[0]];u=[p[1]]}else{q=o.length;for(t=0;t<q;t++){p=g(o[t]);p[1]=v[t]=="opacity"?"":p[1];y[y.length]=p[0];u[u.length]=p[1]}}return[y,u]}finally{r=y=u=t=q=p=null}}function g(p){try{var o=/(-?\d.?\d*)([a-z%]*)/i.exec(p);return[o[1],o[2]?o[2]:"px"]}finally{o=null}}var a={};var f={};function b(q){try{var p=i(q);var o;if(a[p]!=true){o=new d();f[p]={node:q,func:o};a[p]=true;return o}else{return f[p].func}}finally{p=o=null}}function d(){this._timer=null}d.prototype.start=function(y,v,r,u,t,z){this.reset();z=z||{};if(z.before){this._func.before=z.before}if(z.end){this._func.end=z.end}if(z.tween){this._func.tween=z.tween}var p=l(v);var o=j(y,p);var q=c(r,p);this._node=y;this._property=p;this._endingvalue=q[0];this._suffixvalue=q[1];this._startvalue=o;this._end=false;this._fps=0;if(u!=null){this._seconds=u}if(m[t]!=null){this._animation=m[t]}this._starttime=new Date().getTime();this._func.before();this._timer=setInterval(Core.Function.bind3(this.play,this),10)};d.prototype.play=function(){var r=(new Date().getTime()-this._starttime)/1000;var q,p,o=this._property.length;if(r>this._seconds){r=this._seconds}for(q=0;q<o;q++){p=this._animation(r,this._startvalue[q],this._endingvalue[q]-this._startvalue[q],this._seconds);Core.Dom.setStyle(this._node,this._property[q],p+this._suffixvalue[q])}this._fps++;this._func.tween();if(r==this._seconds){this.stop()}};d.prototype.stop=function(){clearInterval(this._timer);this._end=true;this._func.end()};d.prototype.reset=function(){clearInterval(this._timer);this._end=false;this._node=null;this._property=[];this._startvalue=[];this._endingvalue=[];this._suffixvalue=[];this._fps=0;this._seconds=0.5;this._animation=m.simple;this._func={end:function(){},tween:function(){},before:function(){}}};function n(u,v,p,t,q,r){var o=b(u);o.start.apply(o,arguments)}n.stop=function(o){b(o).stop()};n.isTween=function(o){return !b(o)._end};Ui.tween=n})();var DialogDisplaySet={alpha1:{show:function(g,i,d){var c=0,b=0,a=parseInt(g.style.top)-i;g.style.top=a;Core.Dom.setStyle(g,"opacity",c);g.style.display="";var f=window.setInterval(function(){if(c<=1){Core.Dom.setStyle(g,"opacity",c)}if(b<=a+i){g.style.top=a+b+"px"}b+=1.5;c+=0.05;if(c>0.9&&parseInt(g.style.top)>=a+i){window.clearInterval(f);if(d){d()}}},10)},hidden:function(i,j,f){var c=1;var a=parseInt(i.style.top);var d=a-j;var b=a;var g=window.setInterval(function(){if(c>=0){Core.Dom.setStyle(i,"opacity",c)}if(b>=d){i.style.top=b+"px"}b-=1.5;c-=0.05;if(c<=0&&b<d){window.clearInterval(g);if(f){f()}}},10)}},alpha:{show:function(c,d,b){Core.Dom.setStyle(c,"opacity",0.3);c.style.display="";c.style.top=parseInt(c.style.top)-d+"px";var a=parseInt(c.style.top)+d;Ui.tween(c,["top","opacity"],[a,0.9],0.4,"simple",{end:b})},hidden:function(c,d,b){var a=parseInt(c.style.top)-d;Ui.tween(c,["top","opacity"],[a,0],0.2,"simple",{end:b})}},fallDown:{show:function(d,b,a,c){d.style.display="";d.style.top=b+"px";Ui.tween(d,"top",a,0.6,"bounceEaseOut",{end:c})},hidden:function(d,b,a,c){d.style.display="";d.style.top=b+"px";Ui.tween(d,"top",a,0.6,"strongEaseIn",{end:c})}}};var Drag3=function(b,c,f){var d=this;this.beDragObj=b;this.movedObjs=c||this.beDragObj;this.dragMode=f||"normal";this.canDrag=true;this.isLock=false;this.lockArea={left:0,right:0,top:0,bottom:0};this.dragSet={normal:function(){d.normalDrag()},border:function(){d.borderDrag()},opacity:function(){d.opacityDrag()}};this.dragObjsFunc=function(){d.onDrag();d.dragObjs()};(function a(){d.beDragObj.style.MozUserSelect="none";Core.Events.addEvent(d.beDragObj,function(){return false},"selectstart");Core.Events.addEvent(d.beDragObj,function(){return false},"drag");for(var g=0;g<d.movedObjs.length;g++){if(d.movedObjs[g]!=d.beDragObj){d.movedObjs[g].style.position="absolute";if(!d.movedObjs[g].style.left){d.movedObjs[g].style.left=d.movedObjs[g].offsetLeft+"px"}if(!d.movedObjs[g].style.top){d.movedObjs[g].style.top=d.movedObjs[g].offsetTop+"px"}}}Core.Events.addEvent(d.beDragObj,d.dragSet[d.dragMode],"mousedown");if($IE){Core.Events.addEvent(d.beDragObj,function(){Core.Events.removeEvent(d.beDragObj,d.dragObjsFunc,"mousemove");d.beDragObj.releaseCapture();d.onDragEnd()},"mouseup")}else{Core.Events.addEvent(document,function(){Core.Events.removeEvent(document,d.dragObjsFunc,"mousemove");d.onDragEnd()},"mouseup")}})()};Drag3.prototype={capture:function(){this.canDrag=true},release:function(){this.canDrag=false},onDragStart:function(){},onDrag:function(){},onDragEnd:function(){},dragObjs:function(){e=Core.Events.getEvent();for(var a=0;a<this.movedObjs.length;a++){if(this.isLock){if(e.clientX-this.movedObjs[a].deltaX<this.lockArea.left){this.movedObjs[a].style.left=this.lockArea.left+"px"}else{if(e.clientX-this.movedObjs[a].deltaX>this.lockArea.right-this.movedObjs[a].offsetWidth){this.movedObjs[a].style.left=this.lockArea.right-this.movedObjs[a].offsetWidth+"px"}else{this.movedObjs[a].style.left=e.clientX-this.movedObjs[a].deltaX+"px"}}if(e.clientY-this.movedObjs[a].deltaY<this.lockArea.top){this.movedObjs[a].style.top=this.lockArea.top+"px"}else{if(e.clientY-this.movedObjs[a].deltaY>this.lockArea.bottom-this.movedObjs[a].offsetHeight){this.movedObjs[a].style.top=this.lockArea.bottom-this.movedObjs[a].offsetHeight+"px"}else{this.movedObjs[a].style.top=e.clientY-this.movedObjs[a].deltaY+"px"}}}else{this.movedObjs[a].style.left=e.clientX-this.movedObjs[a].deltaX+"px";this.movedObjs[a].style.top=e.clientY-this.movedObjs[a].deltaY+"px"}}},normalDrag:function(){var b=this;e=Core.Events.getEvent();for(var a=0;a<b.movedObjs.length;a++){b.movedObjs[a].deltaX=e.clientX-parseInt(b.movedObjs[a].style.left);b.movedObjs[a].deltaY=e.clientY-parseInt(b.movedObjs[a].style.top)}if(b.canDrag){if($IE){b.beDragObj.setCapture();Core.Events.addEvent(b.beDragObj,b.dragObjsFunc,"mousemove")}else{Core.Events.addEvent(document,b.dragObjsFunc,"mousemove")}}b.onDragStart()},borderDrag:function(b,a){},opacityDrag:function(b,a){}};Ui.Drag3=Drag3;var Dialog=function(b){var d=this;d.entity=null;d.ifm=null;var c={id:"",x:0,y:0,width:0,height:0,isFixed:false,layer:new Layer(b),template:b,canDrag:false,dragEntity:null,name:"",uniqueID:"",isShow:false,nodes:{},focusNode:null,displayMode:"normal",_modeDisplayRuning:false,enabled:true};this.getProperty=function(){return c};(function a(){var g=d.getProperty();var f;g.uniqueID=g.layer.getProperty().uniqueID;g.id=g.uniqueID+"_dialog";g.nodes=d.getNodes();d.entity=g.layer.entity;d.ifm=g.layer.ifm;g.width=parseInt(d.entity.style.width);if(g.nodes.titleBar){g.dragEntity=new Ui.Drag3(g.nodes.titleBar,d.ifm?[d.ifm,d.entity]:[d.entity]);g.nodes.titleBar.style.cursor="move";Core.Events.addEvent(g.nodes.titleBar,function(){return false},"selectstart");g.dragEntity.onDrag=function(){d.onDrag()}}Core.Events.addEvent(window,function(){if(g.isShow&&g.isFixed){var k=Core.System.winSize();var j=k.width/2-d.getWidth()/2;var i=k.height/2-d.getHeight()/2;j=j<0?0:j;i=i<0?0:i;d.setPosition({x:j,y:i})}},"resize")})()};Dialog.prototype={setPosition:function(a){var b=this.getProperty();Core.System.parseParam(b,a);this.getProperty().layer.setPosition(a)},setSize:function(a){var b=this.getProperty();Core.System.parseParam(b,a);b.layer.setSize(a)},setFixed:function(b){var a=this.getProperty();a.isFixed=b;this.getProperty().layer.setFixed(a.isFixed)},setContent:function(a){var b=this.getProperty();this.getProperty().layer.setContent(a)},setTemplate:function(a){var b=this.getProperty();b.template=a;b.layer.setTemplate(b.template)},setDrag:function(a){var b=this.getProperty();b.canDrag=a;if(b.canDrag){b.dragEntity.capture()}else{b.dragEntity.release()}},getWidth:function(){return this.getProperty().layer.getWidth()},getHeight:function(){return this.getProperty().layer.getHeight()},getX:function(){return this.getProperty().layer.getX()},getY:function(){return this.getProperty().layer.getY()},show:function(b){var a=this.getProperty();var c=this;a.isShow=true;if(this.ifm){this.ifm.style.display=""}this.onShow();if(a.displayMode=="normal"||b=="normal"){this.entity.style.display=""}else{a._modeDisplayRuning=true;a.enabled=false;this._showWithMode(function(){a._modeDisplayRuning=false;a.enabled=true;if(c.onDisplaied){c.onDisplaied()}})}},close:function(b){var c=this;var a=this.getProperty();if(a.displayMode=="normal"||b=="normal"){a.isShow=false;a.layer.hidden();this.destroy();this.onClose();if(c.onDisplayFinished){c.onDisplayFinished()}}else{if(!a._modeDisplayRuning){a._modeDisplayRuning=true;a.enabled=false;this._hiddenWithMode(function(){a.isShow=false;a.layer.hidden();a._modeDisplayRuning=false;a.enabled=true;c.destroy();c.onClose();if(c.onDisplayFinished){c.onDisplayFinished()}})}}},hidden:function(b){var c=this;var a=this.getProperty();if(a.displayMode=="normal"||b=="normal"){a.isShow=false;a.layer.hidden();this.onHidden();if(c.onDisplayFinished){c.onDisplayFinished()}}else{if(!a._modeDisplayRuning){a._modeDisplayRuning=true;a.enabled=false;this._hiddenWithMode(function(){a.isShow=false;a.layer.hidden();c.onHidden();a._modeDisplayRuning=false;a.enabled=true;if(c.onDisplayFinished){c.onDisplayFinished()}})}}},_showWithMode:function(a){var c=this.getProperty();var b=Core.System.winSize();var d=this;switch(c.displayMode){case"alpha":DialogDisplaySet.alpha.show(this.entity,20,a);break}},_hiddenWithMode:function(a){var c=this.getProperty();var d=this;var b=Core.System.winSize();switch(c.displayMode){case"alpha":DialogDisplaySet.alpha.hidden(this.entity,20,a);break}},destroy:function(){try{if(this.getProperty().nodes.iframe){this.getProperty().nodes.iframe.src=""}}catch(a){}this.entity&&this.entity.parentNode.removeChild(this.entity);this.entity=null;if(this.ifm){this.ifm.parentNode.removeChild(this.ifm);this.ifm=null}},onShow:function(){},onClose:function(){},onHidden:function(){},onDrag:function(){},onDisplaied:function(){},onDisplayFinished:function(){},setAreaLocked:function(a){var b=this.getProperty();b.dragEntity.isLock=a;var c=this;if(a){c._updateLockArea();Core.Events.addEvent(window,function(){c._updateLockArea()},"resize")}},_updateLockArea:function(){var b=this.getProperty();var a=Core.System.winSize();if(b.isFixed){if($IE6){b.dragEntity.lockArea={left:document.documentElement.scrollLeft,right:document.documentElement.scrollLeft+a.width,top:document.documentElement.scrollTop,bottom:document.documentElement.scrollTop+a.height};Core.Events.addEvent(window,function(){b.dragEntity.lockArea={left:document.documentElement.scrollLeft,right:document.documentElement.scrollLeft+a.width,top:document.documentElement.scrollTop,bottom:document.documentElement.scrollTop+a.height}},"scroll");Core.Events.addEvent(window,function(){b.dragEntity.lockArea={left:document.documentElement.scrollLeft,right:document.documentElement.scrollLeft+a.width,top:document.documentElement.scrollTop,bottom:document.documentElement.scrollTop+a.height}},"resize")}else{b.dragEntity.lockArea={left:0,right:a.width,top:0,bottom:a.height}}}else{b.dragEntity.lockArea={left:0,right:document.documentElement.scrollWidth,top:0,bottom:document.documentElement.scrollHeight}}},updateFixed:function(){this.getProperty().layer.updateFixed()},getNodes:function(a){return this.getProperty().layer.getNodes(a)},setFocus:function(){var b=this.getProperty();if(b.focusNode&&b.focusNode.style.display!="none"){try{b.focusNode.focus()}catch(a){}}else{if(this.entity.style.display!="none"){this.entity.focus()}}},getUniqueID:function(){return this.getProperty().layer.getUniqueID()}};var $SYSMSG={};$SYSMSG.extend=function(c,b){for(var a in c){$SYSMSG[a]=!!b==false?c[a]:$SYSMSG[a]}};$SYSMSG.extend({A00001:"系统繁忙，请稍候再试。",A00007:"未登录。",A00004:"系统繁忙，请稍候再试。",A00112:"博客名称超长。",A00113:"您已开通博客，请点击<a href='http://control.blog.sina.com.cn/blogprofile/index.php'>个人中心</a>进入。",A00116:"不能包含 sina 等有特殊含义的字符。",A11003:"此账户已完成博客快速设置，点击确定，直接进入博客。",A44001:"博客个性地址不能为空。",A44002:"地址格式不对。",A44003:"抱歉，此地址已被占用。",A44005:"抱歉，请按照正确格式填写博客地址。"});(function(){if(scope.blogOpener){scope.addBlogOpenerEvent=function(){};return}var l="http://control.blog.sina.com.cn/riaapi/reg/open_blog.php";var c=function(){this._hasInit=false};c.prototype={getCon:function(){return['<div class="CP_layercon8"><div class="nowOpenBlog"><strong>您的博客尚未开通,仅一步操作就能开通您的个人博客</strong><div class="boxA"><label>博客名称：</label><input id="blogNameInput_t" type="text" class="ipt" /><img style="display:none" id="blogNameIcon_t" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" class="SG_icon SG_icon49 tips"><p id="blogNameError_t" class="tip">名称不能为空</p></div><div  class="boxA"> <p>隐私设置：<input type="radio" name="isPrivate_t" checked id="openAll1_t" class="rd" /><label for="openAll1_t">对所有人开放</label><input type="radio" name="isPrivate_t" id="openMe1_t" class="rd" /><label for="openMe1_t">仅对自己开放，私密博客</label></p></div><div id="ErrTips_t" class="ErrTips">系统繁忙，请稍后再试</div><div class="boxB"><p><a id="openBlogOkBtn_t" class="btn" href="javascript:void(0)">完成开通</a><a id="openBlogCancel" href="javascript:void(0)">取消</a></p></div></div></div>'].join("")},_initDialog:function(){Lib.checkAuthor();this.key=m();this._dialog=winDialog.createCustomsDialog({content:this.getCon()},"openblog");this.bindEvent();k($E("blogNameInput_t"),$E("blogNameError_t"),[],$E("blogNameIcon_t"))},showDialog:function(u,n,p){n=n||false;if(!this._hasInit){this._initDialog();this._hasInit=true}var r=this;scope.whenOpenBlogCallback=u;if(!scope.hasOpenBlog){trace("这是一位后登陆的用户");var o=0;var q=setInterval(function(){trace("呀，怎么还没有出结果啊--"+o);if(scope.hasOpenBlog){clearInterval(q);if(scope.hasOpenBlog=="open"){trace("并且他开通的博客");if(scope.whenOpenBlogCallback){scope.whenOpenBlogCallback()}}else{trace("他们没有开通博客");r._showDialog(n)}}o++;if(o==10){Lib.checkAuthor();trace("等不及了，自己发吧。。。");clearInterval(q);(new Interface("http://control.blog.sina.com.cn/riaapi/profile/unread.php","jsload")).request({GET:{uid:$UID,product:"blog"},onSuccess:function(t){scope.hasOpenBlog=t.isbloguser==1?"open":"no";trace("~~~~~~~~~~~~~~~~~~~"+scope.hasOpenBlog);if(scope.hasOpenBlog=="open"){trace("并且他开通的博客");if(scope.whenOpenBlogCallback){scope.whenOpenBlogCallback()}}else{if(!$E("openblogcss")){Utils.Io.loadCss({id:"openblogcss",url:$_GLOBAL.cssBasicURL+"module/layer/re_nowopen.css"})}trace("他们没有开通博客");r._showDialog(n)}}})}},10)}else{trace("这是已登陆的用户");if(scope.hasOpenBlog=="open"){trace("并且他开通的博客");if(scope.whenOpenBlogCallback){scope.whenOpenBlogCallback()}}else{if(!$E("openblogcss")){Utils.Io.loadCss({id:"openblogcss",url:$_GLOBAL.cssBasicURL+"module/layer/re_nowopen.css"})}trace("他们没有开通博客");this._showDialog(n)}}if(p){$E("openBlogCancel").style.display="none";this._dialog.getNodes().btnClose.style.display="none"}},_showDialog:function(n){$E("blogNameInput_t").value=i();b($E("blogNameError_t"),$E("blogNameIcon_t"));$E("ErrTips_t").style.visibility="hidden";$E("blogNameIcon_t").style.display="none";this._dialog.show();this._dialog.setAreaLocked(true);this._dialog.setMiddle()},bindEvent:function(){var n=this;Core.Events.addEvent($E("openBlogCancel"),function(){n.closeDialog();return false});Core.Events.addEvent($E("openBlogOkBtn_t"),function(){f({nameErrorEle:$E("blogNameError_t"),nameOkIcon:$E("blogNameIcon_t"),openName:($E("blogNameInput_t").value||i()),isprivate:$E("openAll1_t").checked?0:1,errorEle:$E("ErrTips_t"),from:"floatingLayer",okCallback:function(p,o){if(scope.whenOpenBlogCallback){scope.whenOpenBlogCallback(p,o)}if($E("openedBlogTray")&&$E("openedBlogTray").style.display=="none"){$E("outOfOpenBlogTray").style.display="none";$E("noOpenedBlogTray").style.display="none";$E("openedBlogTray").style.display=""}if($E("noOpendBlogSearchTip")&&$E("noOpendBlogSearchTip").style.display=="block"){$E("noOpendBlogSearchTip").style.display="none";$E("opendBlogSearchTip").style.display="block"}scope.hasOpenBlog="open";n.closeDialog();scope.whenOpenBlogCallback=function(){}}});return false})},closeDialog:function(){var n=this;this._dialog.hidden()}};function i(){var o=$nick;var n=Core.String.byteLength(o);while(n>18){o=o.substring(0,o.length-1);n=Core.String.byteLength(o)}return o+"的博客"}scope.openBlogGetShotName=i;function k(o,p,n,q){o.onfocus=function(){o.className="ipt focus";a(n,"");q.style.display=""};o.onblur=function(){o.className="ipt";j(o,p,q);a(n,"none")};o.onkeyup=function(){j(o,p,q)}}scope.openBlogNameEvent=k;function f(p){if(f.requestComplete===false){return}if(p.nameErrorEle.innerHTML){g(p.nameErrorEle.parentNode);setTimeout(function(){g(p.nameErrorEle.parentNode)},442);return}f.requestComplete=false;var n=p.from==="floatingLayer"?"openBlogOkBtn_t":"openBlogOkBtn";$E(n).className="loading";var o={loginName:m(),blogName:p.openName};new Interface(l,"jsload").request({GET:{uid:$UID,loginname:o.loginName,blogname:o.blogName,version:7,src:"layer",isprivate:p.isprivate},onSuccess:function(q){f.requestComplete=true;$E(n).className="btn";p.okCallback(q,o);o=null},onError:function(t){var v=$E("blogNameError"),u=$E("blogNameIcon"),q=$E("blogNameError_t"),r=$E("blogNameIcon_t");switch(t.code){case"A11008":if(v&&u){d(v,"输入内容有误，请修改",u)}if(q&&r){d(q,"输入内容有误，请修改",r)}break;case"A11010":if(v&&u){d(v,"输入内容有误，请修改",u)}if(q&&r){d(q,"输入内容有误，请修改",r)}break;default:d(p.errorEle,"系统繁忙，请稍后再试。");break}f.requestComplete=true;$E(n).className="btn"}})}scope.openBlogWhenOpenBlog=f;function g(o){for(var n=1;n<=55;n++){(function(p){setTimeout(function(){o.style.backgroundColor="rgb(255, "+ +(200+p)+", "+(200+p)+")"},p*8)})(n)}}function m(){var n=decodeURIComponent(Utils.Cookie.getCookie("SUP"));n=n.split("&name=")[1];n=decodeURIComponent(n.split("&")[0]);return n}function a(n,p){for(var o=0;n[o];o++){n[o].style.display=p}}function j(o,p,q){var r=o.value;if(/^(?:\s|[　])+|(?:\s|[　])+$/.test(r)){o.value=Core.String.trim(r);r=o.value}if(r){var n=Core.String.byteLength(r);if(n>24){d(p,"博客名称超长",q)}else{b(p,q)}}else{d(p,"博客名称不能为空",q)}}function d(o,p,n){o.innerHTML=p;o.style.display="block";if(o.id.indexOf("ErrTips")>=0){o.style.visibility="visible"}if(n){n.className="SG_icon SG_icon48 tips"}}function b(o,n){o.innerHTML="";o.style.display="none";if(n){n.className="SG_icon SG_icon49 tips"}}scope.blogOpener=new c();scope.addBlogOpenerEvent=function(n){Core.Events.addEvent(n,function(o){scope.blogOpener.showDialog(function(u,q){Lib.LocalDB.clearCache(1,"uid_"+$UID+"unread");Lib.util.LS.removeItem("uid"+$UID);if(scope.$pageid=="fakeIndex"){window.location.href="http://i.blog.sina.com.cn/blogprofile/index.php?atten=1";return}if($E("openedBlogTray")){$E("openedBlogTray").style.display="";$E("noOpenedBlogTray").style.display="none";$E("outOfOpenBlogTray").style.display="none";if(q){$E("loginBarAppMenuLabel").innerHTML=q.loginNick}}else{var v=window;v.$tray&&v.$tray.renderLogin()}var r=function(){if(scope.___importV){scope.___importV();scope.___openBlogFlag=1}};var t={subText:!scope.___importV?['<div class="CP_w_cnt SG_txtb">欢迎您在新浪博客安家！除了写博客，看博客外，您还可以进入个人中心完善您的个人资料，更有很多有趣的应用等着您哦。</div>','<ul class="CP_w_part CP_w_aLine">','<li><a href="http://control.blog.sina.com.cn/blogprofile/index.php" onclick="winDialog.getDialog(\'unregister\').hidden();" target="_blank">到博客个人中心&gt;&gt;</a></li>',"</ul>"].join(""):"",icon:"03",funcOk:r,funcClose:r,width:300};winDialog.alert("开通博客成功",t,"unregister");var p=$E("commentNick");if(p){var y=p.firstChild;while(y){p.removeChild(y);y=p.firstChild}p.innerHTML=q.loginNick+":"}},true)},"click")}})();Lib.register("TrayPanel",function(n){var c=Core.Events.addEvent;var k=Core.Events.removeEvent;var m=Utils.Cookie.getCookie;var d=Core.Dom.contains;var o=n.util.JSON;var g=Core.Dom.getChildrenByClass;var q="login_bar_logo_link_350";var a="______noticeTrayHolder";var b=0;var i=null;var l=!1;var p=0;var j=function(u,r,t){if(typeof t!=="string"){return u.getAttribute(r)}else{u.setAttribute(r,t)}};var f=Core.Class.define(function(){var t=g(document.body,"nsinatopbar")[0];var r=this.$main=g(t,"ntopbar_main")[0];n.Panel.prototype.initialize.call(this,{appendTo:r,isPostion:!1,noIframe:!0});n.Listener.on({name:"tray-data-loaded",callBack:this.showPublishWare,scope:this},{name:"tray-newmsg-loaded",callBack:this.showNewMsgTips,scope:this},{name:"global-login-out",callBack:function(){clearInterval(this._msgTimer)},scope:this},{name:"tray-announce-loaed",callBack:function(v){var u=arguments;var y=this;if(this.notice){this.notice.update(v);return}setTimeout(function(){u.callee.call(y,v)},200)},scope:this},{name:"tray-unread-panel-hide",callBack:function(){var v=this.getNode("trayMsg");var u=o.parse(v.getAttribute("msg-count"));this.showNewMsgTips(u,1)},scope:this},{name:"tray-unread-panel-show",callBack:function(){var u=this.getNode("newTips");u.style.display="none"},scope:this},{name:"tray-msg-panel-hide",callBack:function(){var v=this.getNode("trayMsg");var u=o.parse(v.getAttribute("msg-count"));this.showNewMsgTips(u,1)},scope:this},{name:"tray-announce-close",callBack:function(u){this.setTrayPosition()},scope:this},{name:"topad680-show-start",callBack:function(u){this._hideActiveSub()},scope:this});if(b){b++}},n.Panel,{subPanels:[],hoverTimeout:"",hoverTime:400,load:function(r){if(!b){var t=$E(q);if(t&&$_GLOBAL&&$_GLOBAL.platformTrayLogo){if(!$IE6&&$_GLOBAL.platformTrayLogo.imgForOtherBrs){t.children[0].src=$_GLOBAL.platformTrayLogo.imgForOtherBrs}else{if($_GLOBAL.platformTrayLogo.imgForIE6){t.children[0].src=$_GLOBAL.platformTrayLogo.imgForIE6}}}this.initSearch()}switch(r){case"login":if(/ipad/i.test(navigator.userAgent)){v7sendLog("48_01_02")}var u=new Date;var v=this;n.tray.loadUserInfo($UID,function(E){scope.unreadMsg=E;scope.nickname=E.full_nickname;scope.loginUserWtype=E.login_wtype;if(!v._isRenderUser){v.renderRight(n.tray.tpl.loginMemu);v._isRenderUser=!0}var B,F,z;if(E.isbloguser){var D=v.getNode("noOpenBlog");D.style.display="none";v.initUserMenu();v.initBlogMenu(E);v.initNewMsgEvt();v.initMsg();v.initMsgLoder();v.initHideSub();v.initunReadMsgPanel();B=v.getNode("userNick");F=v.getNode("openBlog")}else{B=v.getNode("ssoNick");B.href="http://control.blog.sina.com.cn/myblog/htmlsource/blog_notopen.php?uid="+$UID+"&version=7";v.initOpenBlog();v.initLogout();F=v.getNode("noOpenBlog")}B.innerHTML="";var y=document.createTextNode(E.nickname);B.appendChild(y);F.style.display="block";var A=Utils.Cookie.getCookie("loginFromMsn");if(A&&B){z=v.getNode("msnHolder");z.style.display="block";var C=v.getNode("msnLink");C.href+=$UID}if(z){Core.Dom.insertAfter(z,B.parentNode)}v.initNotice()});break;case"logout":if(!this.trayLogin){this.trayLogin=new n.Login.Ui();this.renderRight(n.tray.tpl.loginOutMemu)}this.initLogin();this.initNotice();break;case"oncelogedon":break}b++},initMsgLoder:function(){if(!this.msgLoader){this.msgLoader=new n.tray.MsgLoader();this.msgLoader.load($UID);var r=this;this._msgTimer=setInterval(function(){r.msgLoader.load($UID)},30*1000)}},initLogin:function(){var r=this;var t=j(this._el,"login");if(!t){j(this._el,"login","1");c(this._el,function(u){var v=n.util.getActionData(u,"tray-login-btn");if(!v){return}if(typeof sinaSSOController!="undefined"){sinaSSOController.loginExtraQuery={}}r.trayLogin.login(function(){Lib.checkAuthor();var y=$UID==scope.$uid?"02":"01";v7sendLog("87_01_"+y+"_"+$UID,scope.$pageid);setTimeout(function(){window.location=window.location.toString().replace(/#.*/,"")},100)},false,"referer:"+location.hostname+location.pathname+",func:0007")},"click")}},initLogout:function(){var r=this.getNode("ssoLoginOut");var t=j(r,"loginout");if(!t){j(this._el,"login","1");c(r,function(){n.tray.loginOut(null,!0)})}r=null},initHideSub:function(){var r=this;c(document.body,function(t){if(!r._activeTab){return}var z=t.target||t.srcElement;var u=r.subPanels;var y;for(var v=u.length-1;v>=0;v--){y=u[v];if(y.tab===z||d(y.tab,z)){return}if(y.panel.entity===z||d(y.panel.entity,z)){return}}r._hideActiveSub()},"click");c(window,function(){var u=r._activeTab;if(!u){return}var A=u.tab;var v=u.panel;var B=u.left;var z=u.top;var t=Core.Dom.getLeft(A)+A.offsetWidth+B;var C=Core.Dom.getTop(A)+A.offsetHeight+z;if($IE6&&this.isFixed){t=t-document.documentElement.scrollLeft;C=C-document.documentElement.scrollTop}v.setPosition(t,C)},"resize")},_hideActiveSub:function(){var t=this;if(t._activeTab){var u=t._activeTab.tab;var r=t._activeTab.panel;t._activeTab=null;r.hidden();u.className=u.className.replace(/(?:[ ]*)\bcurrent\b/g,"")}},initUserMenu:function(){var u=this.getNode("userMenu");var B=j(u,"init");if(!B){j(u,"init","1");var z=this;var r;var y=z.getNode("userMenu");var v=z._findSub("userMenu");var t=0;Lib.util.hoverJq({elm:u,mouseenter:function(G,F,E){clearTimeout(z.hoverTimeout);if(!t){t=1;var C;if(!v){C=new n.tray.UserMenuPanel();z.addSubPanel("userMenu",C,u,y)}else{C=v.panel}var D=C.getNode("panel");C.initUserInfo($UID);Lib.util.hoverJq({elm:D,mouseenter:function(J,I,H){clearTimeout(z.hoverTimeout);z._showPanel("userMenu",-160,0)},mouseleave:function(J,I,H){z.hoverTimeout=setTimeout(function(){z._hideActiveSub()},z.hoverTime)}});A(function(H){if(H){C.getNode("mail").style.display=""}})}z._showPanel("userMenu",-160,0)},mouseleave:function(E,D,C){z.hoverTimeout=setTimeout(function(){z._hideActiveSub()},z.hoverTime)}});var A=function(C){if(typeof r==="boolean"){C(r)}else{Utils.Io.JsLoad.request("http://service.mail.sina.com.cn/mailproxy/mail.php",{onComplete:function(){var D=sinamailinfo.email;if(D!=""){r=!0}else{r=!1}C(r)},onException:function(){}})}}}},initBlogMenu:function(y){var t=this.getNode("addArticle");var z=j(t,"init");if(!z){j(t,"init","1");var v=this;var u=v.getNode("blogMenu");var r=0;Lib.util.hoverJq({elm:u,mouseenter:function(F,E,D){clearTimeout(v.hoverTimeout);if(!r){r=1;var B=v._findSub("blogMenu");var A;if(!B){A=new n.tray.BlogMenuPanel();v.addSubPanel("blogMenu",A,t,u);if(y.tbh_status===1){A.getNode("tbh_status").style.display=""}}var C=A.getNode("panel");Lib.util.hoverJq({elm:C,mouseenter:function(I,H,G){clearTimeout(v.hoverTimeout);v._showPanel("blogMenu",-74,0)},mouseleave:function(I,H,G){v.hoverTimeout=setTimeout(function(){v._hideActiveSub()},v.hoverTime)}})}v._showPanel("blogMenu",-74,0)},mouseleave:function(C,B,A){v.hoverTimeout=setTimeout(function(){v._hideActiveSub()},v.hoverTime)}})}},initNotice:function(){var B=scope.$PRODUCT_NAME;var r=scope.$pageid;if("blog7"!==B){this.noNotice=!0;return}if(-1===r.indexOf("article")&&-1===r.indexOf("index")){this.noNotice=!0;return}var y=m("closeNotice_fzp");var u=$E("sinablogHead");Lib.checkAuthor();if((y&&y===$UID)||!u){this.noNotice=!0;return}if(!this.notice){var A=new n.tray.BlogNotice({appendTo:$E(q).parentNode,isPostion:!1,noIframe:!0});this.notice=A;var v=this;var C=u.offsetHeight+30;var z;var t=function(){var E=document;var D=E.body.scrollTop+E.documentElement.scrollTop;if(D>C){v.hideActive();v.setTrayFixed();if(!z){z=1;v7sendLog("48_01_11_"+scope.$pageid)}}else{setTimeout(function(){v.setTrayPosition();A.hide()})}};c(window,t,"scroll");n.Listener.on({name:"tray-announce-close",callBack:function(){k(window,t,"scroll")}})}},initNewMsgEvt:function(){var r=this.tpl;var u=this.getNode("newTips");var v=j(u,"init");if(!v){j(u,"init","1");var t=this;c(u,function(z){z=z||window.event;var y=z.target||z.srcElement;Core.Events.stopEvent(z);y.style.display="none";y.innerHTML="";var A=t.getNode("trayMsg");Core.Events.fireEvent(A,"click")},"click");u=null}},initMsg:function(){var t=this.getNode("trayMsg");var v=j(t,"init");if(!v){j(t,"init","1");var u=this;var r=0;Lib.util.hoverJq({elm:t,mouseenter:function(F,D,C){clearTimeout(u.hoverTimeout);if(!r){r=1;var E=window.event||F;if(E.preventDefault){E.preventDefault()}else{E.returnValue=false}var A=u.getNode("trayMsg");var B=u._findSub("msgPanel");var z;if(!B){z=new Lib.tray.msgSummaryPanel(A);u.addSubPanel("msgPanel",z,A,A)}var y=z.getNode("panel");Lib.util.hoverJq({elm:y,mouseenter:function(I,H,G){clearTimeout(u.hoverTimeout);u._showPanel("msgPanel",-260,0)},mouseleave:function(I,H,G){u.hoverTimeout=setTimeout(function(){u._hideActiveSub()},u.hoverTime)}})}u._showPanel("msgPanel",-260,0)},mouseleave:function(A,z,y){u.hoverTimeout=setTimeout(function(){u._hideActiveSub()},u.hoverTime)}})}},initunReadMsgPanel:function(){var r=this.getNode("trayMsg");var t=j(r,"init-unre");if(!t){j(r,"init-unre","1");new n.tray.unReadMsgPanel(r)}},initSearch:function(){if(!b){var r=new n.tray.SearchFormPanel({isPostion:!1,appendTo:"traySearchBar",noIframe:!0});r.show();c(document.body,function(t){t=t||window.event;var v=t.target||t.srcElement;var u=r.getNode("queryTxt");if(u!==v&&r.entity!==v&&!d(v,r.entity)){r.catePanel.hide()}},"click")}},initOpenBlog:function(){var t=$E("openblogcss");if(!t){Utils.Io.loadCss({id:"openblogcss",url:$_GLOBAL.cssBasicURL+"module/layer/re_nowopen.css"});var r=this.getNode("openBlogBtn");scope.addBlogOpenerEvent(r)}},notifyMsgPanel:function(t){var r=t.getAttribute("msg-count");if(r){try{r=o.parse(r)}catch(u){r={}}}else{r=-1}},renderRight:function(r){this.setTemplate(r);this._el=this.entity;var t=g(this.$main,"ntopbar_loading")[0];t.style.display="none";this.show()},addSubPanel:function(t,r,y,v){var u=this;this.subPanels.push({name:t,tab:v,bind:y,panel:r})},_showPanel:function(t,z,v){var y=this._findSub(t);if(!y){return}var r=y.panel;var u=y.tab;r.entity.style.zIndex=512;if("msgPanel"===t){var D=this.getNode("newTips");this.notifyMsgPanel(u);D.style.display="none"}var A,F,C;F=this._activeTab;if(F){C=F.tab;if(C===u){return}F.panel.hide();C.className=C.className.replace(/(?:[ ]*)\bcurrent\b/g,"")}var B=u.className;if(!/\bcurrent\b/.test(B)){u.className+=" current"}this._activeTab={name:t,tab:u,panel:r,left:z,top:v};var E=r.entity;if(this.isFixed&&(!$IE||$IE>6)){E.style.position="fixed"}else{E.style.position="absolute"}r.showWithDom(u,z,v)},_findSub:function(r){var u;for(var t=this.subPanels.length-1;t>=0;t--){u=this.subPanels[t];if(r===u.name){return u}}return null},showNewMsgTips:function(A,r){var v=A.sum-A.feed;var z=this.getNode("newTips");var B=this.getNode("trayMsg");if(v){if(B.getAttribute("unread-show-state")==0&&B.getAttribute("msg-panel-show-state")==0){z.style.display="block"}if(scope.$pageid=="editor"){z.style.display="block"}var u=this.entity.offsetWidth;z.style.left=(u-z.offsetWidth-10)+"px";if(v<10){z.innerHTML=v}else{z.innerHTML="•••"}if(!p){v7sendLog("40_01_49_"+$UID);p=1}B.setAttribute("msg-count",o.stringify(A));this.startTitleTips(v)}else{B.setAttribute("msg-count",o.stringify(A));this.stopTitleTips()}var y=A.feed;if(y){var t=this.getNode("newFeed");t.style.display="block";var u=this.entity.offsetWidth;t.style.left=(u-t.offsetWidth-197)+"px";y=(y<10)?y:"•••";t.innerHTML=y;if(!t.addEvt){t.addEvt=1;c(t,function(){location.href="http://i.blog.sina.com.cn/blogprofile/index.php?com=1";t.style.display="none";t.innerHTML=""})}}},stopTitleTips:function(){if(scope.$pageid=="editor"){return}var r=document.title.replace(/\(\d+\+*\)/,"");document.title=r},startTitleTips:function(r){if(scope.$pageid=="editor"){return}var t;if(r){r=(r>=100000)?"99999+":r;if(/\(\d+\+*\)/.test(document.title)){t=document.title.replace(/\(\d+\+*\)/,"("+r+")")}else{t="("+r+")"+document.title}}document.title=t},hideActive:function(){var r,t;if(r=this._activeTab){r.panel.hide();t=r.tab;t.className=t.className.replace(/(?:[ ]*)\bcurrent\b/g,"");this._activeTab=null}},setTrayFixed:function(){var r=$E(q);this.notice.show();var t=this;setTimeout(function(){$E("traySearchBar").parentNode.style.display="none";r.style.display="none";var v=r.parentNode.parentNode;if(!$IE||$IE>6){n.Listener.notify("tray-scrolling-fix",{});v.style.position="fixed";v.style.top="0px"}else{if($IE===6){if(!t.__isFixie6){c(window,function(z){if(!t.isFixed){return}var A=document.documentElement.scrollTop;setTimeout(function(){var B=document.documentElement.scrollTop;if(A===B){v.style.display="block";t._ie6fix(z)}else{if(t.isFixed){v.style.display="none"}}},50)},"scroll");t.__isFixie6=!0}}}v.style.width="100%";if(!$E(a)){var u=v.offsetHeight;var y=$C("div");y.style.height=u+"px";y.id=a;Core.Dom.insertAfter(y,v)}t.isFixed=!0})},_ie6fix:function(u){if(this.isFixed){var v=$E(q);var t=v.parentNode.parentNode;t.style.position="absolute";t.style.top=document.documentElement.scrollTop+"px";var r=this.getNode("trayMsg");if(r){r.style.display="none";r.style.display=""}n.Listener.notify("tray-scrolling-fix",{})}},setTrayPosition:function(){if($IE6){var r=this.getNode("trayMsg");if(r){r.style.display="none";r.style.display=""}}n.Listener.notify("tray-scrolling-nofix",{});var u=$E(q);var t=u.parentNode.parentNode;if($E(a)){t.parentNode.removeChild($E(a))}t.style.position="";var v=$E("traySearchBar");v.style.position="";v.style.top="";this.notice.hide();t.style.display="block";u.style.display="block";$E("traySearchBar").parentNode.style.display="block";this.isFixed=!1}});return function(){if(!i){i=new f()}return i}});Sina.pkg("Utils.Form");Utils.Form.limitMaxLen=function(a,b){var c;var d=function(){c=a.value;var f=Core.String.byteLength(c);if(f>b){a.value=Core.String.leftB(c,b)}};Core.Events.addEvent(a,Core.Function.bind3(d,a),"keyup");Core.Events.addEvent(a,Core.Function.bind3(d,a),"blur");Core.Events.addEvent(a,Core.Function.bind3(d,a),"focus")};Core.System.htmlFilter=function(b){var c={"&":"&#038;","<":"&#060;",">":"&#062;"};var a;for(a in c){b=b.replace(new RegExp(a,"g"),c[a])}return b};Utils.Io.loadExternalCSS=function(a,f){if(typeof a!=="string"){return}var c,d,b=document.getElementsByTagName("head")[0];if($FF){d=$C("style");d.type="text/css";d.innerHTML="@import url("+a+")";b.appendChild(d);(function(){try{d.sheet.cssRules;typeof f==="function"&&f()}catch(g){setTimeout(arguments.callee,50)}})()}else{c=$C("link");c.href=a;c.type="text/css";c.rel="stylesheet";c.media="all";b.appendChild(c);if($SAFARI||$CHROME){(function(){try{c.sheet.cssRules;typeof f==="function"&&f()}catch(g){setTimeout(arguments.callee,50)}})()}else{c.onload=function(){c.onload=null;typeof f==="function"&&f()}}}};Core.Events.click=(function(){var a=/mobile/i.test(navigator.userAgent);if($IE&&$IE<9){return function(b){b.click()}}else{return function(c){var b;if(a){b=document.createEvent("HTMLEvents")}else{b=document.createEvent("MouseEvents")}b.initEvent("click",true,true);c.dispatchEvent(b)}}})();Core.Dom.removeClassName=Core.Dom.removeClass;scope.trayPlusTemplayLogout=['<div class="topbar_menu">','<span class="link"><a target="_blank" href="http://blog.sina.com.cn">博客首页</a></span>','<span class="line_s"></span>',"</div>",'<div class="topbar_login"><a id="linkTrayLogin" class="login" href="javascript:;">登录</a><a id="linkReg" target="_blank" class="register" href="">注册</a></div>','<div id="divPopularize" class="topbar_ad"></div>','<div id="loginBarActivity" class="topbar_activity"></div>'].join("");scope.trayPlusTemplayLogin=['<div class="topbar_menu" id="openedBlogTray">','<span id="loginBarOptApp" class="link"><a id="loginBarAppMenuLabel" href="javascript:;">读取中...</a><a href="javascript:;" class="link_arrow" title=""></a></span>','<span class="line_s"></span>','<span style="display:none;" id="loginBarMail" class="link imfor blog_to_mail"><a target="_blank" href="http://mail.sina.com.cn/?s=2">邮件</a><div id="mailpiaohong" style="display:none;" class="imforbox"></div></span>','<span class="line_s" style="display:none;" id="line"></span>','<span id="loginBarCenter" class="link"><a target="_self" href="http://i.blog.sina.com.cn/blogprofile/index.php?com=1">个人中心</a></span>','<span class="line_s"></span>','<span id="loginBarFriend" class="link"><a target="_blank" href="http://control.blog.sina.com.cn/blogprofile/profilefriendlist.php">好友</a></span>','<span class="line_s"></span>','<span id="loginBarInbox" class="link imfor"><img id="imgNewMessage" style="display:none;" class="topbar_msg" src="http://simg.sinajs.cn/blog7style/images/common/topbar/topbar_msg.gif"/><a href="#" onclick="return false;">消息</a><a href="#" onclick="return false;" class="link_arrow" title=""></a><div id="ccnotepiaohong" style="display:none;" class="imforbox"></div></span>','<span class="line_s"></span>','<span class="link" id="logOut"><a href="#">退出</a></span>',"</div>",'<div style="display:none" class="topbar_menu" id="noOpenedBlogTray">','<span class="link" style="cursor:default;"><a id="noOpenBlogName">读取中...</a></span>','<span class="line_s"></span>','<span class="link"><a href="#">退出</a></span>',"</div>",'<div class="topbar_noopen" style="display:none" id="outOfOpenBlogTray">','<a id="openBlogBtnTray" title="立即开通博客" class="nowopen" href="javascript:void(0)" onclick="return false;"></a>',"</div>",'<div id="loginBarActivity" class="topbar_activity"></div>'].join("");scope.trayPlusTemplayOnceLoged=['<div class="topbar_menu" id="openedBlogTray">','<span id="loginBarOptApp" class="link"><a id="loginBarAppMenuLabel" href="javascript:;">读取中...</a></span>','<span class="line_s"></span>','<span id="loginBarMail" class="link imfor blog_to_mail"><a target="_blank" href="http://mail.sina.com.cn/?s=2">邮件</a><div id="mailpiaohong" style="display:none;" class="imforbox"></div></span>','<span class="line_s" id="line"></span>','<span id="loginBarCenter" class="link"><a target="_self" href="http://i.blog.sina.com.cn/blogprofile/index.php?com=1">个人中心</a></span>','<span class="line_s"></span>','<span id="loginBarFriend" class="link"><a target="_blank" href="http://control.blog.sina.com.cn/blogprofile/profilefriendlist.php">好友</a></span>','<span class="line_s"></span>','<span id="loginBarInbox" class="link imfor"><img id="imgNewMessage" style="display:none;" class="topbar_msg" src="http://simg.sinajs.cn/blog7style/images/common/topbar/topbar_msg.gif"/><a href="#" onclick="return false;">消息</a><div id="ccnotepiaohong" style="display:none;" class="imforbox"></div></span>',"</div>",'<div style="display:none" class="topbar_menu" id="noOpenedBlogTray">','<span class="link" style="cursor:default;"><a id="noOpenBlogName">读取中...</a></span>','<span class="line_s"></span>','<span class="link"><a href="#">退出</a></span>',"</div>",'<div class="topbar_noopen" style="display:none" id="outOfOpenBlogTray">','<a id="openBlogBtnTray" title="立即开通博客" class="nowopen" href="javascript:void(0)" onclick="return false;"></a>',"</div>",'<div id="divPopularize" class="topbar_ad"></div>','<div id="loginBarActivity" class="topbar_activity"></div>'].join("");scope.newStatusTipTemplay=['<div class="tb_layer_arrow"></div>','<div class="tb_layer_Y_main tip_ps" style="width:130px;text-align:left;padding:5px 0 2px 5px;color:#000000">','<a onclick="$E(\'newStatusTip\').style.display=\'none\';return false" href="#" class="tb_friend_inputDel" title="关闭" style="margin-top: 5px;"></a>','<a href="http://i.blog.sina.com.cn/blogprofile/index.php?type=3&from=newstatus&com=2"><span id="nstFeed" style="padding:2px 2px;display:none;">你有<span style="color:red">新动态</span>可查看</span></a>','<a href="http://control.blog.sina.com.cn/blogprofile/profileremind.php?com=2"><span id="nstFavorite" style="padding:3px 2px;display:none;">你有博文被<span style="color:red">转载/收藏</span></span></a>','<img id="gbimg" class="SG_icon SG_icon83" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="17" height="15" align="absmiddle" style="display:none"/><a style="display:none" href="http://i.blog.sina.com.cn/blogprofile/index.php?com=g" id="gbmsg">官博<em>新动态</em></a>',"</div>"].join("");scope.onceLogedStatusTipTemplay=['<div class="tb_layer_arrow"></div>','<div class="tb_layer_Y_main tip_ps" style="width:130px;text-align:left;padding:5px 0 2px 5px;color:#000000">','<a onclick="$E(\'newStatusTip\').style.display=\'none\';return false" href="#" class="tb_friend_inputDel" title="关闭" style="margin-top: 5px;"></a>','<a href="javascript:void(0);return false;"><span id="nstUnread" style="padding:3px 2px;display:none;">你有<span style="color:red">未读消息</span>可查看</span></a>','<a href="javascript:void(0);return false;"><span id="nstFeed" style="padding:2px 2px;display:none;">你有<span style="color:red">新动态</span>可查看</span></a>','<a href="javascript:void(0);return false;"><span id="nstUpdate" style="padding:3px 2px;display:none;">你最近浏览的博主<span style="color:red">有更新</span></span></a>','<a href="javascript:void(0);return false;"><span id="nstUnpub" style="padding:2px 2px;display:none;">你有<span style="color:red">尚未发表</span>的博文</span></a>',"</div>"].join("");scope.nicknamePanelTemplate=['<div id="#{panel}" class="tb_layer_Y tb_layer_w2" style="z-index:512;">','<div class="tb_layer_arrow"></div>','<div class="tb_layer_Y_main">','<div class="tb_ps">','<div class="tb_ps_list">',"<ul>","<li>",'<span class="tb_ps_nm"><a id="#{linkBlog}" href="javascript:;"><img class="SG_icon SG_icon15" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="博客" align="absmiddle" /><strong>博客</strong></a></span>','<span class="tb_ps_set">[<a target="_blank" id="#{linkPostBlog}" href="http://control.blog.sina.com.cn/admin/article/article_add.php">发博文</a>]</span>',"</li>","<li>",'<span class="tb_ps_nm"><a id="#{linkPhoto}" href="javascript:;"><img class="SG_icon SG_icon18" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="相册" align="absmiddle" /><strong>相册</strong></a></span>','<span class="tb_ps_set">[<a target="_blank" id="#{linkPostPhoto}" href="http://photo.blog.sina.com.cn/upload/upload.php">发图片</a>]</span>',"</li>","<li>",'<span class="tb_ps_nm"><a target="_blank" id="#{linkVBlog}" href="javascript:;"><img class="SG_icon SG_icon16" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="播客" align="absmiddle" /><strong>播客</strong></a></span>','<span class="tb_ps_set">[<a target="_blank" id="#{linkUpload}" href="http://vupload.you.video.sina.com.cn/u.php?m=1">发视频</a>][<a id="#{linkRecord}" href="http://vupload.you.video.sina.com.cn/r.php" target="_blank">录视频</a>]</span>',"</li>","<li>",'<span class="tb_ps_nm"><a id="#{miniblog}" href="javascript:;" target="_blank"><img class="SG_icon SG_icon51" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="微博" align="absmiddle" /><strong>微博</strong></a></span>',"</li>","<li>",'<span class="tb_ps_nm"><a id="#{qingblog}" onclick="v7sendLog && v7sendLog(\'79_01_02\',scope.$pageid,\'qingLink\');" href="javascript:;" target="_blank"><img class="SG_icon SG_icon205" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="Qing" align="absmiddle" /><strong>Qing</strong></a></span>',"</li>","<li>",'<span class="tb_ps_nm"><a id="#{mySpace}" href="javascript:;"><img class="SG_icon SG_icon41" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="关于我" align="absmiddle" /><strong>关于我</strong></a></span>',"</li>","</ul>",'<div class="clearit"></div>',"</div>",'<div class="tb_ps_manage">','<p><a target="_blank" id="#{linkChangeFace}" href="javascript:;">修改头像昵称</a></p>','<p><a target="_blank" id="#{linkChangePassword}" href="javascript:;">修改登录密码</a></p>','<p><a target="_blank" id="#{linkAccountSetup}" href="javascript:;">账号安全设置</a></p>','<p><a target="_blank" id="#{bindEmail}" href="javascript:;">绑定邮箱</a></p>',"</div>","</div>","</div>","</div>"].join("");scope.NicknamePanel=Core.Class.define(function(){Lib.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(scope.nicknamePanelTemplate)},Lib.Panel,{initUserInfo:function(c){var a=this.getNodes();scope.$bindEmail=function(j){var i=a.bindEmail;if(j.ret!="y"&&j.errcode!="not_verify"){i.parentNode.removeChild(i)}else{i.href="http://login.sina.com.cn/bindmail/bindmail.php?entry=blog"}};try{var g=/user=([^&]+)&/g.exec(decodeURIComponent(Utils.Cookie.getCookie("SUP")))[1];Utils.Io.JsLoad.request("http://login.sina.com.cn/bindmail/checkmailuser.php?entry=blog&name="+encodeURIComponent(g)+"&utf82bgk=1&callback=scope.$bindEmail",{noreturn:true})}catch(f){}a.linkBlog.href="http://blog.sina.com.cn/u/"+c;a.linkPhoto.href="http://photo.blog.sina.com.cn/u/"+c;a.linkVBlog.href="http://you.video.sina.com.cn/m/"+c;a.miniblog.href="http://control.blog.sina.com.cn/t_sina_blog/tb.php?uname="+c;a.qingblog.href="http://qing.blog.sina.com.cn/fancy.html";a.mySpace.href="http://blog.sina.com.cn/s/profile_"+c+".html";a.linkChangeFace.href="http://control.blog.sina.com.cn/blogprofile/nick.php";a.linkChangePassword.href="http://login.sina.com.cn/member/security/password.php";a.linkAccountSetup.href="http://login.sina.com.cn/member/security.php";var d=["linkBlog","linkPhoto","linkVBlog","miniblog","qingblog","mySpace","linkChangeFace","linkChangePassword","linkAccountSetup"];for(var b=0;b<d.length;b++){a[d[b]].onclick=function(){v7sendLog("40_01_02_"+$UID)}}}});var st=['<div id="#{panel}" style="z-index:512;" class="tb_layerBox">',"<ul>",'<li id="#{blog}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">博文</a></li>','<li id="#{bauthor}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">博主</a></li>','<li id="#{song}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">音乐</a></li>','<li id="#{video}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">视频</a></li>','<li id="#{vauthor}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">播主 </a></li>',"</ul>","</div>"];scope.searchPanelTemplate=st.join("");scope.SearchPanel=Core.Class.define(function(){Lib.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(scope.searchPanelTemplate)},Lib.Panel,{config:{blog:{text:"博文",url:"http://search.sina.com.cn/?c=blog",keyName:"q",range:"article",by:"all"},bauthor:{text:"博主",url:"http://search.sina.com.cn/?c=blog",keyName:"q",range:"author",by:"all"},song:{text:"音乐",url:"http://music.sina.com.cn/yueku/search/s.php",keyName:"k",t:"song",s:"",ts:"",type:"",stype:""},video:{text:"视频",url:"http://search.video.sina.com.cn/search.php",keyName:"k",t:"",s:"sup",ts:"",type:"boke",stype:"1"},vauthor:{text:"播主",url:"http://search.video.sina.com.cn/search.php",keyName:"k",t:"",s:"sup",ts:"",type:"boke",stype:"3"}}});Utils.Flash.swfView={swfList:[],Add:function(f,g,b,i,j,d,k,a,c){if(f&&b){this.swfList[this.swfList.length]={sURL:f,sID:g,sPID:b,nWidth:i,nHeight:j,nVersion:d,sBGColor:k,oVar:a,oParam:c};this.Init();return}},Init:function(){var j;var g=this.swfList;for(var d=0,b=g.length;d<b;d++){var f=g[d];j=new Utils.Flash.swfObject(f.sURL,f.sPID,f.nWidth,f.nHeight,f.nVersion,f.sBGColor);if(f.oVar){for(var c in f.oVar){j.addVariable(c,f.oVar[c])}}if(f.oParam){for(var a in f.oParam){j.addParam(a,f.oParam[a])}}j.write(f.sID)}g=[];f=null;j=null}};Utils.Io.loadCss=function(d,b){if(d==null){return false}b=b||window;var a=b.document;d.id=d.id||"";var c;if(d.url){c=a.createElement("link");c.setAttribute("rel","stylesheet");c.setAttribute("type","text/css");c.setAttribute("href",d.url)}else{if(d.text){c=a.createElement("style");c.setAttribute("type","text/css");if($IE){c.styleSheet.cssText=d.text}else{c.innerHTML=d.text}}}c.setAttribute("id",d.id);a.getElementsByTagName("head")[0].appendChild(c)};Core.Dom.opacity=function(b,a){b=typeof b=="string"?$E(b):b;b.style.filter="alpha(opacity="+a+")";b.style.opacity=a/100};var st=['<div id="#{panel}" style="z-index:512;" class="tb_layer_Y tb_layer_w6" style="left:400px; top:700px;">','<div class="tb_layer_arrow"></div>','<div class="tb_layer_Y_main">','<div class="tb_mas" id="#{newInboxList}" style="">','<div class="tb_mas_list">','<ul id="#{changebgli1}"  style="display:none" >','<li  style="display:none" >','<span id="#{ccsysgonggao}" class="tb_friend_nm">[<strong>公告</strong>] <a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">新浪邀你一起共度中秋活动</a></span>','<span class="tb_friend_set"><a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">&gt;&gt;</a></span>',"</li>",'<li style="display:none">','<span id="#{ccsystongzhi}" class="tb_friend_nm">[<strong>通知</strong>] <a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">新浪2010邀你一起共度中秋活动...</a></span>','<span class="tb_friend_set"><a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">&gt;&gt;</a></span>',"</li>","</ul>",'<ul class="bd" id="#{changebgli2}">','<li  id="#{newInboxLoding}" style="cursor:default" ><div style="margin: 0pt; padding: 10px;text-align:center;"><img src="http://simg.sinajs.cn/blog7style/images/common/loading.gif"><div></li>','<li  id="#{nomsgli}" style="cursor:default;" >还没有消息</li>','<li style="float:none;"><span class="mas_more"><a id="#{mas_moremsg}" href="http://i.blog.sina.com.cn/blogprofile/profilelatestnote.php">全部消息</a></span></li>',"</ul>",'<div class="clearit"></div>',"</div>",'<ul class="commentslist" id="commentdata">','<li><a class="conn" href="http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1">评论</a><a class="num" href="http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1" id="#{commentRelapseCount}" ></a></li>','<li><a class="conn" href="http://i.blog.sina.com.cn/blogprofile/wall.php">留言</a><a class="num" href="http://i.blog.sina.com.cn/blogprofile/wall.php" id="#{guestBookCount}">1</a></li>','<li class="lst"><a class="conn" href="http://control.blog.sina.com.cn/blogprofile/profileinvitelist.php">好友邀请</a><a class="num" href="http://control.blog.sina.com.cn/blogprofile/profileinvitelist.php" id="#{inviteCount}" ></a></li>','<li><a class="conn" href="http://control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1">纸条</a><a class="num" href="http://control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1" id="#{messageCount}" ></a></li>','<li><a class="conn" target="_blank" href="http://mail.sina.com.cn" reject="1">邮箱</a><a class="num" href="http://mail.sina.com.cn" id="#{mailCount}" target="_blank" reject="1"></a></li>','<li><a class="conn" href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">系统消息</a><a class="num" href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote" id="#{sysnoticeCount}" ></a></li>',"</ul>","</div>","</div>","</div>"];scope.newInboxPanelTemplate=st.join("");Lib.LocalDB={_this:null,isFlashReady:false,FlaDom:null,updataFun:null,loadedFun:null,regiFun:[],regiFunArgs:[],scacheReady:function(){var d=Lib.LocalDB;d.isFlashReady=true;if(d.loadedFun){d.loadedFun(d._this)}var g=d.regiFun;var b=d.regiFunArgs;for(var c=0;c<g.length;c++){g[c].apply(null,b[c])}},registerFun:function(c,d){this.regiFun.push(c);var b=d||[];this.regiFunArgs.push(b)},set:function(a,b){if(this.isFlashReady){try{this.FlaDom.setLazyInterface(a,b);return true}catch(c){trace("set函数出错")}}return false},get:function(a,b,d){if(this.isFlashReady){try{return this.FlaDom.getLazyInterface(a,b,d)}catch(c){trace("get函数出错")}}return false},clearCache:function(b,a){if(this.isFlashReady){try{$E("scache").clearCache(b,a)}catch(c){trace("gclearCache函数出错")}}return false},loadFlash:function(c){var b="";if(window.$Maxthon||window.$360||window.$TT){b="?t="+Core.Math.getUniqueId()}if(!this.FlaDom){var a=new Utils.Flash.swfObject($_GLOBAL.flashBasicURL+"scache.swf"+b,"scache","1","1","9","#00ff00");a.addParam("quality","high");a.addParam("wmode","transparent");a.addParam("allowScriptAccess","always");a.write(c);this.FlaDom=$E("scache")}},getServer:function(){try{return this.FlaDom.isServer()}catch(a){trace("判断是否是通信主机发生错误");return false}},login:function(a){try{this.FlaDom.login(a)}catch(b){trace("login函数出错");trace(a)}},sendToClient:function(a){try{if(this.getServer()){this.FlaDom.sendToClient(a)}else{}}catch(b){trace("sendToClient函数出错")}},setClientJsFun:function(a){try{if(this.getServer()){this.FlaDom.setClientJsFun(a)}else{trace("非主机不可以设置接收函数")}}catch(b){trace("setClientJsFun函数出错")}},receive:function(a){this.updataFun(a)}};scope.msnTipsTemplate=['<div id="#{panel}" style="position: absolute; width: 369px; padding-top: 7px; font-size: 12px; z-index:511">',"<div  style=\"top: 0pt; left: 65px; position: absolute; width: 16px; height: 8px; background: url('http://simg.sinajs.cn/blog7style/images/special/move/bg_boxtop_01.png') no-repeat scroll 0pt 0pt transparent; z-index: 100;\"></div>","<div style=\"padding: 5px 6px 9px 14px; border: 1px solid rgb(181, 202, 214); background: url('http://simg.sinajs.cn/blog7style/images/special/move/bg_asiangames.jpg') no-repeat scroll left bottom rgb(255, 255, 255); z-index: 1;\">",'<p id="#{close}" class="close" style="float: right; margin: 0pt; cursor: pointer; width: 8px; height: 8px; font-size: 0pt;background:url(\'http://simg.sinajs.cn/blog7style/images/special/move/btn_close.gif\') no-repeat 0 0;"></p>','<div style="width: 342px; margin: 10px 0pt 0pt; padding: 0pt 0pt 3px;">','<a style="float: left; margin: 0pt 10px 0pt 0pt;" href="#"><img height="91" width="122" style="border: 0pt none;" alt="MSN" src="http://simg.sinajs.cn/blog7style/images/special/move/img_msnphoto.png"></a>','<h3 style="padding: 2px 0pt 5px; color: rgb(0, 0, 0); margin: 0pt; font-size: 12px;">各位拥有MSN帐号的同学注意啦!</h3>','<p style="width: 268px; display: inline; text-indent: 0pt; padding: 0pt; color: rgb(51, 51, 51); line-height: 19px;">新浪博客帐号与MSN帐号已经实现关联。您可以使用MSN帐号来登录博客，绑定后发博文、发图片可同步到Live，第一时间让您的MSN好友知晓。</p>',"</div>",'<p style="clear: both; height: 30px; margin: 12px 10px 4px 0pt; padding: 12px 0pt 0pt; border-top: 1px solid rgb(220, 213, 211); text-align: right;"><a style="float: right; color: rgb(176, 173, 172); margin-top: 10px; text-decoration: none;" href="javascript:void(0);" id="#{noMoreShow}">不再显示</a><a style="float: right; text-decoration: none; margin: 10px 14px 0pt 16px;color:#2d3186;" href="http://blog.sina.com.cn/s/blog_4b0f52990100lt3i.html">帮助</a><a id="#{setNow}"style="float: right;" href="http://control.blog.sina.com.cn/blogprofile/msnbind.php"><img height="32" width="105" style="border: medium none;" alt="立即设置" src="http://simg.sinajs.cn/blog7style/images/special/move/btn_receive01.jpg"></a></p>',"</div>","</div>"].join("");scope.msnTips=Core.Class.define(function(){Lib.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(scope.msnTipsTemplate)},Lib.Panel,{initUserInfo:function(a,c){var b=this.getNodes();this.setFixed($E("loginBarActivity"),-230,-2);var d=this;b.close.onclick=function(){d.hidden()};b.noMoreShow.onclick=function(){d.hidden();Utils.Cookie.setCookie("noMoreMsnTips"+$UID,1,24*100,"/",".blog.sina.com.cn")};b.setNow.onclick=function(){v7sendLog("95_02_01",scope.$pageid,"")}},setFixed:function(c,b,a){var d=this;setTimeout(function(){d.showWithDom(c,b,a);d.fadeIn()},2000);Core.Events.addEvent(window,function(){var f=Core.Dom.getLeft(c)+c.offsetWidth+b;var g=Core.Dom.getTop(c)+c.offsetHeight+a;if($IE6&&d.isFixed){f=f-document.documentElement.scrollLeft;g=g-document.documentElement.scrollTop}d.setPosition(f,g)},"resize")},fadeIn:function(){var a=this.entity;Core.Dom.opacity(a,0);var b=0;(function c(){Core.Dom.opacity(a,b+=5);if(Core.Dom.getStyle(a,"opacity")<1){setTimeout(c,20)}})()}});scope.NewInboxPanel=Core.Class.define(function(){Lib.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(scope.newInboxPanelTemplate);this.nodes=this.getNodes();var b=this;var a=Lib.LocalDB;if(/Mobile/i.test(navigator.userAgent)){setTimeout(function(){b.requestDataInterface()},100)}else{if(!a.FlaDom){a._this=b;a.loadedFun=b.FlashLoaded;a.loadFlash("trayFlashConnetion")}else{b.FlashLoaded(b)}}Core.Events.addEvent($E("loginBarInbox"),function(c){v7sendLog("40_01_09_"+$UID);var d=(c&&c.target)||(window.event&&window.event.srcElement);if(d&&d.tagName&&d.tagName.toLowerCase()=="a"){v7sendLog("45_01_10_"+$UID)}b._hasOverview=true;$E("ccnotepiaohong").style.display="none";b.requestMsgDate()},"click");this.interfaceMessages=new Interface("http://interface.blog.sina.com.cn/riaapi/profile/unread.php","jsload")},Lib.Panel,{nodes:null,_connectSWF:null,_SWFChannelName:"inboxConnection",interfaceMessges:null,isMessageLoaded:false,isUICServiceLoaded:true,isHaveNewMessage:false,_listData:null,_productIDs:{blog:1,vblog:2,group:4,photo:8,cube:16},_msgIsLoad:false,_newnote:0,_hasOverview:false,interfaceUICServiceURL:"http://uic.sinajs.cn/uic?type=service&uids=#{uids}&varname=service",FlashLoaded:function(b){var a=Lib.LocalDB;var c=b;window.$updateData=function(d){c.updateData(d)};Lib.checkAuthor();a.login($UID);a.setClientJsFun("$updateData");setTimeout(function(){c.requestDataInterface()},100)},requestMsgDate:function(){this.updateView("loading");var c=this;var b=0;if(this._hasOverview){b=this._newnote;this._newnote=0;this._hasOverview=false}var a=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/notetips.php?clearnum="+b,"jsload");a.request({GET:{uid:$UID},onSuccess:function(m){if(typeof m.announcement!="undefined"&&m.announcement){c.nodes.ccsysgonggao.innerHTML='[<strong>公告</strong>]&nbsp;<a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">'+m.announcement+"</a>";c.nodes.ccsysgonggao.parentNode.style.display=""}else{c.nodes.ccsysgonggao.parentNode.style.display="none"}if(typeof m.sysNote!="undefined"&&m.sysNote){c.nodes.ccsystongzhi.innerHTML='[<strong>通知</strong>]&nbsp;<a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">'+m.sysNote+"</a>";c.nodes.ccsystongzhi.parentNode.style.display=""}else{c.nodes.ccsystongzhi.parentNode.style.display="none"}if(typeof m.sysNote=="undefined"&&typeof m.announcement=="undefined"){c.nodes.ccsystongzhi.parentNode.parentNode.style.display="none"}else{c.nodes.ccsystongzhi.parentNode.parentNode.style.display=""}c.nodes.nomsgli.style.display="";if(typeof m.notice!="undefined"&&m.notice){var n=m.notice;while(c.nodes.changebgli2.childNodes.length>2){c.nodes.changebgli2.removeChild(c.nodes.changebgli2.childNodes[c.nodes.changebgli2.childNodes.length-3])}for(var l=n.length-1;l>=0;l--){var f=$C("li");f.innerHTML=n[l].data;f._href=n[l].url;c.nodes.changebgli2.insertBefore(f,c.nodes.changebgli2.firstChild);f.onclick=function(){v7sendLog("45_01_11_"+$UID);window.location.href=this._href};c.nodes.nomsgli.style.display="none"}}if(parseInt($E("ccnotepiaohong").innerHTML,10)>0){var k=parseInt($E("ccnotepiaohong").innerHTML,10);var o=c.nodes.changebgli2.childNodes;for(var g=0;(g<o.length-2&&g<k);g++){Core.Dom.removeClassName(o[g],"cur");o[g].className+=" cur"}}c.updateView("loaded");c._msgIsLoad=true;c.bindliEvent()},onError:function(f){},onFail:function(){}});var d=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/unreadmail.php","jsload");d.request({onSuccess:function(g){var f=parseInt(g)||0;if(f>99){f="99+"}c.nodes.mailCount.innerHTML=f||""},onError:function(){c.nodes.mailCount.innerHTML=""}})},requestDataInterface:function(){var f=this;Lib.checkAuthor();var a=Lib.LocalDB;var c=null;if(a.isFlashReady&&!this.checkCache){this.clearCache();c=a.get("uid_"+$UID+"unread",60*1000*4);this.checkCache=true}var b=function(g,d){if(!c&&!d){a.set("uid_"+$UID+"unread",g)}if(g.isBindToMsn==0&&Utils.Cookie.getCookie("noMoreMsnTips"+$UID)!=1){}f.isMessageLoaded=true;f.onMessageLoad(g.nickname);f._listData=g;scope.unreadMsg=g;scope.nickname=g.full_nickname;scope.loginUserWtype=g.login_wtype;if(g.svr_time){scope.$svr_time=g.svr_time}if(g.nfn>=1){v7sendLog("40_01_03_"+$UID);f.initNewStatusTip(g)}else{}f.updateListData(g);if(f.isMessageLoaded){f.updateData({data:f._listData});f.onLoaded()}scope.hasOpenBlog=g.isbloguser==1?"open":"no";scope.bindTrayOpenTime=1;Lib.Listener.notify("tray-data-loaded",g);if(scope.hasOpenBlog=="no"&&scope.bindTrayOpenTime==1){if(!$E("openblogcss")){Utils.Io.loadCss({id:"openblogcss",url:$_GLOBAL.cssBasicURL+"module/layer/re_nowopen.css"})}$E("openedBlogTray").style.display="none";$E("noOpenedBlogTray").style.display="";$E("outOfOpenBlogTray").style.display="";scope.addBlogOpenerEvent($E("openBlogBtnTray"));$E("noOpenBlogName").href="http://blog.sina.com.cn/u/"+$UID;scope.bindTrayOpenTime=2}scope.unreadOkExecuted=true};if(c){b(c,true);trace("-------unread 使用缓存的数据!!!----")}else{trace("-----直接调用unread接口！！！");this.interfaceMessages.request({GET:{uid:$UID,product:"blog"},onSuccess:b,onError:function(d){},onFail:function(){}})}},clearCache:function(){var a={profile_notice:"notice",profile_paperlist:"message",profile_invitelist:"invite",profile_commlist:"blogcomment",profile_replylist:"blogrecomment",profile_guestBookM:"gbook",profile_commtrash:"trashcomment",profile_commphotolist:"photocomment",profile_index:"profile_index",profile_remind:"profile_remind"};var b=Lib.LocalDB;var f=b.get("uid_"+$UID+"unread",60*1000*4);if(f&&a[scope.$pageid]&&typeof(f[a[scope.$pageid]])!=undefined){trace("-----清除缓存");b.clearCache(10,"uid_"+$UID+"unread")}var g=$UID+"_clear_flash";var c=Utils.Cookie.getCookie(g);if(c==1){trace("【活动】根据cookie标记,清除Flash缓存");b.clearCache(10,"uid_"+$UID+"unread");Utils.Cookie.setCookie(g,"",0,"/",".sina.com.cn")}},initMsnTips:function(){Lib.checkAuthor();new scope.msnTips().initUserInfo($nick,$UID)},initNewStatusTip:function(f){if(scope.$pageid=="profile_index"||scope.$pageid=="pageSetM"||scope.$pageid=="editor"){return}var d=$E("newStatusTip");if(d||!f){return}v7sendLog("45_01_07_"+$UID);d=$C("div");d.id="newStatusTip";d.className="tb_layer_Y tb_layer_w3";d.style.width="138px";d.innerHTML=scope.newStatusTipTemplay;var b=$T($E("loginBarCenter"),"a")[0];var g=Core.Dom.getXY(b);d.style.left=(g[0]-(138/2-b.offsetWidth/2))+"px";d.style.top=(g[1]+b.offsetHeight)+"px";d.style.zIndex="510";if(b.href.indexOf("?")==-1){b.href+="?type=2&from="+scope.$pageid}Core.Dom.opacity(d,0);document.body.appendChild(d);if(f.nfn>=1){$E("nstFeed").style.display="block";$E("nstFeed").onclick=function(){v7sendLog("45_01_09_"+$UID);v7sendLog("40_01_04_"+$UID)}}if(f.official_blog==1){$E("gbimg").style.display="";$E("gbmsg").style.display=""}for(var c=1;c<=500;c++){(function(a){setTimeout(function(){Core.Dom.opacity(d,a*2/10)},a*2)})(c)}if(scope.$pageid=="editor"){b.target="_blank";$E("nstFeed").parentNode.target="_blank";$E("gbmsg").style.target="_blank";Core.Events.addEvent(b,this.closeTip(b),"click")}Core.Events.addEvent(window,function(){var i=$T($E("loginBarCenter"),"a")[0];var j=Core.Dom.getXY(i);d.style.left=(j[0]-(138/2-i.offsetWidth/2))+"px";d.style.top=(j[1]+i.offsetHeight)+"px"},"resize")},closeTip:function(a){return function(){$E("newStatusTip").style.display="none";a.href=a.href.split("?")[0]}},updateData:function(a){var c=Lib.LocalDB;var d=this;Lib.checkAuthor();try{if(($UID&&$UID==a.uid)||c.getServer()==true){d.isHaveNewMessage=false;d.isMessageLoaded=false;d.updateListData(a.data);if(d._newnote>0){v7sendLog("45_01_08_"+$UID);v7sendLog("40_01_08_"+$UID)}if(a.data.nfn>=1){d.initNewStatusTip()}}}catch(b){}if(c.getServer()==true){Lib.checkAuthor();c.sendToClient({data:a.data,uid:$UID});setTimeout(function(){d.requestUICService();d.requestDataInterface()},60000*4)}else{setTimeout(function(){if(c.getServer()){c.setClientJsFun("$updateData");d.requestUICService();d.requestDataInterface()}},60000*4)}},initializeList:function(){this.requestUICService();this.checkCache=false},updateListData:function(d){try{var c=0;c+=parseInt(this._getFormatCountString(d.invite)||0);if(c>500){c="500+"}this.nodes.inviteCount.innerHTML=c?c:""}catch(j){}try{var c=0;c+=parseInt(this._getFormatCountString(d.message)||0);if(c>500){c="500+"}this.nodes.messageCount.innerHTML=c?c:""}catch(j){}try{var c=0;c+=parseInt(d.unreadnotices||0);c+=parseInt(d.notice||0);if(c>500){c="500+"}this.nodes.sysnoticeCount.innerHTML=c?c:""}catch(j){}Lib.checkAuthor();try{var c=0;c+=parseInt(this._getFormatCountString(d.gbook)||0);c+=parseInt(this._getFormatCountString(d.trashwall)||0);if(c>500){c="500+"}this.nodes.guestBookCount.innerHTML=c?c:""}catch(j){}try{var c=0;c+=parseInt(d.blogcomment||0);c+=parseInt(d.blogrecomment||0);c+=parseInt(d.photocomment||0);c+=parseInt(d.trashcomment||0);if(c>500){c="500+"}this.nodes.commentRelapseCount.innerHTML=c?c:""}catch(j){}this._newnote=parseInt(d.newnotes,10);if(this._newnote>0){$E("ccnotepiaohong").innerHTML=this._newnote>500?"500+":this._newnote;$E("ccnotepiaohong").style.display=""}else{$E("ccnotepiaohong").style.display="none"}var f,g=["notice","invite","message","blogcomment","blogrecomment","photocomment","trashcomment","vblogcomment","gbook"],a=g.length;for(f=0;f<a;f++){if(parseInt(d[g[f]])>0){this.isHaveNewMessage=true}var b;for(b in d){if(b!="version"&&window.parseInt(d[b])>0){if($E("left_"+b)){$E("left_"+b).innerHTML="("+d[b]+")"}}}}},requestUICService:function(){Lib.checkAuthor();if(this.isMessageLoaded){this.updateData({data:this._listData});this.onLoaded()}},_getFormatCountString:function(b){var a="";if(!isNaN(parseInt(b))&&parseInt(b)!=0){if(parseInt(b)>500){a="(<strong>500+</strong>)"}else{a=b}}return a},updateView:function(a){this.nodes.newInboxLoding.style.display=a=="loaded"?"none":"";if(a=="loading"){this.nodes.nomsgli.style.display="none"}},onLoaded:function(){},onMessageLoad:function(a){$E("loginBarAppMenuLabel").innerHTML=Core.System.htmlFilter(a);$E("noOpenBlogName").innerHTML=Core.System.htmlFilter(a)},bindliEvent:function(){var a=this.nodes.changebgli1.getElementsByTagName("li");var f=this.nodes.changebgli2.getElementsByTagName("li");for(var c=0;c<a.length;c++){a[c].style.cursor="pointer";a[c].onmouseover=function(){this._className=this.className;this.className="on"};a[c].onmouseout=function(){this.className=this._className}}for(var c=0;c<f.length-1;c++){if(f[c]==this.nodes.nomsgli){continue}f[c].style.cursor="pointer";f[c].onmouseover=function(){this._className=this.className;this.className="on"};f[c].onmouseout=function(){this.className=this._className}}var d=$E("commentdata");if(d){Core.Events.addEvent(d,function(g){b(g)})}Core.Events.addEvent(this.nodes.changebgli1,function(g){b(g)});Core.Events.addEvent(this.nodes.changebgli2,function(g){b(g)});function b(g){var i=(g&&g.target)||(window.event&&window.event.srcElement);if(i&&i.tagName&&(i.tagName.toLowerCase()=="a"||i.tagName.toLowerCase()=="li")&&!i.getAttribute("reject")){v7sendLog("40_01_10_"+$UID);v7sendLog("45_01_11_"+$UID)}}}});scope.addArticleTemplate=['<div id="#{panel}" class="wrtBlog_sub" style="z-index:512;">','<div class="wrtBlog_sub2">','<p><img width="15" height="16" align="absmiddle" title="写365" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon138"><a onclick="v7sendLog(\'48_01_18\');v7sendLog(\'40_01_14\');" href="http://control.blog.sina.com.cn/admin/article/article_add.php?tag365" target="_blank">写365</a></p>','<div class="SG_j_linedot"></div>','<p><img class="SG_icon SG_icon88" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="长微博" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://control.blog.sina.com.cn/admin/article/changWeiBo.php">长微博</a></p>','<div class="SG_j_linedot"></div>','<p><img class="SG_icon SG_icon87" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="微语录" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://control.blog.sina.com.cn/weiyulu/weiyulu.php">微语录</a></p>','<div class="SG_j_linedot"></div>','<p><img class="SG_icon SG_icon85" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="九宫格" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://control.blog.sina.com.cn/admin/article/daily.php">九宫格</a></p>','<div class="SG_j_linedot"></div>','<p><img class="SG_icon SG_icon18" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="发照片" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://photo.blog.sina.com.cn/upload/upload.php">发照片</a></p>','<div class="SG_j_linedot"></div>','<p><img class="SG_icon SG_icon16" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="发视频" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://vupload.you.video.sina.com.cn/u.php?m=1">发视频</a></p>','<div id="tray_tbh_ware_linedot" style="display:none;" class="SG_j_linedot"></div>','<p id="tray_tbh_ware_link" style="display:none;"><img class="SG_icon SG_icon150" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="发商品" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://control.blog.sina.com.cn/admin/article/article_add.php?tbh=1">发商品</a></p>',"</div>","</div>"].join("");scope.addArticlePanel=Core.Class.define(function(){Lib.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(scope.addArticleTemplate);this.hidden()},Lib.Panel,{});String.prototype.format=function(){var f=(!arguments[0]||typeof arguments[0]=="undefined")?"":arguments[0].toString();var d=/(.*?)({(\d+)(:([0-9a-z]+))?})/ig;var c=this.match(d);if(c){for(var b=0,a=c.length;b<a;b++){c[b]=c[b].replace(d,function(){return RegExp.$1});c[b]=RegExp.$1;switch(typeof arguments[parseInt(RegExp.$3)]){case"undefined":c[b]+=RegExp.$2;break;case"number":c[b]+=(isNaN(RegExp.$5)||RegExp.$5=="")?arguments[parseInt(RegExp.$3)]:arguments[parseInt(RegExp.$3)].toString(Math.max(Math.min(Math.round(RegExp.$5),36),2));break;default:c[b]+=arguments[parseInt(RegExp.$3)]}}c.push(this.replace(d,""));return c.join("")}return this};Lib.pkg("Login");Lib.Login.info=function(){var a;if(window.sinaSSOController&&(a=sinaSSOController.getLoginInfo())){return a}else{return{}}};Lib.Login.LoginPost=Core.Class.create();Lib.Login.LoginPost.prototype={url:"http://i.sso.sina.com.cn/js/ssologin.js",callback:null,initialize:function(c,a,b){window.sinaSSOConfig=new function(){if(b){this.from=b}this.pageCharset="utf-8";this.noActiveTime=14400;this.setDomain=true;this.entry="boke";this.customInit=function(){};this.customLoginCallBack=c;this.customLogoutCallBack=function(d){};this.useIframe=true}},login:function(f,b,c){var d=this;if(typeof sinaSSOController=="undefined"||!sinaSSOController){trace("no sso");Utils.Io.JsLoad.request(this.url,{onComplete:function(){a()},onException:function(){},timeout:30000,isRemove:false})}else{trace("has sso");sinaSSOController.init();if(typeof sinaSSOController.setLoginType=="function"){sinaSSOController.setLoginType(2)}if(typeof sinaSSOController.getServerTime=="function"){sinaSSOController.getServerTime(f)}trace("init ok");a()}function a(){if(typeof c=="undefined"){sinaSSOController.login(f,b)}else{sinaSSOController.login(f,b,c)}}},parse:function(a){this.callback.call(a)}};(function(){var i;var c=parseInt(Math.random()*100);var j=[];var b=-1;var g="";var f="#userPosition {padding: 0;margin: 0;border: 0;position: absolute;z-index: 999;}				#sinaNote {position: absolute;z-index: 999999;width: auto;overflow: hidden;padding: 0;margin: 0;				border: 1px solid #CCCCCC;background: #ffffff;text-align:left;}				#sinaNote li {font-size: 12px;list-style: none;margin: 0 1px;height: 20px;padding: 0 5px;clear: both;				line-height: 20px;cursor: pointer;color: #999999;}				#sinaNote li.note {text-align: left;color: #999999;}";var d=window;var a={overfcolor:"#999",overbgcolor:"#e8f4fc",outfcolor:"#000000",outbgcolor:"",menuStatus:{"sina.com":true,"sina.cn":true,"vip.sina.com":true,"qq.com":true,"163.com":true,"126.com":true,"hotmail.com":true,"yahoo.com.cn":true,"gmail.com":true}};a.createNode=function(){var n=d.document;var o=n.createElement("div");o.innerHTML='<ul id="sinaNote" style="display:none;"></ul>';var m=n.createElement("style");m.setAttribute("type","text/css");try{if($IE){m.styleSheet.cssText=f}else{m.innerHTML=f}}catch(l){trace(l.message)}var k=n.createElement("div");k.appendChild(o);k.appendChild(m);n.body.appendChild(k)};a.arrowKey=function(k){if(k==38){if(b<=0){b=j.length}b--;a.selectLi(b)}if(k==40){if(b>=j.length-1){b=-1}b++;a.selectLi(b)}};a.showList=function(z){g="";var D=Core.Events.getEvent().keyCode;if(D==38||D==40){a.arrowKey(D);return false}if(!$E("sinaNote")){a.createNode()}var n=$E(z).value;var m={};var t=n.indexOf("@");var B="";var r="";if(t>-1){B=n.substr(t+1);r=n.substr(0,t)}j=[];b=0;j[j.length]="sinaNote_MenuItem_Title_"+c;for(var F in this.menuStatus){this.menuStatus[F]=true;if(B!=""&&B!=F.substr(0,B.length)){this.menuStatus[F]=false}else{j[j.length]="sinaNote_MenuItem_"+F+"_"+c}}var v='<li class="note">请选择登录类型</li>';v+='<li id="sinaNote_MenuItem_Title_'+c+'">'+n+"</li>";var C;for(var o in this.menuStatus){if(this.menuStatus[o]==true){if(r==""){C=n+"@"+o}else{C=r+"@"+o}v+='<li id="sinaNote_MenuItem_'+o+"_"+c+'" title="'+C+'">'+C+"</li>"}}$E("sinaNote").innerHTML=v;for(var y=0;y<n.length;y++){if(n.charCodeAt(y)<160){$E("sinaNote").style.display="";this.selectList(z)}else{this.hideList()}}var k=$E(z);var l=$E("sinaNote");var q=0;var u=0;var p;if(d!=window){p=Core.Dom.getXY(window.frameElement);q=p[0];u=p[1]}var A=k.offsetWidth;if(A<200){A=200}l.style.width=A-2+"px";var E=Core.Dom.getXY(k);l.style.left=(E[0]-($IE?2:-1)+q)+"px";l.style.top=(E[1]+k.offsetHeight-($IE?2:-1)+u)+"px"};a.selectList=function(m){var k=$E("sinaNote").getElementsByTagName("li");for(var l=1;l<k.length;l++){k[1].style.backgroundColor=a.overbgcolor;k[1].style.color=a.outfcolor;k[l].onmousedown=function(){var n=this.innerHTML;if(n.indexOf("非新浪邮箱")>-1){var o=n.split("@");$E(m).value=o[0]}else{$E(m).value=this.innerHTML}if(Core.Events.getEvent()!=null){Core.Events.stopEvent()}};k[l].onmouseover=function(){if(l!=1){k[1].style.backgroundColor=a.outbgcolor;k[1].style.color=a.overfcolor}this.style.backgroundColor=a.overbgcolor;this.style.color=a.outfcolor};k[l].onmouseout=function(){this.style.backgroundColor=a.outbgcolor;this.style.color=a.overfcolor;k[1].style.backgroundColor=a.overbgcolor;k[1].style.color=a.outfcolor}}};a.selectLi=function(k){var m;$E("sinaNote_MenuItem_Title_"+c).style.backgroundColor=a.outbgcolor;$E("sinaNote_MenuItem_Title_"+c).style.color=a.overfcolor;for(var l=0;l<j.length;l++){m=$E(j[l]);m.style.backgroundColor=a.outbgcolor;m.style.color=a.overfcolor}$E(j[k]).style.backgroundColor=a.overbgcolor;$E(j[k]).style.color=a.outfcolor;g=$E(j[k]).innerHTML};a.hideList=function(){if(!$E("sinaNote")){a.createNode()}$E("sinaNote").style.display="none"};a.init=function(o,m,k,n){n=n||window;if(n.document.body==null){setTimeout(Core.Function.bind3(function(){this.init(o,m,k,n)},this),100)}for(var l in m){this[l]=m[l]}Core.Events.addEvent(document,a.hideList,"click");Core.Events.addEvent(o,a.hideList,"blur");Core.Events.addEvent(o,Core.Function.bind3(a.showList,this,[o]),"keyup");Core.Events.addEvent(o,function(t){var r=Core.Events.getEvent().keyCode;var q;if(r==13||r==9){if(g!=""){var p=g;if(p.indexOf("非新浪邮箱")>-1){var u=p.split("@");o.value=u[0]+"@";q=false}else{o.value=g;q=true}}if(q){if(k!=null){setTimeout(function(){k.focus()},0)}}else{if(o){o.focus()}}}},"keydown");if(n){d=n}};Lib.passcardOBJ=a})();Lib.Login.Ui=Core.Class.create();var msnRefreshTimer=0;function msnrefreshWindow(){var setCookie=Utils.Cookie.setCookie;var getCookie=Utils.Cookie.getCookie;clearTimeout(msnRefreshTimer);var reg_token=getCookie("reg_token");if(reg_token){trace("token find out...");setCookie("reg_token","","","/",".blog.sina.com.cn")}else{trace("no token...");msnRefreshTimer=setTimeout(msnrefreshWindow,1000);return}var cookieArr;var cid;var code;var c_cid=getCookie("c_uid");var CBcookie=getCookie("msnLinkCB");var altReg=getCookie("AlT");setCookie("msnLoginComeFrom",window.location.href,1,"/",".blog.sina.com.cn");if(CBcookie){cookieArr=CBcookie.split("_");cid=cookieArr[0];code=cookieArr[1]}if(c_cid!=cid){return}switch(code){case"noCid":break;case"loginError":break;case"unlink":deleteCookie("msnLinkCB");funcNoAccount(reg_token);break;case"done":deleteCookie("msnLinkCB");setCookie("loginFromMsn","msn",24,"/",".blog.sina.com.cn");funcSuccess(altReg,reg_token);break;case"pass":break}function funcSuccess(arg,reg_tk){trace("has Account");if(arg){trace("alt:"+arg);var iframe=$C("iframe");iframe.setAttribute("height",0);iframe.setAttribute("width",0);document.body.appendChild(iframe);iframe.src="https://login.sina.com.cn/sso/login.php?entry=blogmsn&service=blogmsn&alt="+encodeURIComponent(arg)+"&savestate=7&returntype=TEXT";(function(){var me=arguments.callee;if(!me.count){me.count=0}if(me.count++>10){trace("放弃获取SUP");iframe.parentNode.removeChild(iframe);return}trace("尝试获取SUP, count:"+me.count);if(getCookie("SUP")){trace("获取到 SUP"+getCookie("SUP"));window.location.reload();return}setTimeout(me,1000)})()}else{window.location.reload()}}function funcNoAccount(){trace("noAccount");window.location.href="http://blog.sina.com.cn/blog_rebuild/msn/interface/connect_user_confirm.php"}function deleteCookie(name){var Then=new Date();Then.setTime(Then.getTime()-1);document.cookie=name+"=_pass;path=/;domain=.blog.sina.com.cn;expires="+Then.toGMTString()}function jsonDecode(str){if(!str||str==""){return null}try{return window.eval("("+str+")")}catch(e){return null}}}Lib.Login.Ui.prototype={dialog:null,isInit:false,request:null,callback:null,initialize:function(){},login:function(c,a,b){this.callback=c||null;this.clearDomain=a||false;this.from=b||null;this.initDom();this.initEvent();this.dialog.show();this.dialog.setAreaLocked(true);this.reloadName();this.onShow();this.focus();if(scope.$pageid==="blogMove"){$E("login_move_tip").style.display=""}if($IE6){this.initAD()}Lib.passcardOBJ.init($E("login_name_d"),{overfcolor:"#999",overbgcolor:"#e8f4fc",outfcolor:"#000000",outbgcolor:""},$E("login_pass_d"))},reloadName:function(){var b=Lib.Login.info();var c=b.ln;if(c){$E("login_name_d").value=c}var a=Utils.Cookie.getCookie("ALF");if(a!=""&&$E("login_save")){$E("login_save").checked=true;$E("login_save_tips").style.display="none"}a=Utils.Cookie.getCookie("LiRe");if(a!=""&&$E("login_save")){$E("login_save").checked=true;$E("login_save_tips").style.display="none"}},initDom:function(){var a=this;this.dialog=winDialog.createCustomsDialog({tpl:a.tpl});this.dialog.addEventListener("hidden",function(){this.destroy()});this.dialog.setContent(this.struc);this.dialog.setTitle("登录新浪博客");this.dialog.setMiddle()},initEvent:function(){var b=this.parse.bind2(this);this.request=new Lib.Login.LoginPost(b,this.clearDomain,this.from);Core.Events.addEvent("login_button",this.doLogin.bind2(this));Core.Events.addEvent("login_name_d",function(d){var c=d.keyCode;if(c==13){this.doLogin()}}.bind2(this),"keydown");Core.Events.addEvent("login_pass_d",function(d){var c=d.keyCode;if(c==13){this.doLogin()}}.bind2(this),"keydown");var a=1;Core.Events.addEvent("login_save",function(){if($E("login_save").checked){$E("login_save_tips").style.display=""}else{$E("login_save_tips").style.display="none"}if(a){var c="http://control.blog.sina.com.cn/blog_rebuild/riaapi/padblog/padInfo.php?ck_login=A00001&rnd="+Math.random();Utils.Io.JsLoad.request(c,{onComplete:function(){},onException:function(){}});a=null}})},doLogin:function(){Core.Events.stopEvent();var c=$E("login_name_d").value;var a=$E("login_pass_d").value;c=Core.String.trim(c);a=a;if(c==""){this.error("请输入登录名");return false}if(a==""){this.error("请输入密码");return false}if(typeof sinaSSOController!="undefined"&&typeof sinaSSOController.loginExtraQuery!="undefined"){if(typeof sinaSSOController.loginExtraQuery.door!="undefined"){var b=$E("login_vcode").value;sinaSSOController.loginExtraQuery.door=b||1}}if($E("login_save").checked){v7sendLog("48_01_38_1");this.request.login(c,a,60)}else{v7sendLog("48_01_38_0");this.request.login(c,a)}return false},parse:function(c){if(c.result){Lib.checkAuthor();if($E("login_save").checked){Utils.Cookie.setCookie("LiRe",true,2400,"/",".blog.sina.com.cn")}else{Utils.Cookie.setCookie("LiRe","",2400,"/",".blog.sina.com.cn")}var b=new Date(),k=b.getFullYear(),f=b.getMonth(),i=b.getDate();var a=new Date(k,f,i,24).getTime();Utils.Cookie.setCookie("onceloggedonblog",a,720,"/",".blog.sina.com.cn");var j=this;function g(){if(this.callback){try{$tray.renderLogin()}catch(d){}this.callback.call()}else{window.location=window.location.toString().replace(/#.*/,"")}}var l=false;Utils.Io.JsLoad.request("http://login.sina.com.cn/bindmail/checkmailuser.php?entry=blog&name="+encodeURIComponent($E("login_name_d").value)+"&utf82gbk=1&callback=scope.$bindEmailAlert",{noreturn:true,timeout:5000,onException:function(){if(!l){g.call(j)}}});scope.$bindEmailAlert=function(m){l=true;if((m.ret!="y"&&m.errcode!="not_verify")||Utils.Cookie.getCookie("sbr_noTBE")==1){g.call(j)}else{var d=winDialog.createCustomsDialog({content:['<div id="#{entityID} style="width:358px;height:144px" class="CP_layercon2 unilayer">','<div id="#{contentID}" class="CP_prompt">','<img height="50" align="absmiddle" width="50" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon201">','<table class="CP_w_ttl"><tbody><tr><td>经检测您的帐号存在一定的安全隐患！<br>建议绑定邮箱</td></tr></tbody></table>','<p class="CP_w_btns_Mid"><a href="javascript:;" class="SG_aBtn SG_aBtnB" id="#{bindit}" target="_blank"><cite> 绑定 </cite></a>&nbsp;&nbsp;<a href="javascript:;" class="SG_aBtn SG_aBtnB" id="#{nobind}"><cite> 暂不绑定 </cite></a></p>',"</div>",'<div class="unilayerB SG_j_linedot1">','<p class="SG_txtb"><input type="checkbox" id="#{noalertbind}"><label for="#{noalertbind}">一周内不提醒</label></p>',"</div>","</div>"].join(""),shadow:1},"bindEmail");d.setMiddle();d.show();d.nodes.btnClose.onclick=function(){g.call(j);d.hidden()};d.nodes.nobind.onclick=function(){setTimeout(function(){g.call(j);d.hidden()},100)};d.nodes.bindit.href="http://login.sina.com.cn/bindmail/bindmail.php?entry=blog";d.nodes.bindit.onclick=function(){g.call(j)};d.nodes.noalertbind.onclick=function(){if(this.checked){Utils.Cookie.setCookie("sbr_noTBE","1",24*7,"/",".blog.sina.com.cn")}else{Utils.Cookie.setCookie("sbr_noTBE","",0,"/",".blog.sina.com.cn")}}}};this.dialog.hidden()}else{if(c.errno==="4049"){sinaSSOController.loginExtraQuery={door:0};$E("login_ckimg").style.display="";$E("login_vcode").value="";$E("checkImg").src="http://login.sina.com.cn/cgi/pin.php?r="+Core.Math.getUniqueId()+"&s=0";Core.Events.addEvent($E("reloadCode"),function(){$E("checkImg").src="http://login.sina.com.cn/cgi/pin.php?r="+Core.Math.getUniqueId()+"&s=0";$E("login_vcode").value="";$E("login_div_error").innerHTML=""});this.error("");return}if(c.errno==="2070"){Core.Events.fireEvent($E("reloadCode"),"click");this.error(c.reason);return}if(c.errno=="4047"){this.error(c.reason);return}else{if(c.errno=="4057"){this.error(c.reason);return}else{if(c.errno=="4040"){this.error(c.reason);return}}}this.error("登录名或密码错误");$E("checkImg").src="http://login.sina.com.cn/cgi/pin.php?r="+Core.Math.getUniqueId()+"&s=0";$E("login_vcode").value=""}},friendlyTip:function(f){var g=f;var c=$E("login_name_d");var b=c.value;var j=this;if(!/[\u0391-\uFFE5]+/.test(b)&&!/^\d+$/.test(b)&&!/^@/.test(b)){var i="你的登录名可能是 ";var a='<a href="#" class="underline" onclick="$_RENAME(/@.*/, \'{1}\');return false">{0}{1}</a>';var k=["@sina.com","@sina.cn"];var d="";if(/@sina\.cn$/.test(b)){d=a.format("{0}",k[0])}else{if(/@sina\.com$/.test(b)){d=a.format("{0}",k[1])}else{d=a.format("{0}",k[0])+" 或 "+a.format("{0}",k[1])}}g=(i+d).format(b.replace(/@.*/,""))}return g},rename:(function(){window.$_RENAME=function(b,a){var c=$E("login_name_d");c.value=c.value.replace(b,"")+a;$E("login_pass_d").focus();$E("login_div_error").innerHTML=""};return window.$_RENAME})(),focus:function(){var a=$E("login_name_d");if(a.value==""){a.focus()}else{$E("login_pass_d").focus()}},initAD:function(){$E("login_ad").src="http://blog.sina.com.cn/lm/iframe/71/2008/0731/21.html"},onShow:function(){},error:function(a){$E("login_div_error").innerHTML=a;$E("login_pass_d").value="";this.focus()},tpl:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">提示标题</strong>','<cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">',"</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),struc:'		<div class="CP_layercon2 passLoginItem">			<div>				<div id="login_move_tip" style="display:none;margin-bottom:12px">可以使用新浪微博、邮箱、通行证的帐号进行登录</div>				<div class="boxA">登录名：					<input tabIndex="201" type="text" class="fm1" style="width:215px;" name="login_name" id="login_name_d" tabIndex=1/>  <a style="font-size: 12px;" href="http://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid='+scope.$uid+'&src=blogicp" target="_blank">立即注册</a>				</div>				<div class="boxA">密　码：					<input tabIndex="202" type="password" class="fm1" style="width:215px;" name="login_pass" maxlength="16" id="login_pass_d" tabIndex=2/>  <a style="font-size: 12px;" href="http://login.sina.com.cn/getpass.html" target="_blank">找回密码</a>				</div>				<div id="login_ckimg" class="boxA" style="display:none"> <p class="p_img">验证码：                  	<input type="text" id="login_vcode" name="login_vcode" class="fm1" size="10" maxlength="5" />                  	<img width="100" align="absmiddle" id="checkImg" src="http://login.sina.com.cn/cgi/pin.php?r='+Core.Math.getUniqueId()+'&s=0" /> <a href="javascript:;" onclick="return false;" style="font-size: 12px;"><span id="reloadCode">换一换</span></a></p> 			    </div>				<div class="ErrTips" id="login_div_error"></div>				<div class="boxB"><p><input tabIndex="203" type="checkbox" value="" id="login_save" checked="checked" /><label for="login_save"> 记住登录状态</label></p><p id="login_save_tips" style="color:#999;display:none;">建议在网吧/公用电脑上取消该选项</p><p style="margin-top: 8px;"><a id="login_button" class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;" tabIndex=204><cite>登录<input type="text"/></cite></a> </p></div>			</div>			<div class="connect_msn" id="connect_msn" style="position:relative;">				<span>使用 MSN 帐号登录博客</span>				<a href="#" onclick="Lib.checkAuthor();v7sendLog(\'48_01_36\'); window.open(\'https://login.live.com/oauth20_authorize.srf?client_id=0000000040046F08&redirect_uri=http%3A%2F%2Fcontrol.blog.sina.com.cn%2Fblog_rebuild%2Fmsn%2FmsnLoginCallBack.php&response_type=code&scope=wl.basic%20wl.signin%20wl.offline_access%20wl.share%20wl.emails\',\'neww\',\'left='+(screen.width-440)/2+",top="+(screen.height-400)/2+',height=400,width=440\');msnrefreshWindow();" style="background:transparent url(http://simg.sinajs.cn/blog7style/images/msn_login01.gif) no-repeat left top; width:70px; height:22px; line-height:22px; display:inline-block; text-align:left; text-indent:2em; text-decoration:none; color:white; font-weight:bold; font-size:14px;">登录</a>			</div>			<a href="http://blog.sina.com.cn/s/blog_4b0f52990100miil.html" target="_blank"style="left:308px;position:relative;top:-24px;">如何登录？</a>			<div class="CP_lg_ad SG_j_linedot1">				<iframe id="login_ad" src="http://blog.sina.com.cn/lm/iframe/71/2008/0731/21.html" frameborder="0" scrolling="no" height="25" width="auto"></iframe>			</div>		</div>'};Core.Events.stopBubble=function(a){var b=a?a:Core.Events.getEvent();if(b!=null){b.cancelBubble=true}};if(!$IE||$IE>8){Core.Events.stopBubble=function(a){var b=a?a:Core.Events.getEvent();if(b!=null){b.stopPropagation()}}}Lib.PlatformTrayPlus=Core.Class.create();Lib.PlatformTrayPlus.prototype={tray:null,subPanels:[],trayLogin:null,initialize:function(){},load:function(b){var a=$E("login_bar_logo_link_350");if(a&&$_GLOBAL&&$_GLOBAL.platformTrayLogo){if(!$IE6&&$_GLOBAL.platformTrayLogo.imgForOtherBrs){a.children[0].src=$_GLOBAL.platformTrayLogo.imgForOtherBrs}else{if($_GLOBAL.platformTrayLogo.imgForIE6){a.children[0].src=$_GLOBAL.platformTrayLogo.imgForIE6}}}switch(b){case"login":if($E("loginBarOptApp")==null||!$isAdmin){this.render(scope.trayPlusTemplayLogin);trace("++++js渲染 登陆后++++++")}this.initStatic();if(/ipad/i.test(navigator.userAgent)){v7sendLog("48_01_02")}this.setNodesMouseHoverStyle(["loginBarOptApp","loginBarMail","loginBarCenter","loginBarFriend","loginBarInbox"]);this.initNicknamePanel();this.initNewInboxPanel();this.initActivityPanel();var d=this;Utils.Io.JsLoad.request("http://service.mail.sina.com.cn/mailproxy/mail.php",{onComplete:function(){var i=sinamailinfo.email;if(i!=""){d.initMailRemind()}},onException:function(){}});this.initMsnLogout();if(scope&&scope.$private&&scope.$private.msnfeed){var g=this;setTimeout(function(){g.displayUserGuideTips()},1000)}break;case"logout":this.trayLogin=new Lib.Login.Ui();if($E("phprender")===null){this.render(scope.trayPlusTemplayLogout);trace("-----------js渲染---------")}else{trace("-----------php渲染---------")}this.initLogin();this.initPopularize();break;case"oncelogedon":this.trayLogin=new Lib.Login.Ui();this.render(scope.trayPlusTemplayOnceLoged);this.setNodesMouseHoverStyle(["loginBarOptApp","loginBarMail","loginBarCenter","loginBarFriend","loginBarInbox"]);var f=Lib.Login.info();var c=f&&f.uid;$E("loginBarAppMenuLabel").innerHTML=f&&f.nick;this.initPopularize();this.initOnceLogedEvent(["loginBarOptApp","loginBarMail","loginBarCenter","loginBarFriend","loginBarInbox"],c);this.initOnceLogedTips(c);this.initStatic();break}this.initAddArticlePanel();this.initSearchPanel();this.initFilmSearch()},displayUserGuideTips:function(){if(!window.scope||scope.$pageid==="profile_index"){Utils.Cookie.setCookie($UID+"alreadyVisitProfileIndex","true","86400","/",".sina.com.cn");return}var b=this;function a(){var c=$E("loginBarCenter");if(c){var g=Core.Dom.getXY(c),f=g[0]+c.offsetWidth/2-b.tipsUserGuide.offsetWidth/2+"px",d=g[1]+c.offsetHeight+10+"px"}b.tipsUserGuide.style.left=f;b.tipsUserGuide.style.top=d}},initStatic:function(){if(!this._commetTimer){var a=function(){var c=scope.$uid;var b=scope.$articleid||"";Utils.Io.JsLoad.request("http://comet.blog.sina.com.cn/notice",{GET:{uid:c||"",blogid:b},onComplete:function(d){}})};this._commetTimer=setInterval(a,30*1000);setTimeout(function(){a()},15)}},initFilmSearch:function(){var b=$E("loginBarSearchInput");b&&(b.value="");var a=$E("loginBarSearchSType");a&&(a.value="title")},render:function(a){$E("trayContainer").innerHTML=a},initLogin:function(){var b=this;var a=Core.Dom.getElementsByClass($E("trayContainer"),"span","link")[0];a.onclick=function(){v7sendLog("40_01_15")};Core.Events.addEvent($E("linkTrayLogin"),function(){v7sendLog("40_01_16");if(typeof sinaSSOController!="undefined"){sinaSSOController.loginExtraQuery={}}b.trayLogin.login(function(){Lib.checkAuthor();var c=$UID==scope.$uid?"02":"01";v7sendLog("87_01_"+c+"_"+$UID,scope.$pageid);setTimeout(function(){window.location=window.location.toString().replace(/#.*/,"")},100)},false,"referer:"+location.hostname+location.pathname+",func:0007")},"click");$E("linkReg").href="http://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid="+scope.$uid+"&src=blogicp";$E("linkReg").onclick=function(){v7sendLog("40_01_17")};if(scope.$channel){if(scope.$channel==2){$E("linkReg").href="http://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid="+scope.$uid+"&src=baby"}}},initPopularize:function(){var a=$E("divPopularize");if(a){this.hideActiLink(a);this._loadPopularizeData(a)}},_loadPopularizeData:function(a){Utils.Io.JsLoad.request("http://blog.sina.com.cn/lm/iframe/283/2012/0705/1.js",{charset:"utf-8",onComplete:function(g){var d=$_GLOBAL.popularizeConfig;if(!d||a.innerHTML){return}var c=d.length;var i=Utils.Cookie;var f=parseInt(i.getCookie("blogPopularizeIndex")||0);if(c<=f){f=0}i.setCookie("blogPopularizeIndex",1+f,24,"/",".blog.sina.com.cn");a.innerHTML=d[f];if($E("err_i8t9c")){var b=a.innerText||a.textContent||"";if(b.length>10){a.children[0].innerHTML=b.substr(0,9)+"..."}}}})},setNodesMouseHoverStyle:function(c){var b,a=c.length;for(b=0;b<a;b++){Core.Events.addEvent($E(c[b]),(function(d){return function(){Core.Dom.removeClassName($E(c[d]),"current");$E(c[d]).className+=" current"}})(b),"mouseover");Core.Events.addEvent($E(c[b]),(function(d){return function(){Core.Dom.removeClassName($E(c[d]),"current")}})(b),"mouseout")}$E("loginBarCenter").onclick=function(){v7sendLog("40_01_05_"+$UID)};$E("loginBarFriend").onclick=function(){v7sendLog("40_01_06_"+$UID)};$E("logOut").onclick=function(){v7sendLog("40_01_11_"+$UID)}},initNicknamePanel:function(){var a=new scope.NicknamePanel();Lib.checkAuthor();a.initUserInfo($UID);this.addSubPanel(a,$E("loginBarOptApp"),-98,-9);var c=this;if(Utils.Cookie.getCookie("loginFromMsn")&&!$E("msnLoginIcon")){var b=$C("img");b.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif";b.style.cssFloat=b.style.styleFloat="left";b.width="18";b.height="0";b.style.padding="9px 0";b.align="absmiddle";Core.Dom.insertAfter(b,$E("loginBarAppMenuLabel"));trace("创建msn icon");d(b)}else{trace("不渲染msn icon")}function d(j){var g=$C("a");var k=j.parentNode;var f=k.parentNode;var l=$C("img");f.style.position="relative";k.style.position="relative";l.id="msnLoginIcon";l.className="SG_icon SG_icon136";l.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif";l.style.width="18px";l.style.height="18px";l.align="absmiddle";g.appendChild(l);g.href="http://control.blog.sina.com.cn/blogprofile/msnbind.php?c="+ +new Date();g.target="_blank";g.style.cssText="display:block; width:18px; height:18px; position:absolute; z-index:1024;";g.style.paddingTop="4px";g.title="MSN账号登录";f.insertBefore(g,f.childNodes[0]);Core.Events.addEvent(window,i,"resize");trace("创建msn icon mask");i();function i(){var m=setInterval(function(){var n=$E("loginBarAppMenuLabel").innerHTML;if(n!=="读取中..."){var o=j.offsetLeft+"px";g.style.left=o;trace("刷新msn icon mask");clearInterval(m)}},300)}scope.$msnRelocation=i}},initAddArticlePanel:function(){var a=new scope.addArticlePanel();this.addSubPanel(a,$E("arrowAddArticle"),-81,0);$E("arrowAddArticle").onclick=function(){v7sendLog("40_01_13_"+($UID?$UID:""))};$E("arrowAddArticle").parentNode.children[0].onclick=function(){v7sendLog("40_01_12_"+($UID?$UID:""))}},showPublishWare:function(c){if(c.tbh_status&&parseInt(c.tbh_status,10)){$E("tray_tbh_ware_linedot").style.display="";var a=$E("tray_tbh_ware_link");a.style.display="";try{var b=$T(a,"a")[0];if(scope&&"editor"==scope.$pageid){b.href="javascript:;";b.target="";b.onclick=function(){var g=$E("shortcut_content");var j=$T(g,"img");for(var f=0;f<j.length;f++){if(-1!=j[f].src.indexOf("element_shop")){Core.Events.click(j[f])}}}}b=null;a=null}catch(d){}}Lib.Listener.off({name:"tray-data-loaded",callBack:this.showPublishWare,scope:this})},initSearchPanel:function(){var b=new scope.SearchPanel();this.addSubPanel(b,$E("searchSelect"),-54,-4);Utils.Form.limitMaxLen($E("loginBarSearchInput"),50);var d=b.getNodes();var a;for(a in b.config){(function(g){Core.Events.addEvent(d[g],function(){f(g)},"click")})(a)}f("blog");$E("searchSelect").onclick=function(){v7sendLog("40_01_18")};var c=Core.Dom.getElementsByClass($E("loginBarSearchForm"),"input","topbar_searchBtn")[0];c.onclick=function(){v7sendLog("40_01_20")};Core.Events.addEvent($E("loginBarSearchInput"),function(g){var i=g.keyCode||g.charCode;if(i==15){v7sendLog("40_01_20")}},"keyup");function f(l){var k=$E("loginBarSearchForm");k.action=b.config[l]["url"];$E("loginBarSearchMenuLabel").innerHTML=d[l].getElementsByTagName("a")[0].innerHTML;var i=$E("loginBarSearchC"),o=$E("loginBarSearchT"),g=$E("loginBarSearchType"),j=$E("loginBarSearchS"),n=$E("loginBarSearchTS"),m=$E("loginBarSearchInput");switch(l){case"all":case"blog":case"bauthor":if(!i){i=$C("input");i.type="hidden";i.name="c";i.id="loginBarSearchC";k.appendChild(i)}i.value="blog";o.value=b.config[l]["range"];o.name="range";g.value=b.config[l]["by"];g.name="by";m.name=b.config[l]["keyName"];break;case"song":case"video":case"vauthor":i&&(i.value="");o.value=b.config[l]["t"];o.name="t";j.value=b.config[l]["s"];n.value=b.config[l]["ts"];g.value=b.config[l]["type"];g.name="type";$E("loginBarSearchSType").value=b.config[l]["stype"];m.name=b.config[l]["keyName"];break}}},hideActiLink:function(b){var a=scope.$pageid;if("pageSetM"!==a&&"editor"!==a){b.style.display="none";b.setAttribute("shouldShow","1")}setTimeout(function(){if((typeof BLOG_AD_TIPS=="undefined")||!BLOG_AD_TIPS){b.style.display="";return}},3000)},initActivityPanel:function(){if($_GLOBAL){var a=$E("loginBarActivity");if(a){this.hideActiLink(a);this._loadPopularizeData(a)}}if($_GLOBAL.activityBlackList&&$_GLOBAL.activityBlackList[scope.$pageid]){trace("【活动】当前页面在黑名单");return}},initMsnLogout:function(){var d=$E("openedBlogTray");var b=d.getElementsByTagName("a");var f=b[b.length-1];f.href="#";f.onclick=function(){return false};var i=$E("noOpenedBlogTray");var g=i.getElementsByTagName("a");var a=g[g.length-1];a.href="#";a.onclick=function(){return false};var j=encodeURIComponent(window.location.href);if(d){Core.Events.addEvent(f,c)}if(i){Core.Events.addEvent(a,c)}function c(){new Interface("http://control.blog.sina.com.cn/blog_rebuild/msn/api/msnLoginOut.php","jsload").request({onSuccess:function(k){window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+j},onError:function(k){window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+j},onFail:function(k){window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+j}})}},addSubPanel:function(a,d,c,b){var g=this;this.subPanels.push(a);function f(){Core.Events.stopEvent();var k,j=g.subPanels.length;for(k=0;k<j;k++){g.subPanels[k].hidden()}a.showWithDom(d,c,b)}Core.Events.addEvent(d,function(){if(d===$E("loginBarOptApp")){v7sendLog("40_01_01_"+$UID)}f()},"click");Core.Events.addEvent(document.body,function(){a.hidden()},"click");Core.Events.addEvent(a.entity,function(){Core.Events.stopEvent()},"mousedown");Core.Events.addEvent(window,function(){var i=Core.Dom.getLeft(d)+d.offsetWidth+c;var j=Core.Dom.getTop(d)+d.offsetHeight+b;if($IE6&&this.isFixed){i=i-document.documentElement.scrollLeft;j=j-document.documentElement.scrollTop}a.setPosition(i,j)},"resize")},initNewInboxPanel:function(){var c=new scope.NewInboxPanel();this.addSubPanel(c,$E("loginBarInbox"),-137,-9);try{if(!$E("ccnotepiaohong")){var a=$C("div");a.className="imforbox";a.style.display="none";a.id="ccnotepiaohong";$E("loginBarInbox").appendChild(a)}$E("loginBarInbox").className="link imfor"}catch(b){}c.onMessageLoad=function(d){$E("loginBarAppMenuLabel").innerHTML=d;$E("noOpenBlogName").innerHTML=Core.System.htmlFilter(d)}},initMailRemind:function(){if($E("loginBarMail")&&$E("line")){$E("loginBarMail").style.display="";$E("line").style.display=""}function a(){var c=new Interface("http://interface.blog.sina.com.cn/riaapi/profile/unreadmail.php","jsload");c.request({onSuccess:function(g){var d=parseInt(g,10);if(d>99){d="99+"}if(d!==0&&$E("mailpiaohong")){var f=$E("mailpiaohong");f.style.display="";f.innerHTML=d}else{$E("mailpiaohong").style.display="none"}},onError:function(){$E("mailpiaohong").style.display="none"}})}a();var b=setInterval(a,5*60*1000);Core.Events.addEvent($E("loginBarMail"),function(){v7sendLog("40_01_07_"+$UID);var d=$E("mailpiaohong");var c=!(d.style.display);if(c){d.style.display="none"}},"click");Core.Events.addEvent($E("mailpiaohong"),function(){var c=$E("mailpiaohong");c.style.display="none";window.open("http://mail.sina.com.cn/?s=2")},"click")},initOnceLogedEvent:function(d,c){var b,a=d.length;var f=this;for(b=0;b<a;b++){$E(d[b]).onclick=function(){switch(this.id){case"loginBarOptApp":v7sendLog("44_01_07_"+c);break;case"loginBarMail":v7sendLog("44_01_08_"+c);break;case"loginBarCenter":v7sendLog("44_01_09_"+c);break;case"loginBarFriend":v7sendLog("44_01_10_"+c);break;case"loginBarInbox":v7sendLog("44_01_11_"+c);break}if(typeof sinaSSOController!="undefined"){sinaSSOController.loginExtraQuery={}}f.trayLogin.login(function(){setTimeout(function(){window.location=window.location.toString().replace(/#.*/,"")},100)},false);return false}}},initOnceLogedTips:function(b){var c=this;var a="http://interface.blog.sina.com.cn/riaapi/profile/unread.php";Utils.Io.JsLoad.request(a,{GET:{uid:b,product:"blog"},onComplete:function(f){if(scope.$pageid=="profile_index"||scope.$pageid=="pageSetM"||scope.$pageid=="editor"){return}var g=$E("newStatusTip");if(!g){g=$C("div");g.id="newStatusTip";g.className="tb_layer_Y tb_layer_w3";g.style.width="138px";g.innerHTML=scope.onceLogedStatusTipTemplay;var d=$T($E("loginBarCenter"),"a")[0];var i=Core.Dom.getXY(d);g.style.left=(i[0]-(138/2-d.offsetWidth/2))+"px";g.style.top=(i[1]+d.offsetHeight)+"px";g.style.zIndex="510";g.style.display="none";document.body.appendChild(g)}if(f.data.unreadnotes>=1){v7sendLog("44_01_12_"+b);g.style.display="block";$E("nstUnread").style.display="block";$E("nstUnread").onclick=function(){v7sendLog("44_01_13_"+b);if(typeof sinaSSOController!="undefined"){sinaSSOController.loginExtraQuery={}}c.trayLogin.login(function(){setTimeout(function(){window.location="http://i.blog.sina.com.cn/blogprofile/profilelatestnote.php"},100)},false);return false}}else{if(f.data.nfn>=1){v7sendLog("44_01_14_"+b);g.style.display="block";$E("nstFeed").style.display="block";$E("nstFeed").onclick=function(){v7sendLog("44_01_15_"+b);if(typeof sinaSSOController!="undefined"){sinaSSOController.loginExtraQuery={}}c.trayLogin.login(function(){setTimeout(function(){window.location="http://i.blog.sina.com.cn/blogprofile/index.php?type=3&from=newstatus&com=2"},100)},false);return false}}}Core.Events.addEvent(window,function(){var j=$T($E("loginBarCenter"),"a")[0];var k=Core.Dom.getXY(j);g.style.left=(k[0]-(138/2-j.offsetWidth/2))+"px";g.style.top=(k[1]+j.offsetHeight)+"px"},"resize")},onException:function(d){}})}};$registJob("tray",function(){Lib.Listener.add("tray-data-loaded");Lib.checkAuthor();var g;var f=$E("login_bar_logo_link_350");var i="ntopbar_main"===f.parentNode.className;if(i){g=Lib.TrayPanel()}else{g=new Lib.PlatformTrayPlus()}var b=Lib.Login.info();var d=b.uid;window.$onceLog=false;var a=unescape(Utils.Cookie.getCookie("onceloggedonblog"));if(a&&d){time=a;var c=new Date().getTime();if(time&&(c>time)){$onceLog=true}}if($isLogin){g.load("login")}else{if(!i&&$onceLog){g.load("oncelogedon")}else{g.load("logout")}}window.$tray={};window.$tray.renderLogin=function(){Lib.checkAuthor();if($isLogin){g.load("login")}};window.$tray.renderLogout=function(){g.load("logout")}});if(typeof App=="undefined"){var App={}}App.navMenuFolding=function(){if(!$E("leftmenu_2")){return}var b=false;var c=["profile_notice","profile_paperlist","profile_invitelist","profile_replylist","profile_guestBookM","profile_commlist","profile_commphotolist"];for(var a=0;a<c.length;a++){if(scope.$pageid==c[a]){b=true;break}}for(var a=1;a<8;a++){if(!$E("leftmenu_"+a)){continue}Core.Events.addEvent($E("leftmenu_"+a).parentNode,function(j){Core.Events.stopEvent(j);var f=Core.Events.getEvent(j);var d=f.target||f.srcElement;while(Core.String.trim(d.className)!="centerMenu_tit"){d=d.parentNode}var g=d.parentNode;var i=Core.String.trim(g.className);if(i==="centerMenu"){g.className="centerMenu centerMenu_on"}else{g.className="centerMenu"}})}};$registJob("index",function(){App.navMenuFolding()});Core.Dom.wrap=function(c,a){var b=$C(a);Core.Dom.insertAfter(b,c);b.appendChild(c);return b};Ui.Slide=Core.Class.create();Ui.Slide.prototype={node:null,container:null,status:"show",offset:0,onSlideIn:new Function(),onSlideOut:new Function(),initialize:function(b,a){var a=a||{};this.node=$E(b);this.container=Core.Dom.wrap(this.node,"div");this.container.style.overflow="hidden";this.offset=this.node.offsetHeight;this.opacity=true;this.animation=a.animation||"strongEaseOut";this.duration=a.duration||1;this.container.style.height=this.offset+"px";this.node.style.marginTop="0px"},slideIn:function(a){a=a||{};if(this.opacity){new Ui.tween(this.node,"opacity",1,this.duration,this.animation,{})}new Ui.tween(this.container,"height",this.offset,this.duration,this.animation,a);new Ui.tween(this.node,"marginTop",0,this.duration,this.animation,{tween:function(b){}.bind2(this),end:this.onSlideIn})},slideOut:function(a){a=a||{};if(this.opacity){new Ui.tween(this.node,"opacity",0,this.duration,this.animation,{})}new Ui.tween(this.container,"height",0,this.duration,this.animation,a);new Ui.tween(this.node,"marginTop",-this.offset,this.duration,this.animation,{end:this.onSlideOut})},show:function(){if(this.opacity){}this.container.style.height=this.offset+"px";this.node.style.marginTop=0+"px"},hide:function(){if(this.opacity){}this.container.style.height=0+"px";this.node.style.marginTop=-this.offset+"px"}};if(typeof Mojie==="undefined"){Mojie={}}Mojie.slideShow=function(f,a,d,g){var b=a<d;f.style.overflow="hidden";f.style.height=a+"px";if(b){f.style.display=""}var c=new Ui.TweenStrategy(a,d,g||0.5);c.onTween=function(i){f.style.height=i+"px"};c.onEnd=b?function(){f.style.overflow="";f.style.height=""}:function(){f.style.display="none"};c.start()};Mojie.feedTypeList=function(f,c,b){var d=$E("allfeed"),a=$E("subtype");if(d){var g=Core.Dom.getXY(d)}if(a){a.style.position="absolute"}if($IE6||$IE7||(document.documentMode&&document.documentMode===7)){a.style.top=g[1]+b+"px";a.style.left=g[0]-2+"px"}else{if($IE8&&document.documentMode>7){a.style.top=g[1]+c+"px";a.style.left=g[0]+"px"}else{a.style.top=g[1]+f+"px";a.style.left=g[0]+1+"px"}}};$registJob("write",function(){var d=$E("allfeed"),b=$E("subtype"),c=$E("guanbofeedout");var g,a;var f=Utils.Cookie.getCookie("guanbofeedver"+scope.$uid);Mojie.feedTypeList(24,23,21);if(d!=null){Core.Events.addEvent(d,function(){if(b.style.display===""){return}else{Mojie.feedTypeList(24,23,21);Mojie.slideShow(b,0,190)}},"mouseover")}Core.Events.addEvent(d,function(i){Core.Events.stopEvent(i)});Core.Events.addEvent("subtype",function(){Core.Events.stopBubble();setTimeout(function(){Mojie.slideShow(b,180,0)},300)},"mousedown");Core.Events.addEvent(document.body,function(){Mojie.slideShow(b,190,0)},"mousedown")});Lib.pkg("Lib.Component");Lib.Component=Core.Class.create();Lib.Component.instances=Lib.Component.instances||{};Lib.Component.compSize={};Lib.Component.getInitCompSize=function(){if(scope.component_lists!=null){var b=scope.component_lists;for(var a in b){if(b[a].list.length>0){Core.Array.foreach(b[a].list,function(c){Lib.Component.compSize[c]=b[a].size})}}return true}else{return null}};Lib.Component.refresh=function(c,b){b=b||{};try{if(Lib.Component.instances[c]==null){if(typeof Lib.Component["Comp_"+c]=="undefined"){$registComp(c,{},"static")}Lib.Component.instances[c]=new Lib.Component["Comp_"+c](c)}}catch(a){}Debug.log("刷新组件 "+c+" ，新宽度是 "+b.width);Debug.log("组件 "+c+" 增加管理链接："+b.addManage);Lib.Component.instances[c].reload(b.width,b.addManage,b.forceRefresh)};Lib.Component.set=function(a){Debug.log("展开组件 "+a+" 的设置功能");if(Lib.Component.instances[a]==null){Lib.Component.instances[a]=new Lib.Component["Comp_"+a](a)}Lib.Component.instances[a].getUserSet()};$registComp=Lib.Component.registComp=function(c,a,b){b=(b==null)?Lib.Component.Comp:Lib.Component["Comp_"+b];b=b||Lib.Component.Comp;a.compId=c;Lib.Component["Comp_"+c]=Core.Class.define(null,b,a)};Lib.Component.renderByList=function(a){Core.Array.foreach(a,function(d){try{if($E("module_"+d)!=null){var b=Lib.Component.instances[d]||new Lib.Component["Comp_"+d](d);if(b.size!=null&&b.load!=null){b.size=Lib.Component.compSize[d];try{b.load()}catch(c){}Debug.log("组件："+d+" 初始化成功")}else{Debug.error("组件："+d+" 初始化失败，组件尺寸信息不存在")}}else{Debug.error("组件："+d+" 初始化失败，页面内缺少组件的HTML节点")}}catch(c){Debug.error(c.message||"组件："+d+" 初始化失败，请确认该组件类是否定义过")}finally{}})};Lib.Component.lazyRenderByList=function(b){var a=[];Core.Array.foreach(b,function(f){try{if($E("module_"+f)!=null){var c=Lib.Component.instances[f]||new Lib.Component["Comp_"+f](f);if(c.size!=null&&c.load!=null){c.size=Lib.Component.compSize[f];try{a.push({dom:$E("module_"+f),callback:Lib.Component.instances[f].load.bind2(Lib.Component.instances[f])})}catch(d){}Debug.log("组件："+f+" 初始化成功")}else{Debug.error("组件："+f+" 初始化失败，组件尺寸信息不存在")}}else{Debug.error("组件："+f+" 初始化失败，页面内缺少组件的HTML节点")}}catch(d){Debug.error(d.message||"组件："+f+" 初始化失败，请确认该组件类是否定义过")}finally{}});Lib.LazyLoad(a,{})};Core.Dom.removeNode=function(a){a=$E(a)||a;try{a.parentNode.removeChild(a)}catch(b){}};Lib.Component.Comp=Core.Class.create();Lib.Component.Comp.prototype={initialize:function(a){if(this.isInit==true||a==null||Lib.Component.compSize[a]==null){return}else{this.isInit=true;this.compId=a;this.size=Lib.Component.compSize[a];Lib.Component.instances[a]=this;return this}},compId:null,getContainer:function(){return $E("module_"+this.compId)},getTitle:function(){return Core.Dom.getElementsByClass($E("module_"+this.compId),"span","title")[0]},getManage:function(){var a=Core.Dom.getElementsByClass($E("module_"+this.compId),"span","edit");if(a.length!=0){return a[0]}else{Debug.error("组件添加管理链接失败，检查组件"+this.compId+"标题栏 SPAN[class=edit] 是否存在");return null}},getContent:function(){var a=Core.Dom.getElementsByClass($E("module_"+this.compId),"div","SG_connBody");if(a.length!=0){return a[0]}else{Debug.error("组件内容节点获取失败，检查组件"+this.compId+"内 DIV[class=SG_connBody] 是否存在");return null}},load:function(){trace("load compId="+this.compId);this.setContent("")},reload:function(a){this.clearContent();this.load()},setTitle:function(a){var b=this.getTitle();if(b){b.innerHTML=a||""}},setManage:function(){var a=this.getManage();if($isAdmin&&a){a.innerHTML='<span class="move"><a href="#" onclick="funcMoveUpDown.up('+this.compId+');return false;">↑</a><a href="#" onclick="funcMoveUpDown.down('+this.compId+');return false;">↓</a></span><a href="#" onclick="hiddenComponents(\''+this.compId+'\');return false;" class="CP_a_fuc">[<cite>隐藏</cite>]</a>'}},setContent:function(a){a=typeof a=="string"?a:a+"";this.getContent().innerHTML=a||""},clearContent:function(){this.getContent().innerHTML=""},remove:function(){Core.Dom.removeNode(this.getContainer());this.finalize()},finalize:function(){this.isInit=null;Lib.Component.instances[this.compId]=null}};Core.String.shorten=function(c,a,b){if(Core.String.byteLength(c)<=a){return c}if(b!=""){b=b||"..."}else{b=""}return Core.String.leftB(c,a)+b};scope.Group={};scope.Group.prov0="请选择";scope.Group.code0="0";scope.Group.prov11="东城,西城,崇文,宣武,朝阳,丰台,石景山,海淀,门头沟,房山,通州,顺义,昌平,大兴,怀柔,平谷,密云,延庆";scope.Group.code11="2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19";scope.Group.prov12="和平,河东,河西,南开,河北,红桥,东丽,西青,津南,北辰,武清,宝坻,塘沽,汉沽,大港,静海,宁河,蓟县";scope.Group.code12="2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19";scope.Group.prov13="石家庄,唐山,秦皇岛,邯郸,邢台,保定,张家口,承德,沧州,廊坊,衡水";scope.Group.code13="1,2,3,4,5,6,7,8,9,10,11";scope.Group.prov14="太原,大同,阳泉,长治,晋城,朔州,晋中,运城,忻州,临汾,吕梁";scope.Group.code14="1,2,3,4,5,6,7,8,9,10,23";scope.Group.prov15="呼和浩特,包头,乌海,赤峰,通辽,鄂尔多斯,呼伦贝尔,兴安盟,锡林郭勒盟,乌兰察布盟,巴彦淖尔盟,阿拉善盟";scope.Group.code15="1,2,3,4,5,6,7,22,25,26,28,29";scope.Group.prov21="沈阳,大连,鞍山,抚顺,本溪,丹东,锦州,营口,阜新,辽阳,盘锦,铁岭,朝阳,葫芦岛";scope.Group.code21="1,2,3,4,5,6,7,8,9,10,11,12,13,14";scope.Group.prov22="长春,吉林,四平,辽源,通化,白山,松原,白城,延边";scope.Group.code22="1,2,3,4,5,6,7,8,24";scope.Group.prov23="哈尔滨,齐齐哈尔,鸡西,鹤岗,双鸭山,大庆,伊春,佳木斯,七台河,牡丹江,黑河,绥化,大兴安岭";scope.Group.code23="1,2,3,4,5,6,7,8,9,10,11,12,27";scope.Group.prov31="黄浦,卢湾,徐汇,长宁,静安,普陀,闸北,虹口,杨浦,浦东新,宝山,闵行,嘉定,金山,松江,青浦,奉贤,南汇,崇明";scope.Group.code31="2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20";scope.Group.prov32="南京,无锡,徐州,常州,苏州,南通,连云港,淮安,盐城,扬州,镇江,泰州,宿迁";scope.Group.code32="1,2,3,4,5,6,7,8,9,10,11,12,13";scope.Group.prov33="杭州,宁波,温州,嘉兴,湖州,绍兴,金华,衢州,舟山,台州,丽水";scope.Group.code33="1,2,3,4,5,6,7,8,9,10,11";scope.Group.prov34="合肥,芜湖,蚌埠,淮南,马鞍山,淮北,铜陵,安庆,黄山,滁州,阜阳,宿州,巢湖,六安,亳州,池州,宣城";scope.Group.code34="1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18";scope.Group.prov35="福州,厦门,莆田,三明,泉州,漳州,南平,龙岩,宁德";scope.Group.code35="1,2,3,4,5,6,7,8,9";scope.Group.prov36="南昌,景德镇,萍乡,九江,新余,鹰潭,赣州,吉安,宜春,抚州,上饶";scope.Group.code36="1,2,3,4,5,6,7,8,9,10,11";scope.Group.prov37="济南,青岛,淄博,枣庄,东营,烟台,潍坊,济宁,泰安,威海,日照,莱芜,临沂,德州,聊城,滨州,菏泽";scope.Group.code37="1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17";scope.Group.prov41="郑州,开封,洛阳,平顶山,安阳,鹤壁,新乡,焦作,濮阳,许昌,漯河,三门峡,南阳,商丘,信阳,周口,驻马店";scope.Group.code41="1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17";scope.Group.prov42="武汉,黄石,十堰,宜昌,襄樊,鄂州,荆门,孝感,荆州,黄冈,咸宁,随州,恩施";scope.Group.code42="1,2,3,5,6,7,8,9,10,11,12,13,28";scope.Group.prov43="长沙,株洲,湘潭,衡阳,邵阳,岳阳,常德,张家界,益阳,郴州,永州,怀化,娄底,湘西";scope.Group.code43="1,2,3,4,5,6,7,8,9,10,11,12,13,31";scope.Group.prov44="广州,韶关,深圳,珠海,汕头,佛山,江门,湛江,茂名,肇庆,惠州,梅州,汕尾,河源,阳江,清远,东莞,中山,潮州,揭阳,云浮";scope.Group.code44="1,2,3,4,5,6,7,8,9,12,13,14,15,16,17,18,19,20,51,52,53";scope.Group.prov45="南宁,柳州,桂林,梧州,北海,防城港,钦州,贵港,玉林,百色,贺州,河池";scope.Group.code45="1,2,3,4,5,6,7,8,9,10,11,12";scope.Group.prov46="海口,三亚,其他";scope.Group.code46="1,2,90";scope.Group.prov50="渝中,沙坪坝,九龙坡,大渡口,江北,渝北,北碚,南岸,巴南,万州,涪陵,黔江,长寿,万盛,双桥,永川,合川,江津,南川,綦江,潼南,荣昌,璧山,大足,铜梁,梁平,城口,垫江,武隆,丰都,奉节,开县,云阳,忠县,巫溪,巫山,石柱土家族自治县,秀山土家族苗族自治县,酉阳土家族苗族自治县,彭水苗族土家族自治县";scope.Group.code50="2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41";scope.Group.prov51="成都,自贡,攀枝花,泸州,德阳,绵阳,广元,遂宁,内江,乐山,南充,眉山,宜宾,广安,达州,雅安,巴中,资阳,阿坝,甘孜,凉山";scope.Group.code51="1,3,4,5,6,7,8,9,10,11,13,14,15,16,17,18,19,20,32,33,34";scope.Group.prov52="贵阳,六盘水,遵义,安顺,铜仁,黔西南,毕节,黔东南,黔南";scope.Group.code52="1,2,3,4,22,23,24,26,27";scope.Group.prov53="昆明,曲靖,玉溪,保山,昭通,楚雄,红河,文山,思茅,西双版纳,大理,德宏,丽江,怒江,迪庆,临沧";scope.Group.code53="1,3,4,5,6,23,25,26,27,28,29,31,32,33,34,35";scope.Group.prov54="拉萨,昌都,山南,日喀则,那曲,阿里,林芝";scope.Group.code54="1,21,22,23,24,25,26";scope.Group.prov61="西安,铜川,宝鸡,咸阳,渭南,延安,汉中,榆林,安康,商洛";scope.Group.code61="1,2,3,4,5,6,7,8,9,10";scope.Group.prov62="兰州,嘉峪关,金昌,白银,天水,武威,张掖,平凉,酒泉,庆阳,定西,陇南,临夏,甘南";scope.Group.code62="1,2,3,4,5,6,7,8,9,10,24,26,29,30";scope.Group.prov63="西宁,海东,海北,黄南,海南,果洛,玉树,海西";scope.Group.code63="1,21,22,23,25,26,27,28";scope.Group.prov64="银川,石嘴山,吴忠,固原";scope.Group.code64="1,2,3,4";scope.Group.prov65="乌鲁木齐,克拉玛依,吐鲁番,哈密,昌吉,博尔塔拉,巴音郭楞,阿克苏,克孜勒苏,喀什,和田,伊犁,塔城,阿勒泰";scope.Group.code65="1,2,21,22,23,27,28,29,30,31,32,40,42,43";scope.Group.prov71="台北,高雄,其他";scope.Group.code71="1,2,90";scope.Group.prov81="香港岛,九龙,新界";scope.Group.code81="1,2,3";scope.Group.prov82="花地玛堂区,圣安多尼堂区,大堂区,望德堂区,风顺堂区";scope.Group.code82="1,2,3,4,5";scope.Group.prov600="澳洲";scope.Group.code600="1";scope.Group.prov500="北美洲";scope.Group.code500="1";scope.Group.prov199="亚洲其他国家";scope.Group.code199="1";scope.Group.prov300="欧洲";scope.Group.code300="1";scope.Group.prov999="其他";scope.Group.code999="1";scope.Group.provinces="安徽,北京,重庆,福建,甘肃,广东,广西,贵州,海南,河北,黑龙江,河南,湖北,湖南,内蒙古,江苏,江西,吉林,辽宁,宁夏,青海,山西,山东,上海,四川,天津,西藏,新疆,云南,浙江,陕西,台湾,香港,澳门,海外";scope.Group.provcodes="34,11,50,35,62,44,45,52,46,13,23,41,42,43,15,32,36,22,21,64,63,14,37,31,51,12,54,65,53,33,61,71,81,82,1001";App.CitySelect=Core.Class.create();App.CitySelect.prototype={canton_id:"cs_canton",city_id:"cs_city",submit_id:"cs_submit",cancel_id:"cs_cancel",initialize:function(a,b){this.container=a;this.hiddenFunc=b;this.initTemplate();this.bindEvents();this.buildCanton()},bindEvents:function(){Core.Events.addEvent($E(this.cancel_id),this.hidden.bind2(this),"click");Core.Events.addEvent($E(this.submit_id),this.save.bind2(this),"click")},hidden:function(){$E(this.container).style.display="none";this.hiddenFunc()},save:function(){Lib.checkAuthor();if(!$isLogin){new Lib.Login.Ui().login(this.save.bind2(this),true);return}var b=$E(this.canton_id);var f=$E(this.city_id);var g=b.value;var a=b.childNodes;for(var d=0;a[d];d++){if(a[d]&&a[d].value&&a[d].value==g){a=a[d].innerHTML;break}}var k=f.value;var j=f.childNodes;for(var d=0;j[d];d++){if(j[d]&&j[d].value&&j[d].value==k){j=j[d].innerHTML;break}}if(g=="0"){return}if(k=="0"){return}var c='{"place1":'+g+',"place2":'+k+"}";if(!this._saveInterface){this._saveInterface=new Interface("http://control.blog.sina.com.cn/riaapi/profile/edit_currentCity.php","jsload")}this._saveInterface.request({GET:{uid:scope.$uid,data:c,rand:Math.random()},onSuccess:function(m){this.hidden();$E("wt_city_change").style.display="none";$E("cs_canton").value="0";$E("cs_city").value="0";scope.weacher.setIsLoadOne(false);var l=$E("wt_city_show");l.innerHTML=['<div style="padding:30px 0 0 30px; height:200px">','<img src="http://simg.sinajs.cn/blog7style/images/common/loading.gif">加载中…',"</div>"].join("");var i=$E("place").children[0];i.innerHTML=a+j;i.title=a+j;$E("weather_city").value=g+","+k;var n=$E(this.city_id);n.length=1;Lib.Component.renderByList([978])}.bind2(this),onError:function(i){showError(i.code)},onFail:function(){}})},buildCanton:function(){var c=$E(this.canton_id);var a=scope.Group.provinces.split(",");var b=scope.Group.provcodes.split(",");a.pop();b.pop();this._createOption(c,a,b);Core.Events.addEvent(c,this.huildCity.bind2(this),"change")},huildCity:function(){var f=Core.Events.getEventTarget();var b=f.value;var c,a;if(b==""||b==="0"){c=[];a=[]}else{c=scope.Group["prov"+b].split(",");a=scope.Group["code"+b].split(",")}c.unshift("请选择城市");a.unshift("0");var d=$E(this.city_id);d.innerHTML="";if(b!=""){this._createOption(d,c,a)}},_createOption:function(b,j,c){var f="",a=j.length;for(var d=0;d<a;d++){var g=$C("option");g.value=c[d];g.title=j[d];g.alt=j[d];g.innerHTML=Core.String.shorten(j[d],10);b.appendChild(g)}},initTemplate:function(){html='<p><select id="'+this.canton_id+'" style="margin-right:5px;"><option value="0">请选择地区</option></select><select id="'+this.city_id+'"><option value="0">请选择城市</option></select></p><p><a class="SG_aBtn SG_aBtnB" href="#" id="'+this.submit_id+'" onclick="return false"><cite>更改</cite></a><a class="SG_aBtn SG_aBtnB" href="#" id="'+this.cancel_id+'" onclick="return false"><cite>取消</cite></a></p>';$E(this.container).innerHTML=html}};App.Weacher=Core.Class.create();App.Weacher.prototype={initialize:function(a,b){this.container=a;this.initTemplate();this.initDetailTemplate();this.bindEvent();var c},get:function(a){trace("get_citys:"+a);this.citysCode=a;this.citysName=this.getCity();trace("citysName:"+this.citysName);if(this.citysName[0]=="北京"&&this.citysName[1]=="朝阳"){this.citysName[1]="北京"}this.loadDate(this.citysName[1])},loadDate:function(a){Utils.Io.JsLoad.request("http://php.weather.sina.com.cn/iframe/index/w_cl.php",{GET:{city:a,day:"1",code:"js",charset:"utf-8",cbf:"scope.weacher.render"}})},getCity:function(){if(!this.allCityCodes){this.allCityCodes=scope.Group.provcodes.split(",");this.allCityNames=scope.Group.provinces.split(",")}var b=[];var a=this.allCityCodes.length;for(var f=0;f<a;f++){if(this.citysCode[0]==this.allCityCodes[f]){switch(this.allCityNames[f]){case"天津":case"北京":case"上海":case"香港":case"澳门":case"重庆":b.push(this.allCityNames[f]);break;default:b.push(scope.Group["prov"+this.allCityCodes[f]].split(",")[0]);break}var g=scope.Group["code"+this.allCityCodes[f]].split(",");for(var d=0;d<g.length;d++){if(this.citysCode[1]==g[d]){var c=scope.Group["prov"+this.allCityCodes[f]].split(",")[d];b.push(c);trace("names:"+b);return b}}}}return false},initTemplate:function(){var a='<div class="weather_l" style="cursor:pointer;">		               	<span class="ico_wd"></span>		               	<p class="temper">#{t1}</p>						<p class="temper_num">#{t1}</p>	               </div>';this._temp=new Ui.Template(a)},initDetailTemplate:function(){var a='<div class="tempbox" style = "display:none;">		               	<span></span>		               	<span class="tempnum">#{t1}℃~#{t2}℃</span>						<p class="wind">#{d1}<br/>#{s1}</p>	               </div>';this._tpl=new Ui.Template(a)},render:function(j){var k=j.w;var c;for(var a in k){trace("result:"+a);c=a}var b=k[c];if(b){var g={f1:b[0].f1,f2:b[0].f2,t1:b[0].t1!=""?b[0].t1:b[0].t2,t2:b[0].t2,s1:b[0].s1!=""?b[0].s1:b[0].s2,s2:b[0].s2,d1:b[0].d1!=""?b[0].d1:b[0].d2,d2:b[0].d2};if(b[0].s1!=b[0].s2){g.s1=b[0].s1+"转"+b[0].s2}var l=$E("detailTem");if(b[0].f1){l.className="ico_temp "+b[0].f1+"_0"}else{l.className="ico_temp "+b[0].f2+"_0"}$E(this.container).innerHTML=this._temp.evaluate(g);$E("detailTem").innerHTML=this._tpl.evaluate(g);if(!this.isLoadOne){$E("detailTem").children[0].children[0].innerHTML=c}else{var d=scope.Group.provcodes.split(",");var m=scope.Group.provinces.split(",");for(var f=0;d[f];f++){if(d[f]==this.citysCode[0]){$E("detailTem").children[0].children[0].innerHTML=m[f];break}}}gotoCity=c;$E("wt_city_change").style.display=""}else{if(!this.isLoadOne){this.loadDate(this.citysName[0]);this.isLoadOne=true}}},bindEvent:function(){Core.Events.addEvent($E("goto"),function(){$E("detailTem").children[0].style.display=""},"mouseover");Core.Events.addEvent($E("goto"),function(){$E("detailTem").children[0].style.display="none"},"mouseout");Core.Events.addEvent($E("goto"),function(){Core.Events.stopEvent();if(!this.isLoadOne){window.open("http://php.weather.sina.com.cn/search.php?c=1&city="+encodeURIComponent(gotoCity)+"&dpc=1")}})},setIsLoadOne:function(a){this.isLoadOne=a}};$registComp(978,{change_city_id:"wt_city_change",weather_con_id:"wt_city_show",city_select_id:"wt_city_select",change_select_btn:"place",city_value_id:"weather_city",viewType:"select",load:function(){var a=$E(this.city_value_id).value.split(",");if(this.checkCitys(a)){this.showDate();this.showView();this.createWeacher();scope.weacher.get(a)}else{this.selectView();this.createCitySelect()}this.bindBtn()},showDate:function(){var f=$E("timeDate");f.style.cursor="pointer";var d=f.children[0],g=f.children[1];var b=new Date();var c=["一","二","三","四","五","六","日"];d.innerHTML=(b.getMonth()+1)+"月"+b.getDate()+"日";var a=parseInt(b.getDay());a=a===0?a=6:a=a-1;g.innerHTML="星期"+c[a]},checkCitys:function(c){var a=c.length;for(var b=0;b<a;b++){if(c[b]){return true}}return false},showView:function(){$E(this.city_select_id).style.display="none";$E(this.change_city_id).style.display="";$E(this.change_city_id).parentNode.style.display="";$E(this.weather_con_id).style.display="";this.viewType="show"},selectView:function(){$E(this.city_select_id).style.display="";this.viewType="select"},createCitySelect:function(){if(!this.citySelect){this.citySelect=new App.CitySelect(this.city_select_id,this.showView.bind2(this))}},createWeacher:function(){if(!scope.weacher){scope.weacher=new App.Weacher(this.weather_con_id)}},showSelect:function(a){Core.Events.stopEvent();this.createCitySelect();this.selectView()},bindBtn:function(){Core.Events.addEvent($E(this.change_city_id),this.showSelect.bind2(this),"click")}});$registJob("render_push",function(){Lib.Component.compSize={"978":210};Lib.Component.renderByList([978])});Core.Dom.up=function(a,c){var b=$E(a);while(b.parentNode){if(new RegExp("\\b"+c+"\\b").test(b.className)){return b}b=b.parentNode}};$SYSMSG.extend({A00001:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4006900000。",A00002:"很抱歉，您的IP出现异常，请稍后再试",A00003:"无权限进行此操作，请重新登录。",A00004:"无权限进行此操作，请重新登录。",A00005:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4006900000。",A00006:"操作成功",A00007:"无权限进行此操作，请重新登录。",A00009:"网络繁忙，请稍后再试",A00010:"无升级权限",A11007:"你还未开通新浪博客，请先<a href='http://login.sina.com.cn/hd/reg_sec.php?entry=blog'> 开通博客</a>",A00800:"对不起，您短时间点击喜欢过多，请多休息，注意身体！感谢您对新浪博客的支持和关注！"});$SYSMSG.extend({A80001:"暂无内容。",A80002:"暂无内容。",A80101:"组件加载失败，请刷新。",A80201:"你要删除留下的访问记录吗？",A80202:'<div class="CP_w_cnt SG_txtb">删除后一小时内不会在此留下访问记录。</div>',A80203:"确实要删除此访问记录吗？",A80204:['<ul class="CP_w_part SG_txtb"><li><input type="checkbox" id="comp_12_deleteToBlack" class="CP_w_fm1" /><label for="comp_12_deleteToBlack" >将此人加入黑名单</label></li></ul><div class="CP_w_cnt SG_txtb">加入黑名单的用户无法和你沟通。</div>'].join(""),A02003:"已添加过此模块，不能重复添加。",A02004:"抱歉，该模块不能被克隆。",A02005:"抱歉，您的博客尚未升级，请<a href='http://blog.sina.com.cn/u/#UID' target='_blank'>升级</a>后再“添加到您的博客”。",A02006:"模块已成功添加到你的博客。",A02007:"确实要隐藏此模块吗？隐藏后可在“页面设置”中恢复。",A02008:"确实要隐藏此模块吗？此模块活动时间已结束，隐藏后不可恢复。"});function showError(a,b){var c=$SYSMSG[a]||a;winDialog.alert(c,{icon:b||"01"})}$SYSMSG.extend({A11102:"已添加过此模块，不能重复添加。",A11103:"抱歉，您的组件已经太多。",A11104:"抱歉！你不是博客7.0用户，不能添加此组件。",A11007:'你还未开通新浪博客，请先 <a href="http://login.sina.com.cn/hd/reg_sec.php?entry=blog">开通博客</a>'});Lib.Component.clone=function(c,a){if(c==null||isNaN(c)){Debug.log("请提供被克隆组件的有效ID，当前是："+c);return}a=a.toString().replace(/0$/,"");var b=function(){Debug.log("start to clone "+c);if(!$isLogin){Lib.checkAuthor();$tray.renderLogin()}var d=new Interface("http://control.blog.sina.com.cn/riaapi/conf/module_clone.php","jsload");var f={productid:"0x00000001",suid:$UID,uid:scope.$uid,moduleid:c,cwidth:a,version:7,feed:1};d.request({GET:f,onSuccess:function(g){winDialog.alert($SYSMSG.A02006,{icon:"03",funcOk:function(){window.open("http://blog.sina.com.cn/u/"+$UID,"_blank","")}})},onError:function(g){switch(g.code){case"A00003":winDialog.confirm($SYSMSG.A02005.replace("#UID",$UID),{funcOk:function(){window.open("http://blog.sina.com.cn/u/"+$UID,"_blank","")},textOk:"升级",textCancel:"关闭",icon:"03"});break;case"A11007":winDialog.confirm($SYSMSG.A11007.replace("#{linkNewBlog}","http://blog.sina.com.cn/u/"+$UID),{funcOk:function(){window.open("http://login.sina.com.cn/hd/reg_sec.php?entry=blog","_blank","")},textOk:"开通",textCancel:"关闭",icon:"01"});break;default:showError(g.code);break}},onFail:function(){showError($SYSMSG.A00001)}})};Lib.checkAuthor();if(!$isLogin){new Lib.Login.Ui().login(Core.Function.bind3(b,null,[c]))}else{b(c)}};$CloneComp=function(a){Lib.Component.clone(a,210)};$registJob("Comp_clone",function(){var a=Core.Dom.getElementsByClass(document.body,"a","SG_comClone");if(a.length>0){Core.Array.foreach(a,function(b){var f=Core.Dom.up(b,"SG_conn");if(f!=null){var d=f.id.replace("module_","");var c=f.parentNode.className.substr(7,2);Core.Events.addEvent(b,Core.Function.bind3(Lib.Component.clone,null,[d,c]))}})}});$TEMPLATECLONE_MSG={A00001:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4006900000。",A00002:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4006900000。",A00003:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4006900000。",A00004:"未登录",A00005:"抱歉，你暂时不能复制该模板",A00006:"操作成功",A11007:'你还未开通新浪博客，请先 <a href="http://login.sina.com.cn/hd/reg_sec.php?entry=blog"  id="cloneTemplateButNoReg">开通博客</a>'};Lib.TemplateClone=Core.Class.create();Lib.TemplateClone.prototype={type:"1",version:"7",interfaceClone:null,btnClone:null,initialize:function(a,b){var c=this;this.interfaceClone=new Interface("http://control.blog.sina.com.cn/riaapi/conf/template_clone.php","jsload");this.btnClone=a;if(this.btnClone){Core.Events.addEvent(this.btnClone,function(){c.clone(b)},"click")}},clone:function(f,c){var g=this;var a="<a style='color:red' href='http://finance.sina.com.cn/333/2010-02-05/guest920.shtml' target='_blank'>315十大行业满意度调查</a>";var b=c?a:"";Lib.checkAuthor();if($isLogin){winDialog.confirm("确定使用此模板吗?",{subText:b,funcOk:function(){scope.blogOpener.showDialog(function(){g.request(f)})}})}else{var d=new Lib.Login.Ui();d.login(function(){winDialog.confirm("确定使用此模板吗?",{subText:b,funcOk:function(){scope.blogOpener.showDialog(function(){g.request(f)})},funcCancel:function(){location.reload()}})})}},request:function(a){var b=this;this.interfaceClone.request({GET:{uid_cloned:scope.$uid,type:b.type,version:b.version},onSuccess:function(c){if(a){a()}},onError:function(c){if(c.code=="A11007"){Lib.checkAuthor();var d=winDialog.alert($TEMPLATECLONE_MSG[c.code].replace(/#\{linkNewBlog\}/g,"http://control.blog.sina.com.cn/reg/reg_blog.php?version=7"),{icon:"01"});$E("cloneTemplateButNoReg").onclick=function(){d.hidden().destroy()}}else{winDialog.alert($TEMPLATECLONE_MSG[c.code],{icon:"02"})}},onFail:function(){}})}};Lib.insertMoban=function(){if(scope.tpl&&scope.tpl!=""&&(scope.tpl.split("_")[0]=="13"||$_GLOBAL.flashtemplate[scope.tpl])){Lib.insertMobanFunc(scope.tpl)}};Lib.insertMobanFunc=function(g){var d=$E("headflash");if(d){d.innerHTML="";d.style.display="";var c="http://simg.sinajs.cn/blog7newtpl/css/"+g.split("_")[0]+"/"+g+"/top.swf";var f=950,b=266;if($_GLOBAL.flashtemplate[g].width){f=$_GLOBAL.flashtemplate[g].width}if($_GLOBAL.flashtemplate[g].height){b=$_GLOBAL.flashtemplate[g].height}trace("flash height="+b);var a=Utils.Flash.swfView.Add(c,"headflash","headflash_f",f,b,"9.0.0.0","#000",{},{allowScriptAccess:"false",wmode:"transparent",allowFullScreen:"false"})}};Lib.tplFuncArr={};Lib.tplFuncCount=0;Lib.getTplNum=function(l){Lib.tplFuncArr[Lib.tplFuncCount++]=l||function(){};if($isAdmin&&scope.tpl&&scope.tpl!=""){for(var a in Lib.tplFuncArr){Lib.tplFuncArr[a]();Lib.tplFuncArr[a]=null;delete Lib.tplFuncArr[a]}return}else{if($IE){var f=document.styleSheets;var j=/\S*(blog7tpl([^t]*))\S*/gi;var b=/\S*(blog7newtpl\/css([^t]*))\S*/gim;for(var d=0;d<f.length;d++){if(f[d].id=="uid_link_css"){var c=j.exec(f[d].cssText);var g=b.exec(f[d].cssText);if(c!=null||g!=null){if(c!=null){scope.tpl=c[2].split("/")[2]}else{if(g!=null){scope.tpl=g[2].split("/")[2]}}}break}}for(var a in Lib.tplFuncArr){Lib.tplFuncArr[a]();Lib.tplFuncArr[a]=null;delete Lib.tplFuncArr[a]}}else{if(!$IE&&scope.$PRODUCT_NAME=="blog7"){for(var a in Lib.tplFuncArr){Lib.tplFuncArr[a]();Lib.tplFuncArr[a]=null;delete Lib.tplFuncArr[a]}return;Utils.Io.Ajax.request("http://blog.sina.com.cn/s/"+scope.$uid+".css?",{onComplete:function(q){q=q.replace("\n","");var p=/\S*(blog7tpl([^t]*))\S*/gim;var m=/\S*(blog7newtpl\/css([^t]*))\S*/gim;var n=p.exec(q);var o=m.exec(q);if(n!=null||o!=null){if(n!=null){scope.tpl=n[2].split("/")[2]}else{if(o!=null){scope.tpl=o[2].split("/")[2]}}}for(var i in Lib.tplFuncArr){Lib.tplFuncArr[i]();Lib.tplFuncArr[i]=null;delete Lib.tplFuncArr[i]}}.bind2(this),returnType:"txt"})}else{if(!$IE&&scope.$PRODUCT_NANM!="blog7"){Utils.Io.JsLoad.request("http://blog.sina.com.cn/s/"+scope.$uid+".js",{GET:{tm:new Date().getTime()},onComplete:function(){for(var i in Lib.tplFuncArr){Lib.tplFuncArr[i]();Lib.tplFuncArr[i]=null;delete Lib.tplFuncArr[i]}}.bind2(this)})}}}}};$registJob("insertDynaMoban",function(){Lib.getTplNum(function(){Lib.insertMoban()})});$registJob("templateClone",function(){Lib.checkAuthor();if($isAdmin){trace("博主。不执行代码");return}Lib.getTplNum(function(){var a=function(){function f(i){var j=new Ui.Template($_GLOBAL.cloneTemplateConfig[scope.tpl].count_text);var k={};k.template_pv=i;$E("template_clone_link").innerHTML=j.evaluate(k)}if(scope.tpl){var b;var c=$_GLOBAL.cloneTemplateConfig[scope.tpl];if(c&&c.template_clone_pic.replace(/\s/g,"")!=""){$E("template_clone_pic").innerHTML=c.template_clone_pic;$E("template_clone_link").innerHTML=c.template_clone_link;$E("template_clone_other").innerHTML=c.template_clone_other;if(scope.tpl=="8_52"){$E("template_clone_pic").parentNode.parentNode.style.top="0px";if(window.screen.width<1280){$E("template_clone_pic").parentNode.parentNode.style.right="88px"}$E("template_clone_pic").parentNode.parentNode.style.zIndex=201}if(c.count_id){Utils.Io.JsLoad.request("http://hits.blog.sina.com.cn/hits?act=3&uid="+c.count_id+"&varname=templatecc",{onComplete:function(){if(typeof templatecc!="undefined"){f(templatecc.pv)}else{$E("template_clone_link").style.display="none"}}})}b=new Lib.TemplateClone($E("template_clone_pic"),function(){winDialog.alert("克隆模板成功!",{icon:"03",funcOk:function(){Lib.checkAuthor();window.location.href="http://blog.sina.com.cn/u/"+$UID}})})}var d=$_GLOBAL.GUANWANG[scope.tpl];if(d&&d.template_clone_pic.replace(/\s/g,"")!=""){$E("template_clone_pic").innerHTML=d.template_clone_pic;$E("template_clone_other").innerHTML=d.template_clone_other;if($E("template_clone_pic")){if($E("template_clone_pic").parentNode.tagName.toLowerCase()=="a"){$E("template_clone_pic").parentNode.href=d.template_clone_link;$E("template_clone_pic").parentNode.target="_blank"}}}var g=$_GLOBAL.famous_conf[scope.tpl];if(g&&g.template_clone_pic.replace(/\s/g,"")!=""){$E("template_clone_pic").innerHTML=g.template_clone_pic;$E("template_clone_link").innerHTML=g.template_clone_link;$E("template_clone_other").innerHTML=g.template_clone_other;if($E("template_clone_pic")){if($E("template_clone_pic").parentNode.tagName.toLowerCase()=="a"){$E("template_clone_pic").parentNode.href="http://ba.sass.sina.com.cn/front/tp/deliver?blogId="+scope.$uid+"&tp="+scope.tpl}}}}};if($_GLOBAL.cloneTemplateConfig){a()}else{Utils.Io.JsLoad.request("http://sjs.sinajs.cn/blog7common/conf/tmp_clone.js",{onComplete:function(){a()},noreturn:true,isRemove:false})}})});Lib.Tip=Core.Class.create();Lib.Tip.prototype={initialize:function(){}};$registJob("modify_tip",function(){scope.tip=new Lib.Tip($E("sinablogb"))});$registJob("moduleBind",function(){var b=$E("module_109_link");var a=$E("module_109_img");if(b){b.onclick=function(){$CloneComp(109);Utils.Io.JsLoad.request("http://sina.allyes.com/main/adfclick?db=sina&bid=181511,226697,231717&cid=0,0,0&sid=220693&advid=3406&camid=32667&show=ignore",{onComplete:function(){}})}}if(a){a.onclick=function(){$CloneComp(109);Utils.Io.JsLoad.request("http://sina.allyes.com/main/adfclick?db=sina&bid=181511,226697,231717&cid=0,0,0&sid=220693&advid=3406&camid=32667&show=ignore",{onComplete:function(){}})}}});Lib.deleteVisitByUid=function(d,g,c,b){Lib.checkAuthor();if(!$isLogin){var f=new Lib.Login.Ui();f.login(Core.Function.bind3(Lib.deleteWallByMsgid,null,arguments));return}Debug.log("删除访客："+d);var a="";if($isAdmin){a=$SYSMSG.A80203}else{if($isLogin){a=$SYSMSG.A80201}else{return true}}winDialog.confirm(a,{funcOk:function(){var i=new Interface("http://footprint.cws.api.sina.com.cn/del.php","jsload");var j={pid:g,uid:scope.$uid,deleteuid:d};if(b!=null){j.subid=b}if($E("comp_12_deleteToBlack")&&$E("comp_12_deleteToBlack").checked==true){j.inblack=1}i.request({GET:j,onSuccess:function(){if(c){c(null,null,true)}else{Debug.log("Reload page");window.location.reload()}}})},subText:$isAdmin?$SYSMSG.A80204:$SYSMSG.A80202,textOk:"是",textCancel:"否",icon:"04"})};$ATTENTION_MSG={A00001:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4006900000。",A00002:"参数错误",A00003:"非法操作",A00004:"无权限进行此操作，请重新登录。",A00005:"输入敏感信息",A00006:"操作成功",A33005:"你不能添加自己为关注！",A33001:"对方已经被你加为关注了！<br/>请不要重复添加。",A33002:"对方拒绝了你的关注请求！",A33003:"关注已达上限300，不能再添加新的关注了！<br/>可以到<a target='_blank' href='#{url}'>我关注的人</a>去取消关注一些人，再回来关注吧。",A33004:"关注成功!",A33008:"取消关注失败<br/>请重试！",A33009:"加黑名单失败<br/>请重试！"};Core.Dom.next=function(d,b){var c=$E(d);var a=c.nextSibling;if(!a){return null}else{if(a.nodeType!=1){return Core.Dom.next(a,b)}else{if(a.nodeType==8){a.parentNode.removeChild(a);return Core.Dom.next(c,b)}}}if(new RegExp("\\b"+b+"\\b").test(a.className)){return a}else{return Core.Dom.next(a,b)}};App.popFeedRecomm_toggleEx=function(j,g){var k=$E("popFeedRecomm_feedsBox");var b=$E("popFeedRecomm_moreFeeds");if(!k){return}var c=Core.Dom.next(b,"SG_page");var m=Core.Dom.byClz(k,"div","feedList_cell");var d=Math.ceil(m.length/g);if(App.curBatch>d){App.curBatch=1}var a=g*(App.curBatch-1);var f;if(j.getAttribute("evolved")=="yes"){c.style.display="none";for(f=1;f<g;f++){if(m[a+f]){m[a+f].parentNode.style.display="none"}}j.setAttribute("evolved","no");j.className="center_cmdfeedarrow";j.setAttribute("title","展开");l("attentionfeed")}else{c.style.display="";for(f=1;f<g;f++){if(m[a+f]){m[a+f].parentNode.style.display=""}}j.setAttribute("evolved","yes");j.className="center_cmdfeedarrow center_cmdfeedarrowUp";j.setAttribute("title","收起")}function l(i){var n=window.location.href;n=n.replace(/#.*/,"");if(i.indexOf("#")>-1){n+=i}else{n+="#"+i}window.location.href=n}};App.resetCurBatch=function(){App.curBatch=1;App.nextBatch=2};App.curBatch=1;App.nextBatch=2;App.popFeedRecomm_otherRecomm=function(b){Lib.checkAuthor();if(!$isAdmin){new Lib.Login.Ui().login(function(){location.reload()});return}var c=$E("popFeedRecomm_feedsBox");a(c.parentNode,d);function d(){var j=Core.Dom.byClz(c,"div","feedList_cell");var g=j.length;var n=Math.ceil(g/b);var l;if(g<b){return}if(App.curBatch>n){App.curBatch=1}if(App.nextBatch>n){App.nextBatch=1}for(l=0;l<b;l++){var k=b*(App.curBatch-1)+l;var m=b*(App.nextBatch-1)+l;if(j[m]){j[m].style.display=""}if(j[k]){j[k].style.display="none"}}App.curBatch++;App.nextBatch++}function f(g){var i=window.location.href;i=i.replace(/#.*/,"");if(g.indexOf("#")>-1){i+=g}else{i+="#"+g}window.location.href=i}function a(g,k){var i=g.getBoundingClientRect().top;var j=document.documentElement.scrollTop;var l;l=new Ui.TweenStrategy(document.documentElement.scrollTop,j+i,0.6,Ui.Transition.strongEaseInOut);l.onTween=function(m){document.documentElement.scrollTop=m};l.onEnd=k||function(){};l.start()}};(function(){var d=$E("popFeedRecomm_expend");var c=$E("popFeedRecomm_feedsBox_parent");var f=Utils.Cookie.getCookie("noNeedFeedRecomm");if(f!="yes"){trace("is Need");if(c){c.style.display=""}}else{trace("no Need");if(c){c.style.display="none"}}if(!d){return}var a=Core.Dom.byClz(d,"div","feedList_cell");var b;for(b=0;b<a.length;b++){if(b==0){a[b].style.cssText="position:absolute;"}else{a[b].style.cssText="position:absolute; top:70px;"}}})();App.popFeedRecomm_close=function(a){winDialog.confirm("确认关闭名博动态推荐？",{subText:"<span style='color:#999;'>关闭后一周内将不再显示</span>",funcOk:function(){var b=$E(a);if(b){b.style.display="none"}Utils.Cookie.setCookie("noNeedFeedRecomm","yes",168,"/",".sina.com.cn")}})};App.isTween=false;App.popFeedRecomm_slideDown=function(){if(App.isTween){trace("isTween...");return false}App.isTween=true;var f=$E("popFeedRecomm_expend");var a=Core.Dom.byClz(f,"div","feedList_cell");var d=a[0].offsetHeight;var g=a[0];var c=a[1];var b=parseInt(Core.Dom.getStyle(g,"top"));if(isNaN(b)){g.style.top="0px"}Ui.tween(g,"top",-d,0.4,"regularEaseIn",{end:function(){g.style.top=d+"px";f.appendChild(g);App.isTween=false}});Ui.tween(c,"top",parseInt(Core.Dom.getStyle(c,"top"))-d,0.4,"regularEaseIn",{end:function(){}})};scope.Attention=Core.Class.create();scope.Attention.prototype={interfaceAddURL:"http://control.blog.sina.com.cn/riaapi/profile/attention_add.php",interfaceCancel:null,interfaceRemove:null,initialize:function(){this.interfaceCancel=new Interface("http://control.blog.sina.com.cn/riaapi/profile/attention_del.php","jsload");this.interfaceRemove=new Interface("http://control.blog.sina.com.cn/riaapi/profile/attention_move.php","jsload")},add:function(b,c,a,d){var f=this;new Interface(this.interfaceAddURL,"ijax").request({POST:{uid:b,aid:c},onComplete:function(i){Lib.checkAuthor();if(i.code=="A33004"){if(a){winDialog.alert("关注成功！",{width:300,icon:"03"});Core.Dom.removeNode($E("attention_"+c));if(Core.String.trim($E("attention_list").innerHTML).replace(/"/g,"").toLowerCase()=="<div class=clearit></div>"){$E("attention_list").parentNode.innerHTML='<div class="SG_nodata">暂无推荐!</div>'}}else{winDialog.alert($ATTENTION_MSG[i.code],{width:300,icon:"03",subText:['<div class="CP_w_cnt SG_txtb">你将在关注动态页面接收到对方的新消息</div>','<ul class="CP_w_part CP_w_aLine">','<li><a href="javascript:void(0);" onclick="scope.pa_add.add(\''+c+'\');winDialog.getDialog(\'attention\').close();">手机订阅此用户&gt;&gt;</a><img height="15" align="absmiddle" width="15" class="SG_icon SG_icon11" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" title="新"/></li>','<li><a href="http://profile.blog.sina.com.cn/attention_feed.php?uid='+$UID+'" onclick="winDialog.getDialog(\'attention\').close();">查看关注动态&gt;&gt;</a></li>','<li><a href="http://profile.blog.sina.com.cn/attention.php?uid='+$UID+'&type=0" onclick="winDialog.getDialog(\'attention\').close();">查看我关注的人&gt;&gt;</a></li>','<li><a href="http://profile.blog.sina.com.cn/attention.php?uid='+$UID+'&type=1" onclick="winDialog.getDialog(\'attention\').close();">查看谁在关注我&gt;&gt;</a></li>',"</ul>"].join(""),funcOk:function(){if(d){d()}else{window.location=window.location.toString().replace(/#.*/,"")}}},"attention")}}else{var g=$ATTENTION_MSG[i.code];if(i["code"=="A33003"]){g=$ATTENTION_MSG[i.code].replace(/#\{url\}/g,"http://profile.blog.sina.com.cn/attention.php?type=0&uid="+$UID)}winDialog.alert(g,{funcOk:f.errorHandle,funcClose:f.errorHandle,icon:"02"})}}})},cancel:function(a,b){var c=this;this.interfaceCancel.request({GET:{uid:a,aid:b},onSuccess:function(d){window.location=window.location.toString().replace(/#.*/,"")},onError:function(d){winDialog.alert($ATTENTION_MSG[d.code],{funcOk:c.errorHandle,funcClose:c.errorHandle,icon:"02"})},onFail:function(){}})},remove:function(b,c,a){var d=this;this.interfaceRemove.request({GET:{uid:b,aid:c,isblack:a},onSuccess:function(f){window.location=window.location.toString().replace(/#.*/,"")},onError:function(f){winDialog.alert($ATTENTION_MSG[f.code],{funcOk:d.errorHandle,funcClose:d.errorHandle,icon:"02"})},onFail:function(){}})},errorHandle:function(){}};if(!App.curTab){App.curTab=0}App.popBlogRecomm_toTabs=function(i,f){var g=$E("popBlogRecomm_tabsBox");var j=$E("popBlogRecomm_pagesBox");var d=$T(g,"li");var a=$T(j,"ul");if(i==App.curTab){return}if(!$T(f,"a")[0]){return}c($T(f,"a")[0]);b($T(d[App.curTab],"a")[0]);f.className="borderc current";d[App.curTab].className="borderc";a[i].style.display="";a[App.curTab].style.display="none";App.curTab=i;function c(k){k.removeAttribute("href");k.style.textDecoration="none";k.blur()}function b(k){k.setAttribute("href","javascript:return false;");k.style.textDecoration="underline"}};App.popBlogRecomm_addAttention=function(a,b){$T(b,"a")[0].blur();new Interface("http://control.blog.sina.com.cn/riaapi/profile/attention_add.php","ijax").request({POST:{uid:scope.$uid,aid:a},onSuccess:function(d){},onError:function(g){var d="已关注";var f=$T(b,"a")[0];var i=$T(b,"cite")[0];switch(g.code){case"A33004":case"A33001":i.innerHTML=d;f.style.cssText+="; cursor:text; color:#999;";i.style.cssText+="; cursor:text !important; text-decoration:none;";b.onclick=function(){return false};break;default:winDialog.alert($ATTENTION_MSG[g.code]);break}}});function c(f){f.fontSize=f.fontSize||"12px";f.color=f.color||"#5f9b00";var i=Core.Dom.getTop(f.txtNode);var g=Core.Dom.getLeft(f.txtNode);var d=$C("p");d.innerHTML=f.text;d.style.cssText+="; position:absolute; font-size:"+f.fontSize+"; color:"+f.color+"; left:"+g+"px; top:"+i+"px;";f.txtNode.innerHTML=f.text;Core.Dom.setStyle(f.txtNode,"opacity",0);document.body.appendChild(d);Ui.tween(f.txtNode,"opacity",1,1,"regularEaseIn");Ui.tween(d,"opacity",0,1,"regularEaseIn",{end:function(){document.body.removeChild(d)}})}};App.popBlogRecomm_addAttention=function(g,d){var a="已关注";var c=$T(d,"a")[0];var f=$T(d,"cite")[0];var b=new scope.Attention();Lib.checkAuthor();if(!$isAdmin){new Lib.Login.Ui().login(function(){location.reload()});return}b.add(scope.$uid,g,false,function(){f.innerHTML=a;c.style.cssText+="; cursor:text; color:#999;";f.style.cssText+="; cursor:text !important; text-decoration:none;";d.onclick=function(){return false}})};App.popBlogRecomm_pagination=function(a,b,f,d){var c=d.split("_")[1];new Interface("http://control.blog.sina.com.cn/riaapi/feed/feed_class.php?version=7","jsload").request({GET:{"class":a,type:b,page:f,file:c},onSuccess:function(g){var i=$E(d);if(!i){return}i.innerHTML=g.html;j(d);function j(k){var l=window.location.href;l=l.replace(/#.*/,"");if(k.indexOf("#")>-1){l+=k}else{l+="#"+k}window.location.href=l}},onError:function(g){winDialog.alert($SYSMSG[g.code])}})};$registJob("dynaRecomm",function(){});if(typeof Lib.flashComponent=="undefined"){Lib.flashComponent={}}Lib.FlashDetector=function(a){this.version=a}.$define({version:"",detect:function(){var g=window.navigator,d,a,f,b="0.0.0";if(g.plugins&&g.plugins.length){for(d=0,a=g.plugins.length;d<a;d++){if(g.plugins[d].name.toLowerCase().indexOf("shockwave flash")!=-1){b=g.plugins[d].description.toLowerCase().replace(/shockwave flash\s?/,"").split(" ")[0];f=true;break}}}else{if(window.ActiveXObject){for(d=11;d>=1;d--){try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+d)){b=d+".0";f=true;break}}catch(c){}}}}if(f){this._detectVersion(b)}else{this.onUninstalled&&this.onUninstalled.call(this)}},_detectVersion:function(b){var f=this._getFormatVersion(b).split("."),d=this._getFormatVersion(this.version).split("."),c,a=d.length;for(c=0;c<a;c++){if(+f[c]>+d[c]){this.onSuccess&&this.onSuccess.call(this);return}else{if(+f[c]<+d[c]){this.onVersionLower&&this.onVersionLower.call(this,b);return}}}this.onSuccess&&this.onSuccess.call(this)},_getFormatVersion:function(a){var b=a+"";b.indexOf(".")==-1&&(b+=".0.0");b.split(".").length<3&&(b+=".0");return b},onVersionLower:function(a){},onUninstalled:function(){},onSuccess:function(){}});Lib.flashComponent.FlashContianer=function(a){this._initCfg(a);this._flashDetector=new Lib.FlashDetector(this.flashCfg.version);this._detect()}.$define({flashCfg:{url:"",width:0,height:0,containerID:"divContainer",flashID:"flashID",flashVar:"",version:"9",wmode:"transparent",allowScriptAccess:"always"},rerender:function(){this._initFlash()},_renderText:["#{reason}，为了能够正常显示，请您 ",'<a target="_blank" href="http://get.adobe.com/cn/flashplayer/">','<img src="http://simg.sinajs.cn/blog7style/images/common/baby/flash.png">',"下载最新版本","</a>","。"].join(""),_flash:null,_falshEntity:null,_flashDetector:null,_initFlash:function(){this._addFlash();this._initFlashEntity()},_detect:function(){var a=this._flashDetector,b=this;a.onSuccess=function(){b._initFlash()};a.onUninstalled=function(){b._renderUninstalled()};a.onVersionLower=function(c){b._renderVersionLower()};a.detect()},_renderVersionLower:function(){$E(this.flashCfg.containerID).innerHTML=this._renderText.replace(/\#\{reason\}/g,"您的Flash播放器版本过低")},_renderUninstalled:function(){$E(this.flashCfg.containerID).innerHTML=this._renderText.replace(/\#\{reason\}/g,"您的浏览器未安装Flash播放器")},_initCfg:function(a){var b;for(b in this.flashCfg){typeof(a[b])!="undefined"&&(this.flashCfg[b]=a[b])}},_addFlash:function(){var a=this.flashCfg,b=this;this._flash=new Utils.Flash.swfObject(a.url,a.flashID,a.width,a.height,a.version,"#ffffff");this._flash.addParam("allowScriptAccess",a.allowScriptAccess);this._flash.addParam("wmode",a.wmode);this._flash.addParam("flashVars",a.flashVar);this._flash.write(a.containerID)},_initFlashEntity:function(){this._flashEntity=$IE?window[this.flashCfg.flashID]:document[this.flashCfg.flashID]}});Lib.flashComponent.HeadPhoto=function(a){}.$extends(Lib.flashComponent.FlashContianer).$define({setMaskPosition:function(a,b){a=isNaN(a)?0:a;b=isNaN(b)?0:b;this._flashEntity.setMaskPosition&&this._flashEntity.setMaskPosition(a,b)},setPhotoURL:function(a){this._flashEntity.setPhotoURL&&this._flashEntity.setPhotoURL(a)},getPhotoURL:function(a){if(this._flashEntity.getPhotoURL){return this._flashEntity.getPhotoURL()}},setPhotoPosition:function(a,b){a=isNaN(a)?0:a;b=isNaN(b)?0:b;this._flashEntity.setPhotoPosition&&this._flashEntity.setPhotoPosition(a,b)},setPhotoZoom:function(a){a=isNaN(a)?1:a;this._flashEntity.setPhotoZoom&&this._flashEntity.setPhotoZoom(a)},setPhotoAngle:function(a){a=isNaN(a)?0:a;this._flashEntity.setPhotoAngle&&this._flashEntity.setPhotoAngle(a)}});Lib.flashComponent.HeadPhotoEditorConfig={t3_34:{middlePointX:350,middlePointY:100,maskX:108,maskY:0,maskURL:"http://simg.sinajs.cn/blog7swf/baby/mask3_34.swf",frameURL:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/frame3_34.png",defaultPhoto:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/babyPhoto.png"},t3_35:{middlePointX:200,middlePointY:100,maskX:6,maskY:0,maskURL:"http://simg.sinajs.cn/blog7swf/baby/mask3_35.swf",frameURL:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/frame3_35.png",defaultPhoto:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/babyPhoto.png"},t3_36:{middlePointX:300,middlePointY:120,maskX:131,maskY:23,maskURL:"http://simg.sinajs.cn/blog7swf/baby/mask3_36.swf",frameURL:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/frame3_36.png",defaultPhoto:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/babyPhoto.png"},t3_37:{middlePointX:230,middlePointY:100,maskX:71,maskY:0,maskURL:"http://simg.sinajs.cn/blog7swf/baby/mask3_37.swf",frameURL:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/frame3_37.png",defaultPhoto:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/babyPhoto.png"}};$registJob("baby_headPhoto",function(){var b=Lib.flashComponent.HeadPhotoEditorConfig["t"+scope.tpl]||Lib.flashComponent.HeadPhotoEditorConfig.t3_34,j=scope.UserBabyPic||{},g=$E("headflash"),c=scope.babyTpl_conf||["3_34","3_35","3_36","3_37"],f=false;for(var d=0,a=c.length;d<a;d++){if(c[d]==scope.tpl){f=true;break}}if(!g||!f){return}g.style.display="";scope.headPhoto=new Lib.flashComponent.HeadPhoto({url:$_GLOBAL.flashBasicURL+"baby/headPhoto.swf",width:540,height:285,containerID:"headflash",flashID:"flashHeadPhoto",flashVar:["maskURL=",b.maskURL,"&maskX=",b.maskX,"&maskY=",b.maskY,"&middlePointX=",b.middlePointX,"&middlePointY=",b.middlePointY,"&photoURL=",j.photoURL||b.defaultPhoto,"&photoX=",j.photoX||0,"&photoY=",j.photoY||0,"&photoZoom=",j.zoom||1,"&photoAngle=",j.angle||0].join("")})});Utils.insertTemplate=function(d,k,g){var a=[],b={},l=/#{(\w+)}/g,j="_"+(new Date().getTime().toString()).slice(-5)+Math.floor(Math.random()*100000);k=k.replace(l,function(i,m){a.push(m);return m+j});Core.Dom.insertHTML(d,k,g);for(var f=a.length,c;f--;){c=a[f];b[c]=$E(c+j)}return b};Utils.Cookie.deleteCookie=function(a){document.cookie=a+"=;expires=Fri, 31 Dec 1999 23:59:59 GMT;"};(function(){var a=function(d){var b=d.split("-");var f=b[0];for(var c=1;c<b.length;c++){f+=b[c].charAt(0).toUpperCase()+b[c].substring(1)}return f};Core.Dom.setStyle2=function(d,c){if(typeof d=="string"){d=$E(d)}for(var b in c){styleAttr=a(b);Core.Dom.setStyle(d,styleAttr,c[b])}}})();var BackShadow=function(b){this.entity=null;this.isShow=false;this._ie6Fixed=function(){if(c.entity){c.entity.style.top=document.documentElement.scrollTop+"px";c.entity.style.left=document.documentElement.scrollLeft+"px";if(c.ifm){c.ifm.style.top=c.entity.style.top;c.ifm.style.left=c.entity.style.left}c.updateSize()}};var c=this;(function a(){c.entity=$C("div");c.entity.style.position="absolute";c.entity.style.width=c.getAreaWidth()+"px";c.entity.style.height=c.getAreaHeight()+"px";c.entity.style.left="0px";c.entity.style.top="0px";c.entity.style.zIndex=1024;c.entity.style.backgroundColor="black";document.body.appendChild(c.entity);c._setOpacity(c.entity,isNaN(b)?0.5:b);if($IE6){c.entity.style.top=document.documentElement.scrollTop+"px";c.addIframe()}Core.Events.addEvent(window,function(){if(c.entity){if($IE6&&c.isShow){document.documentElement.scrollLeft=0;c._ie6Fixed()}setTimeout(function(){c.updateSize()},1)}},"resize");c.setFixed(true);c.hidden()})()};BackShadow.prototype={show:function(){this.entity.style.display="";if(this.ifm){this.ifm.style.display=""}this.isShow=true;this.onShow()},hidden:function(){this.entity.style.display="none";if(this.ifm){this.ifm.style.display="none"}this.isShow=false;this.onHidden()},close:function(){this.hidden();this.destroy()},destroy:function(){Core.Events.removeEvent(window,this._ie6Fixed,"scroll");this.entity.parentNode.removeChild(this.entity);this.entity=null;if(this.ifm){this.ifm.parentNode.removeChild(this.ifm);this.ifm=null}},addIframe:function(){this.ifm=$C("iframe");this._setOpacity(this.ifm,0);this.ifm.style.position="absolute";this.ifm.style.zIndex=this.entity.style.zIndex;this.ifm.style.left=this.entity.style.left;this.ifm.style.top=this.entity.style.top;this.ifm.style.width=this.entity.style.width;this.ifm.style.height=this.entity.style.height;document.body.insertBefore(this.ifm,this.entity)},insertBefore:function(a){document.body.insertBefore(this.entity,a);if(this.ifm){document.body.insertBefore(this.ifm,this.entity)}},updateSize:function(){this.entity.style.width=this.getAreaWidth()+"px";this.entity.style.height=this.getAreaHeight()+"px";if(this.ifm){this.ifm.style.width=this.getAreaWidth()+"px";this.ifm.style.height=this.getAreaHeight()+"px"}},getAreaHeight:function(){return document.documentElement.clientHeight},getAreaWidth:function(){return document.documentElement.clientWidth},setFixed:function(a){if($IE6){var b=this;if(a){b._ie6Fixed();Core.Events.addEvent(window,b._ie6Fixed,"scroll")}else{Core.Events.removeEvent(window,b._ie6Fixed,"scroll")}}else{this.entity.style.position=a?"fixed":"absolute"}},_setOpacity:function(b,a){if($IE&&$IE<=9){b.style.filter="alpha(opacity="+a*100+")"}else{b.style.opacity=a}},onShow:function(){},onHidden:function(){}};Core.Array.uniq=function(c){var b=[],a;for(var d=0;d<c.length;d++){a=c[d];if(Core.Array.findit(b,a)==-1){b.push(a)}}return b};$registJob("profileUserGuide",function(){var b=Utils.Cookie.getCookie,C=Utils.Cookie.setCookie,k=Core.Events.addEvent,g,H=scope.$uid,d=b("ugv2s_fzp"),o=window.location.href.indexOf("atten=1")>-1;var D=b("nickGuild");var G={startRelate:'<div class="l_guide" id="#{relateGuide}" style="z-index:20000;" ><div class="guide_nav"><ul id="labelList"><li class="label"><a href="javascript:void(0);"></a></li><li class="label"><a href="javascript:void(0);"></a></li><li class="label"><a href="javascript:void(0);"></a></li><li class="label"><a href="javascript:void(0);"></a></li><li class="label"><a href="javascript:void(0);"></a></li><li class="label"><a href="javascript:void(0);"></a></li><li class="label"><a href="javascript:void(0);"></a></li><li class="label"><a href="javascript:void(0);"></a></li><li class="label"><a href="javascript:void(0);"></a></li><li class="label"><a href="javascript:void(0);"></a></li><li class="label"><a href="javascript:void(0);"></a></li></ul></div><div class="gd_cnt"><div class="hd"><a title="关闭" class="CP_w_shut" href="javascript:void(0);" id="#{close}">关闭</a><h3 id="#{nick}"></h3><p class="wlcm">你好，欢迎来到新浪博客！告诉我们你的爱好，我们将根据你的爱好为你推荐优质博主</p></div><div class="user_lst" id="#{userList}"></div><div class="ft"><div class="select_all"><input type="checkbox" id="#{selectAll}"/><label for="">关注全部</label></div><div class="opt"><a href="#" id="#{noSelect}">不，谢谢</a><a href="#" class="btn_complete" id="#{doneRelate}">完成</a></div></div></div></div>',guildNick:'<div id="#{nickGuild}" class="guide_nctx" style="left:300px; top:20px;"><a id="#{close}" href="javascript:void(0)" class="close" title="关闭"></a><a id="#{modifyBtn}" href="javascript:;" class="btn" title="马上修改"></a></div>'};var p=setInterval(j,300);function j(){if(scope.nickname){try{t.nick.innerHTML=scope.nickname;clearInterval(p)}catch(I){}}}if((d&&d===H)||!o){if(D!="done"&&o){window.setTimeout(function(){A()},500);return}else{return}}var q={css:{"z-index":"5002",position:$IE6?"absolute":"fixed",top:"50%",left:"50%"},mid:{"z-index":"5002",position:$IE6?"absolute":"fixed",left:"50%"}};var a=screen.width,n=screen.height;if(o){c()}Utils.Io.loadExternalCSS("http://simg.sinajs.cn/blog7style/css/module/layer/layer21.css");var z,t,r,m,i,B=[],u;var v;function c(){z=new BackShadow(0.4);z.show();t=Utils.insertTemplate(document.body,G.startRelate,"BeforeEnd");t.userList.innerHTML=['<div id="loading" style="text-align:center;padding-top:200px; height:400px">','<img src="http://simg.sinajs.cn/blog7style/images/common/loading.gif">加载中…',"</div>"].join("");if(a<882||n<600){t.relateGuide.style.position="absolute";t.relateGuide.style.top="0px";t.relateGuide.style.left="0px"}else{if($IE6){Core.Events.addEvent(window,function(){t.relateGuide&&l(t.relateGuide)},"scroll")}setTimeout(function(){l(t.relateGuide)},200)}g="http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/userguide/userGuideData.php";Utils.Io.Ijax.request(g,{onComplete:function(R){var R=Core.String.j2o(R);if(R&&R.code==="A00006"){var N=Core.Dom.byClz(t.labelList,"li","label");var Q=[],I=[];for(K in R.data){Q.push(R.data[K].tag);I.push(R.data[K].tag_id)}for(var K=0;K<N.length;K++){N[K].children[0].innerHTML=Q[K];N[K].children[0].setAttribute("tag_id",I[K])}var M="";for(K in R.data){var J=K;B.push(J);var O=R.data[K].users;for(K in O){var L=O[K];if(L.resume===null){L.resume=""}M+='<div class="user_item" style="display:none;" diffuser="'+J+'"><div class="thumb"><img src="'+L.imgurl+'" width="110px" height="110px" title="'+L.nickname+'"/><span class="hvbtn addcan" userId="'+K+'">加关注</span></div><dl class="detail" id="#{detail}"><dt class="name" title="'+L.nickname+'">'+L.nickname.substring(0,5)+"</dt><dd>访问 "+L.pv+"</dd><dd>关注 "+L.attention+'</dd><dd class="outline">'+L.resume+"</dd></dl></div>"}}m=Utils.insertTemplate(t.userList,M,"AfterBegin");u=parseInt(10*Math.random());i=Core.Dom.byClz(t.userList,"div","user_item");for(var K=0;K<i.length;K++){if(i[K].getAttribute("diffuser")===B[u]){i[K].style.display="";N[u].children[0].className="cur"}}if($E("loading")){var P=$E("loading");Core.Dom.removeNode(P)}E()}else{if(R&&R.code==="A00001"){t.relateGuide.style.display="none";z.close()}else{if(R&&R.code==="A00007"){window.location.href="http://blog.sina.com.cn"}}}},returnType:"json",POST:{type:1}})}function E(){var I=Core.Dom.byClz(t.userList,"div","thumb");var K=Core.Dom.byClz(t.labelList,"li","label");k(t.doneRelate,function(){var R=Core.Dom.byClz(t.userList,"span","hvbtn addyet");if(R.length!==0){var P=[],N=[];for(var O=0;O<R.length;O++){P.push(R[O].getAttribute("userid"));N.push(R[O].parentNode.parentNode.getAttribute("diffuser"))}N=Core.Array.uniq(N);var M=P.join(",");var S=N.join(",");var Q="http://control.blog.sina.com.cn/riaapi/reg/attention_add_batch.php?"+Math.random();Utils.Io.Ijax.request(g,{POST:{type:3,tagid:S},onComplete:function(T){var T=Core.String.j2o(T);if(T&&T.code==="A00006"){Utils.Io.Ijax.request(Q,{POST:{uid:scope.$uid,aids:M},onComplete:function(U){var U=Core.String.j2o(U);var V=window.location.href;if(U&&U.code==="A00006"){t.relateGuide.style.display="none";z.close();C("ugv2s_fzp",scope.$uid,10*365*24,"/",".blog.sina.com.cn");window.location.href=V.replace(/#/g,"")}else{t.relateGuide.style.display="none";C("ugv2s_fzp",scope.$uid,10*365*24,"/",".blog.sina.com.cn");z.close();window.location.href=V.replace(/#/g,"")}},onException:function(){window.location.href=window.location.href.replace(/#/g,"")}})}}})}else{f()}});k(t.close,function(){f()});k(t.selectAll,function(){if(!t.selectAll.checked){for(var M=0;M<I.length;M++){if(I[M].parentNode.style.display===""){I[M].children[1].className="hvbtn addcan"}}}else{for(var M=0;M<I.length;M++){if(I[M].parentNode.style.display===""){I[M].children[1].className="hvbtn addyet"}}}});k(t.noSelect,function(){f()});for(var J=0;J<I.length;J++){k(I[J].children[1],function(O){var N=Core.Events.getEvent(O);var M=Core.Events.getEventTarget(N);if(M.className==="hvbtn addyet"){M.className="hvbtn addcan"}else{M.className="hvbtn addyet"}})}var L;for(var J=0;J<K.length;J++){k(K[J].children[0],function(Q){t.userList.scrollTop="0px";var P=Core.Events.getEvent(Q);var O=Core.Events.getEventTarget(P);K[u].children[0].className="";O.parentNode.parentNode.children[0].children[0].className="";if(L&&L.className==="cur"){L.className=""}O.className="cur";L=O;var N=O.getAttribute("tag_id");for(var M=0;M<B.length;M++){if(N===B[M]){for(var M=0;M<i.length;M++){i[M].style.display="none";if(i[M].getAttribute("diffuser")===N){i[M].style.display=""}}}}t.selectAll.checked=false})}}function A(){var J=Core.Dom.byClass("ntopbar_menu","div",document.body);var K=parseInt(Core.Dom.getLeft(J[0]));var I=parseInt(J[0].children[0].children[0].children[0].offsetWidth);if(!z){z=new BackShadow(0.4);z.show()}v=Utils.insertTemplate(document.body,G.guildNick,"BeforeEnd");v.nickGuild.style.left=K+I/2+"px";F()}function F(){k(v.close,function(){C("nickGuild","done",10*365*24,"/",".blog.sina.com.cn");v.nickGuild.style.display="none";z.close()});k(v.modifyBtn,function(J){var I=window.event||J;if(I.preventDefault){I.preventDefault()}else{I.returnValue=false}C("nickGuild","done",10*365*24,"/",".blog.sina.com.cn");window.location.href="http://control.blog.sina.com.cn/blogprofile/nick.php"})}function f(){Utils.Io.Ijax.request(g,{onComplete:function(I){var I=Core.String.j2o(I);if(I&&I.code==="A00006"){t.relateGuide.style.display="none";C("ugv2s_fzp",scope.$uid,10*365*24,"/",".blog.sina.com.cn");A()}},returnType:"json",POST:{type:2}})}function l(K){var I=882,J=547;K.style.marginLeft=I/2*(-1)+"px";if($IE6){K.style.top=document.documentElement.scrollTop+parseInt(Math.abs((document.documentElement.offsetHeight-J)/2),10);delete q.css.top}else{K.style.marginTop=J/2*(-1)+"px"}Core.Dom.setStyle2(K,q.css)}function y(J){var I=952;J.style.marginLeft=I/2*(-1)+"px";Core.Dom.setStyle2(J,q.mid)}});$registJob("delAttentionTags",function(){window.delAttentionTags=function(c,a){var b=a;winDialog.confirm("确定要取消此关注标签吗?",{subText:"",funcOk:function(){var d="http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/attentags/userDelTag.php";Utils.Io.Ijax.request(d,{onComplete:function(i){var i=Core.String.j2o(i);if(i&&i.code==="A00006"){if(scope.$pageid=="profile_tags"){var g=c.parentNode.tagName.toLowerCase();if(g==="p"){window.location=window.location.toString().replace(/#.*/,"")}else{var f=c.parentNode.parentNode.parentNode.parentNode;Core.Dom.removeNode(f)}}else{var f=c.parentNode.parentNode.parentNode.parentNode;Core.Dom.removeNode(f)}}else{showError(i.code)}},returnType:"json",POST:{tagid:b}})}})}});Core.Dom.findNode=function(a,c,d){for(var b=a[d];b;b=b[c]){if(b.nodeType==1){return b}}return null};Core.Dom.nextNode=function(a){return Core.Dom.findNode(a,"nextSibling","nextSibling")};Lib.templateUtils=function(){};Lib.templateUtils.prototype.getTemplateNodes=function(j){var c=document.createElement("div");var a={};var l=[];var f=(new Date().getTime().toString()).slice(-5)+Math.floor(Math.random()*100000);var k=/#{([a-z0-9_]+)}/gi;j=j.replace(k,function(m,i){l.push(i);return i+"_"+f});c.innerHTML=j;var b;var d=l.length;var g;for(b=0;b<d;b++){g=l[b];a[g]=this.findById(g+"_"+f,c)}return a};Lib.templateUtils.prototype.getIdNodes=function(n){var g,f,l,d,o,c;var b={};var a=[];var m=[];var p=[];var k=document.createElement("div");k.innerHTML=n;p=k.getElementsByTagName("*");n.replace(/id *= *"([^{ ]+?)"/ig,function(j,i){a[a.length]=i});l=p.length;for(g=0;g<l;g++){if(p[g].id){m[m.length]=p[g]}}l=a.length;for(g=0;g<l;g++){o=a[g];f=0;d=m.length;while(f<d){c=m[f];if(o==c.id){b[o]=c;m.splice(f,1)}f++}}return b};Lib.templateUtils.prototype.findById=function(g,f,b){var d;var f=f||document;var c=f.getElementsByTagName(b||"*");var a=c.length;for(d=0;d<a;d++){if(c[d].getAttribute("id")==g){return c[d]}}};Lib.templateUtils.prototype.formatTemplate=function(a,b){var a;var c=new RegExp("#{([a-z0-9]+)}","ig");a=a.replace(c,function(g,d,f,i){return b[d]});return a};(function(){Function.prototype.$defineProto=function(c){var b;for(b in c){this.prototype[b]=c[b]}if(this.__interface__){for(b in this.prototype){if(this.prototype[b]==="NI"){throw new Error("类定义错误，接口方法["+b+"]未实现")}}}this.prototype.constructor=this;this.$extendClass=this.$defineProto=this.$implements=function(){throw new Error("$defineProto 语句定义后面不能再作其它定义")};return this};Function.prototype.$extendClass=function(){var f=this;var c=arguments.length;var b;var d;if(c===0){throw new Error("$extendClass 语句错误：未指定父类")}b=arguments[0];d=function(){var i=this;this.$super={};for(var g in b.prototype){if(!b.prototype[g]){continue}this.$super[g]=(function(j){return function(){b.prototype[j].apply(i,arguments)}})(g)}b.apply(this,arguments);f.apply(this,arguments)};d.prototype=a(b.prototype);d.prototype.constructor=d;return d};Function.prototype.$implements=function(){var b=Array.prototype.slice.call(arguments,0);var f;var d=b.length;var c;while(d--){if(typeof b[d]!=="object"){throw new Error("$implements 语句错误：参数必须为 object 类型")}for(c in b[d]){typeof this.prototype[c]==="undefined"&&(this.prototype[c]="NI")}}this.__interface__=true;this.$extendClass=function(){throw new Error("$extendClass 语句错误：$extendClass 语句不能出现在 $implements 定义之后")};return this};Function.prototype.$mixProto=function(){this.$extendClass=this.$defineProto=function(){throw new Error("$mixProto 必须放在最后使用")};var d=arguments[0];var b=d.prototype;for(var c in b){if(this[c]){throw new Error("目标类有同名方法")}if(!b[c]){continue}this.prototype[c]=b[c]}return this};function a(c){function b(){}b.prototype=c;return new b()}})();var blogAd={};blogAd.getInitPermission=function(b){var a;if(b&&b.ads&&b.ads[0]){a=b&&b.ads&&b.ads[0];return a.type=="mixed"||a.ref}else{return false}};blogAd.shareToWeibo=function(b){var a=new Utils.Url("http://v.t.sina.com.cn/share/share.php"),c=encodeURIComponent;if(b.clickCode){new Image().src=b.clickCode}for(var d in b){if(b.hasOwnProperty(d)){a.setParam(d,c(b[d]))}}if(!b.title){a.setParam("title",c(b.title||document.title))}a.setParam("content","utf-8");var f=function(){a=a.toString();if(!window.open(a,"mb",["toolbar=0,status=0,resizable=1,width=440,height=430,left=",(screen.width-440)/2,",top=",(screen.height-430)/2].join(""))){location.href=a}};if(/Firefox/.test(navigator.userAgent)){setTimeout(f,0)}else{f()}};function commonLog(a){var b=window.clog_img=new Image();b.onload=b.onerror=function(){window.clog_img=null};b.src=a+(a.indexOf("?")>0?"&__rnd=":"?")+Math.random();b=null}blogAd.nickTrayAd=function(b,k){k.innerHTML=b.adLink;var j=this,l=['<div id="#{entity}" class="tips_layer1 tips_bg_a" style="z-index:150;position:absolute;top:23px;left:0px;display:none;">','<div id="#{body}" class="tips_bd">','<a id="#{imageLink}" href="" class="link" title="" target="_blank"></a>','<div class="tips_detail"> <span id="#{closeBtn}" class="close" title="关闭">×</span>','<p id="#{userNick}" class="tips_nickname"></p>','<p id="#{tipsTitle}" class="tips_txt"></p>','<p id="#{tipsTxtLink}" class="tips_ad"></p>','<p id="#{tipsBtn}" class="tips_btn"></p>',"</div>","</div>","</div>"].join("");this.relativeNodeId=k.id;this.MARK_ID=1;this.LIMITED=24;var c=this.nodes=this.getTemplateNodes(l);Core.Dom.insertAfter(c.entity,document.body.lastChild);if($IE6&&b.ie6BackgroundPic){c.entity.style.backgroundImage="url("+b.ie6BackgroundPic+")"}else{if(b.backgroundPic){try{c.entity.style.backgroundImage="url("+b.backgroundPic+")"}catch(g){}}}c.imageLink.href=b.imageLinkHref;var a=typeof $nick;if("undefined"==a){a="亲爱的网友"}else{a=$nick}c.userNick.innerHTML="HI，"+a.replace(/</g,"&lt;");c.tipsTitle.innerHTML=b.tipsTitle;if(b.tipsTxtLink){c.tipsTxtLink.innerHTML=b.tipsTxtLink}var i=c.tipsTxtLink.children[0],f=i.style;if(!$IE6&&b.tipsTxtLinkBgPic){f.backgroundImage="url("+b.tipsTxtLinkBgPic+")";f.backgroundRepeat="no-repeat"}else{if($IE6&&b.ie6TipsTxtLinkBgPic){f.backgroundImage="url("+b.ie6TipsTxtLinkBgPic+")";f.backgroundRepeat="no-repeat"}}c.tipsBtn.innerHTML=b.tipsBtn;Core.Events.addEvent(c.closeBtn,function(){j.hide();scope.$channel=null;var m=b.status.adclose;if(m){new Image().src=m}},"click");setTimeout(function(){j.setPos();j.show();j.initResizeEvent()},15);var d=b.status&&b.status.adclose;Core.Events.addEvent(c.entity,function(p){var o=p.target||p.srcElement,m=c.entity;do{if("A"===o.nodeName.toUpperCase()&&(-1!=o.href.indexOf("http"))){j.hide();scope.$channel=null;var n=b.status.adclose;if(n){new Image().src=n}break}}while(o&&(o==m))},"click");if(b.status.adstart){new Image().src=b.status.adstart}if(!b.blogTip){commonLog("http://1090.adsina.allyes.com/main/adfshow?user=AFP6_for_SINA|2012_add|2012_blog_tip&db=sina&border=0&local=yes&js=ie")}else{v7sendLog(b.logCode)}}.$defineProto({setMark:function(){var a=new Date().getHours();var b=24-a;Utils.Cookie.setCookie("blogTipsAd",1,b,"/",".blog.sina.com.cn")},setPos:function(){var a=$E(this.relativeNodeId);var d=Core.Dom.getXY(a);var c=a.offsetWidth,b=this.nodes.entity.style;b.left=parseInt(d[0])+(c-100)+"px";b.top=parseInt(d[1])+23+"px"},show:function(){this.isHidden=false;var a=this.nodes.entity,c=Core.Dom.setStyle;var b=new Ui.TweenStrategy(0,1,0.5,function(g,f,j,i){return -j*(g/=i)*(g-2)+f});b.onTween=function(d){c(a,"opacity",d)};b.onEnd=function(){if(!$IE){c(a,"opacity","none")}else{a.style.filter="none"}};c(a,"opacity",0);a.style.display="block";b.start()},hide:function(){this.setMark();this.isHidden=true;var a=this.nodes.entity,c=Core.Dom.setStyle;var b=new Ui.TweenStrategy(1,0,0.5,function(g,f,j,i){return -j*(g/=i)*(g-2)+f});b.onTween=function(d){c(a,"opacity",d)};b.onEnd=function(){if(!$IE){c(a,"opacity","none")}else{a.style.filter="none"}a.style.display="none"};b.start()},initResizeEvent:function(){var a=this;Core.Events.addEvent(window,function(){if(!a.isHidden){a.setPos()}},"resize")}}).$mixProto(Lib.templateUtils);blogAd.loadNickTrayAd=function(g){var f=Lib.Listener;var i=$E("loginBarActivity")||$E("divPopularize");var c=i.getAttribute("shouldShow"),b=new Date().getDay(),j=Utils.Cookie.getCookie("blogTipsAd");i.style.display="";var a=(b==1||b==3||b==5);if(!a){return}if(j){return}var d="http://simg.sinajs.cn/blog7style/css/module/layer/layer20.css";Utils.Io.loadExternalCSS(d,function(){if(g){if(!g||!g.isShow){return}if(g.logCode){g.logCode=g.logCode+"|"+$UID}blogAd.trayAdHandle=new blogAd.nickTrayAd(g,i);i=null}})};Lib.register("util.loadScript",function(){var b=!0,d=!1,a={};var c=function(f,g){Utils.Io.JsLoad.request(f,{isRemove:d,noreturn:b,onComplete:function(m){a[f].isLoading=d;var k=a[f].cb;for(var l=0,j=k.length;l<j;l++){k[l](m)}a[f].cb=null}})};return function(i,g){var j=a[i];var f=j&&j.cb;if(!j){f=[g];j={isLoading:b,cb:f};a[i]=j;c(i,j)}else{if(j.isLoading){f.push(g)}else{g()}}}});Lib.register("execZhitou",function(b){var a="http://d5.sina.com.cn/litong/zhitou/sinaads/release/sinaads.js";document.createElement("inc");return function(c){b.util.loadScript(a,c)}});blogAd.insertIns=function(f,c,d,b){d=d||"beforeend",b=b||"display:block;";var a='<ins class="sinaads" data-ad-pdps="'+f+'" style="'+(b||"")+'"></ins>';c=c||document.body;return Core.Dom.insertHTML(c,a,d)};$registJob("trayTipsAd",function(){function b(){function i(j){var l=g.firstChild,k=j?"":"none";while(l){if("a"===l.nodeName.toLowerCase()){l.style.display=k}l=l.nextSibling}}var g=$E("loginBarActivity")||$E("divPopularize");g.style.display="";var f=30,d=Core.Dom.getXY(g)[0];i(false);var c=blogAd.insertIns("PDPS000000033238",g,"","display:inline");(window.sinaads||[]).push({element:c,params:{sinaads_tip_top:f,sinaads_tip_left:d,sinaads_success_handler:function(){try{window.BLOG_AD_TIPS=1}catch(j){}},sinaads_fail_handler:function(){i(true);var k=document.referrer;if(k){var l=k.match(/(\:\/\/)(.*?)(\/)/g);k=l&&l[0].replace(/(\:\/\/){0,}(\/){0,}/g,"")}else{k=""}var j="http://blogtj.sinajs.cn/riaapi/afterLoadChannel/after_load_channel.php";Utils.Io.JsLoad.request(j,{GET:{uid:window.$UID,bloguid:scope.$uid,refer:k},onComplete:function(m){if(m&&m.code==="A00006"){data=m.data;data=data&&data.weicaopan&&data.weicaopan.weicaopan_con;blogAd.loadNickTrayAd(data)}}})},sinaads_ad_zindex:590}})}function a(){blogAd.insertIns("PDPS000000033236",$E("module_980").children[0],"beforeend");(window.sinaads||[]).push({})}Lib.execZhitou(function(){b();a()})});$registJob("errorTips",function(){Lib.checkAuthor();function a(b){var c=$C("div");c.innerHTML=b;return c.firstChild}if($isLogin){Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/riaapi/warning.php",{GET:{uid:$UID},onComplete:function(l){if(l&&l.iswarning==1){var c=Utils.Cookie.getCookie("i8t9c"+$UID)!==l.date?"block":"none";var f='<div id="err_i8t9c" class="tb_layer_Y tb_layer_w6" style="display:'+c+';z-index:500;position:absolute;top:-300px;"><div class="tb_layer_arrow" style="margin:0 0;left:219px"></div><div class="tb_layer_Y_main"><div class="tb_mas"><span style="float:right;"><a class="conn" href="javascript:;" onclick="scope.i8t9c()">×</a></span></div><div class="tb_mas">'+l.msg+'<p style="text-align:center;padding:6px;"><input type="button" value="知道了" onclick="scope.i8t9c()" /></p></div></div></div></div>';scope.i8t9c=function(){$E("err_i8t9c").style.display="none";Utils.Cookie.setCookie("i8t9c"+$UID,l.date,8760,"/");Utils.Cookie.setCookie("i8t9c"+$UID,l.date,8760,"/","blog.sina.com.cn")};scope.i8t9c.show=function(){$E("err_i8t9c").style.display="";k()};var b=a(f);document.body.appendChild(b);var j=$E("loginBarActivity"),d;var i=a('<div class="topbar_activity"><a href="javascript:;" onclick="scope.i8t9c&&scope.i8t9c.show();">[公告]</a></div>');j.parentNode.insertBefore(i,j);setTimeout(k,10);Core.Events.addEvent(window,function(){k()},"resize");Core.Events.addEvent(window,function(){setTimeout(function(){var m=document.documentElement.scrollTop+document.body.scrollTop;if(g==m){k()}else{g=m}},30)},"scroll");var g=document.documentElement.scrollTop+document.body.scrollTop;function k(){var n=Core.Dom.getXY(i);var m=b.offsetWidth;b.style.visibility="inherit";b.style.top=n[1]+23+"px";b.style.left=n[0]-m+41+"px"}}}})}});$SYSMSG.extend({A33001:"对方已经被你加为关注了！<br/>请不要重复添加。",A33002:"对方拒绝了你的关注请求！",A33003:"关注已达上限，不能再添加新的关注了！<br/>可以到<a href='http://control.blog.sina.com.cn/blogprofile/attention.php' target='_blank'>关注的人</a>去取消关注一些人，再回来关注吧。",A33004:"关注成功！",A33005:"你不能添加自己为关注！",A33008:"取消关注失败",A33009:"移除关注成功，加黑名单失败",A33010:"对不起，您短时间添加关注过多，请多休息，注意身体！感谢您对新浪博客的支持和关注！",A20013:"您已经发送多条相似内容了哦，请先休息一下吧~",A20014:"已经有很多博主发过相似评论了，换个内容会更精彩~"});$registJob("attenBlogerRank",function(){var u=$E("attenBloggerWrap");if(!u){return}var K="",k="";var f="http://interface.blog.sina.com.cn/riaapi/profile/tj_uid_tag.php";var D=0,C=0,r=0,G=0,I,y,B=0,v=0,c="";var t=Core.String.shorten;var F=0;var d=0;var l=0;var a,o,b,q,i;H();function H(){if(C!=0){K="";D=0;B=0;k="";c=""}C++;if(d===1){var n=$T(u,"span");var j=n.length;for(var m=0;m<j;m++){c=c+n[m].getAttribute("attenUid")+","}}Utils.Io.JsLoad.request(f,{GET:{uid:scope.$uid,type:d,uids:c},onComplete:function(U){l=0;if(U&&U.code==="A00006"){if(!d&&d===0){d=1;I=U.data.tj_user;var Q=I&&I.length;if(Q){for(var O=0;O<I.length;O++){var L=t(I[O].is_v?I[O].v_info.verified_reason:"",18);var S=I[O].is_v?(I[O].v_info.type>0&&I[O].v_info.type<=7?'<img width="15" height="15" align="absmiddle" title="" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon147">':'<img width="15" height="15" align="absmiddle" title="" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon146">'):"";K=K+'<li><dl class="pic30"><dt class="pic" num="'+(D++)+'"><a href="http://blog.sina.com.cn/u/'+I[O].uid+'" onclick="v7sendLog(\'39_01_01_'+$UID+'\')" target="_blank"><img width="30" height="30" alt="" src="'+I[O].image+'"></a></dt><dd class="con"><div class="btn"><a href="javascript:;" onclick="return false;" class="W_btn_b" target="_blank"><span attenUid="'+I[O].uid+'" attenNum="'+(B++)+'">加关注</span></a></div><p class="name"><a href="http://blog.sina.com.cn/u/'+I[O].uid+'" class="S_func1" target="_blank" onclick="v7sendLog(\'39_01_02_'+$UID+"')\">"+t(I[O].uname,10)+S+'</a></p><p class="info">'+L+"</p></dd></dl></li>"}K=K+'<li><p class="ico_hot"><a href="http://blog.sina.com.cn/lm/rank/monthbang/" target="_blank"><img width="48" height="16" src="http://simg.sinajs.cn/blog7style/images/center/newversion/hot.gif" alt=""></a></p></li>';u.innerHTML=K;A(I)}else{u.innerHTML=""}var T=U.data.tj_tag;var M=T&&T.length;if(M){for(var z=0;z<M;z++){k=k+'<li><div class="menuCell_main"><span class="SG_dot"><a href="http://qing.blog.sina.com.cn/tag/'+encodeURIComponent(T[z])+'" target="_blank" onclick="v7sendLog(\'39_01_09_'+$UID+"')\">"+T[z]+'</a></span></div><div class="menuCell_bot"></div></li>'}var P=$E("tuijianTags");if(P){Utils.insertTemplate(P,k,"BeforeEnd")}}}else{var R=U.data.tj_user;var Q=R&&R.length;if(Q){var L=t(R[0].is_v?R[0].v_info.verified_reason:"",18);var S=R[0].is_v?(R[0].v_info.type>0&&R[0].v_info.type<=7?'<img width="15" height="15" align="absmiddle" title="" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon147">':'<img width="15" height="15" align="absmiddle" title="" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon146">'):"";var N='<dl class="pic30"><dt class="pic" num="'+y+'"><a href="http://blog.sina.com.cn/u/'+R[0].uid+'" onclick="v7sendLog(\'39_01_01_'+$UID+'\')" target="_blank"><img width="30" height="30" alt="" src="'+R[0].image+'"></a></dt><dd class="con"><div class="btn"><a href="javascript:;" onclick="return false;" class="W_btn_b" target="_blank"><span attenUid="'+R[0].uid+'" attenNum="'+y+'">加关注</span></a></div><p class="name"><a href="http://blog.sina.com.cn/u/'+R[0].uid+'" class="S_func1" target="_blank" onclick="v7sendLog(\'39_01_02_'+$UID+"')\">"+t(R[0].uname,10)+S+'</a></p><p class="info">'+L+"</p></dd></dl>";u.children[y].style.display="";u.children[y].innerHTML=N;I[y]=R[0];Core.Events.removeEvent(u,E,"click");A(I)}}}},onException:function(){},returnType:"json"})}function A(n){if(F===0){a='<div id="#{cardWrap}" style="display:none;position: absolute; left:567px; z-index:100; top: 760px;" class="c_layer"><div class="bg"><div class="content" id="#{cardContent}" style="height:160;"></div><div class="arrow arrow_r" id="#{cardArrow}" style="top: auto; bottom: 50px;"></div></div></div>';o=Utils.insertTemplate($E("sinablogbody"),a,"BeforeEnd");F=1}b=Core.Dom.getElementsByClass(u,"dt","pic");q=$T(u,"dt");var m,j;Lib.util.hoverJq({elm:q,mouseenter:function(L,N,M){setTimeout(function(){p(N,o,n)},50);m&&clearTimeout(m)},mouseleave:function(L,N,M){j&&clearTimeout(j);j=setTimeout(function(){J(o)},50)},delay:50});var z=[o.cardWrap];Lib.util.hoverJq({elm:z,mouseenter:function(L,M){o.cardWrap.style.display="";j&&clearTimeout(j)},mouseleave:function(L,M){m&&clearTimeout(m);m=setTimeout(function(){J(o)},50)},delay:50});Core.Events.addEvent(u,E,"click")}function E(j){var m=(j&&j.target)||(window.event&&window.event.srcElement);if(m&&m.tagName&&m.tagName.toLowerCase()=="span"){if(!l){l=1;g(m)}}else{return}}function p(n,j,L){var M=parseInt(n.getAttribute("num"));var P=Core.Dom.getXY(n);j.cardWrap.style.top=P[1]-133+"px";j.cardWrap.style.left=P[0]-344+"px";j.cardWrap.style.display="";var z=t(L[M].is_v?L[M].v_info.verified_reason:"",50);var R=L[M].is_v?(L[M].v_info.type>0&&L[M].v_info.type<=7?'<img width="15" height="15" align="absmiddle" title="" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon147">':'<img width="15" height="15" align="absmiddle" title="" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon146">'):"";var m='<p class="c_layer_close"><a href="javascript:;" onclick="return false;" id="close_card"><img width="13" height="13" alt="" src="http://simg.sinajs.cn/blog7style/images/center/newversion/c_layer_close.gif"></a></p><dl class="name"><dt><a href="http://blog.sina.com.cn/u/'+L[M].uid+'" target="_blank" onclick="v7sendLog(\'39_01_01_'+$UID+'\')"><img width="50" height="50" alt="" src="'+L[M].image+'"></a></dt><dd><p><a href="http://blog.sina.com.cn/u/'+L[M].uid+'" target="_blank" onclick="v7sendLog(\'39_01_02_'+$UID+"')\">"+L[M].uname+"</a> "+R+'</p><p class="address">博客访问:'+L[M].pv+"</p><p>博客等级:"+L[M].level+'</p><p style="height:40px;">'+z+'</p><p><a href="http://blog.sina.com.cn/u/'+L[M].uid+'" target="_blank">'+L[M].blog_title+'&gt;&gt;</a></p><div class="btn"><a class="W_btn_b" href="javascript:;" onclick="return false;"><span attenUid="'+L[M].uid+'" attenNum="'+M+'">加关注</span></a></div></dd></dl><div class="clearit"></div>';j.cardContent.innerHTML=m;var O=Core.Dom.getElementsByClass(j.cardWrap,"div","btn");var N=O[0].children[0].children[0];var Q=$E("close_card");Core.Events.addEvent(N,(function(S){return function(){if(!l){l=1;g(S)}}})(N),"click");Core.Events.addEvent(Q,(function(S){return function(){j.cardWrap.style.display="none"}})(Q),"click")}function J(j){j.cardWrap.style.display="none";j.cardContent.innerHTML=""}function g(m){var n;var j=m.getAttribute("attenUid");y=parseInt(m.getAttribute("attenNum"));v7sendLog("39_01_03_"+$UID+"_"+j);new Interface("http://control.blog.sina.com.cn/riaapi/profile/attention_add.php","ijax").request({POST:{uid:scope.$uid,aid:j},onSuccess:function(){},onError:function(Q){var P="";switch(Q.code){case"A11007":P=$SYSMSG.A11007.replace("#{linkNewBlog}","http://login.sina.com.cn/hd/reg_sec.php?entry=blog");winDialog.alert(P,{funcOk:function(){window.open("http://login.sina.com.cn/hd/reg_sec.php?entry=blog","_blank","")}});break;case"A33003":P=$SYSMSG.A33003.replace("#{UID}",$UID);winDialog.alert(P);break;case"A33004":try{var N=m.parentNode.parentNode.parentNode.parentNode}catch(O){}if(N&&N.className==="pic30"){N.style.display="none"}else{o.cardWrap.style.display="none";var M=$T(u,"span");M[y].parentNode.parentNode.parentNode.parentNode.style.display="none"}var L={subText:['<div class="CP_w_cnt SG_txtb">以后对方的动态（发博文，图片，投票等），都可以在<span style="color:red">个人中心</span>查看啦！</div>','<ul class="CP_w_part CP_w_aLine">','<li><a href="http://control.blog.sina.com.cn/blogprofile/index.php?type=3&from=attention" onclick="winDialog.getDialog(\'attention\').hidden();" target="_blank">到个人中心查看关注动态&gt;&gt;</a></li>',"</ul>"].join(""),icon:"03",width:300};try{var z=$E("module_901_attention");z.className="SG_aBtn SG_aBtn_dis";z.innerHTML="<cite onclick=\"Lib.Component.isAttentioned('"+$UID+"', '"+scope.$uid+"');\">已关注</cite>"}catch(O){}P=$SYSMSG.A33004;L.subText=L.subText.replace(/#{UID}/g,$UID);winDialog.alert(P,L,"attention");H();break;default:showError(Q.code)}}})}});Core.Dom.byClass=function(j,f,k){k=k||document;if(k.getElementsByClassName){return k.getElementsByClassName(j)}var g=new RegExp("\\b"+j+"\\b"),b=[],d=k.getElementsByTagName(f),c,a=d.length;for(c=0;c<a;c++){k=d[c];if(k.nodeType===1&&k.className&&g.test(k.className)){b.push(k)}}return b};if(typeof SinaEx==="undefined"){SinaEx={}}SinaEx.findNode=function(a,c,d){for(var b=a[d];b;b=b[c]){if(b.nodeType==1){return b}}return null};SinaEx.prev=function(a){return SinaEx.findNode(a,"previousSibling","previousSibling")};SinaEx.next=function(a){return SinaEx.findNode(a,"nextSibling","nextSibling")};SinaEx.firstChild=function(a){return SinaEx.findNode(a,"nextSibling","firstChild")};SinaEx.parent=function(a,b){b=b.toLowerCase();while(a){if(a.nodeName.toLowerCase()===b){return a}a=a.parentNode}return null};SinaEx.createNode=function(a){var b=document.createElement("div");b.innerHTML=a;return b.firstChild};SinaEx.addClass=function(a,b){var c=a.className;if((" "+c+" ").indexOf(" "+b+" ")===-1){a.className=b+" "+c}};SinaEx.removeClass=function(a,b){var c=(" "+a.className+" ").replace(" "+b+" "," ");a.className=c.replace(/^\s+/,"").replace(/\s+$/,"")};if(document.documentElement.contains){SinaEx.contains=function(d,c){return d.contains?d.contains(c):true}}else{if(document.documentElement.compareDocumentPosition){SinaEx.contains=function(d,c){return d===c||!!(d.compareDocumentPosition(c)&16)}}else{SinaEx.contains=function(d,c){while(c){if(d===c){return true}c=c.parentNode}return false}}}SinaEx.enterLeave=function(b,f,g,d){var i=Core.Events.addEvent,c=null,j=0,a=0;f=f||function(){};g=g||function(){};d=d||0;i(b,function(k){clearTimeout(a);var m=k||window.event,l=m.target||m.srcElement;j=setTimeout(function(){if(c&&SinaEx.contains(c,l)){return}var n=SinaEx.parent(l,"li");if(n){if(c){g(c)}f(n);c=n}else{if(c){g(c);c=null}}},d)},"mouseover");i(b,function(){clearTimeout(j);a=setTimeout(function(){if(c){g(c);c=null}},d)},"mouseout")};!function(g){if(g.Evter){return}function d(j){try{return(new Function("return "+j))()}catch(i){return null}}var c={},a={},f={},b=1;g.Evter={add:function(i,j){if(typeof i==="string"&&typeof j==="function"){if(i.charAt(0)==="-"){i=i.substr(1);a[i]=true}if(c[i]){traceError('Evter handler "'+i+'" has been defined!');return}c[i]=j}},click:function(n,k,m){var l=n.getAttribute("e-name"),o=n.getElementsByTagName("*"),j=o.length;while(j--){o[j].getAttribute("e-name")||o[j].setAttribute("e-name","b")}if(l){if((" "+l+" ").indexOf(" "+k+" ")===-1){n.setAttribute("e-name",l+" "+k)}}else{n.setAttribute("e-name",k)}if(m){this.add(k,m)}},remove:function(i){delete c[i];delete a[i]},fire:function(j,l,m,i){if(a[j]&&l){l.$EID||(l.$EID=" "+(b++));if(f[j+l.$EID]){return}f[j+l.$EID]=true}var k=c[j];k&&k(l,m,i)},data:function(m,n){var o=m.getAttribute("e-data"),l=typeof n;if(l==="undefined"||n===null){return o?d(o):null}else{if(l==="object"){var j,i;if(o){o=d(o);if(typeof o==="object"){for(j in n){o[j]=n[j]}}else{o=n}}else{o=n}n=[];for(j in o){i=o[j];n.push(j+":"+(typeof i==="string"?"'"+i.replace(/'/g,"\\'")+"'":i))}n="{"+n.join(",")+"}"}else{if(l==="string"){n="'"+n.replace(/'/g,"\\'")+"'"}}}m.setAttribute("e-data",n)},free:function(j,i){j&&delete f[i+j.$EID]}};Core.Events.addEvent(document.body,function(p){p=p||g.event;var m=p.target||p.srcElement,o=m,l=o.getAttribute("e-name");if(l==="b"){do{o=o.parentNode;l=o.getAttribute("e-name")}while(l==="b")}if(l){if(a[l]){o.$EID||(o.$EID=" "+(b++));if(f[l+o.$EID]){return}f[l+o.$EID]=true}var n=c[l];if(n){n(o,p,m)}else{var q=l.split(" "),k=0,j=q.length;for(;k<j;k++){l=q[k];if(a[l]){o.$EID||(o.$EID=" "+(b++));if(f[l+o.$EID]){continue}f[l+o.$EID]=true}n=c[l];n&&n(o,p,m)}}}},"click")}(window);Mojie.loadImgCallback=function(b){var d=b.oriImg;var a=b.width,c=b.height;if(a>200){c=Math.floor(200*c/a);a=200}if(c>300){d.parentNode.style.height="300px";d.parentNode.style.overflow="hidden"}d.width=a;d.height=c;b=null};Mojie.checkImageSize=function(d,f){var c,a;for(c=0,a=d.length;c<a;c++){var b=new Image();b.oriImg=d[c];b.onload=function(g){return function(){typeof f==="function"&&f(g)}}(b);b.src=d[c].src}};Core.Dom.parent=function(a,b){b=b.toLowerCase();while(a){if(a.nodeName.toLowerCase()===b){return a}a=a.parentNode}return null};Core.Dom.createElement=function(a){var b=document.createElement("div");b.innerHTML=a;return b.firstChild};Lib.register("sendSuda",function(b){var a="http://www.sinaimg.cn/unipro/pub/suda_s_v851c.js";return function(c){b.util.loadScript(a,c)}});Evter.add("openBlog",function(g,c){Core.Events.stopEvent(c);var k=Core.Dom,j=k.byClass;var p=k.parent(g,"li");var m=Evter.data(p);if(m&&m.type){var l=j("feedText","div",p);if(m.type===5){o(l[0].children);return}l[0].style.display="none";l[1].style.display="";if(m.type===4){n(l[1])}return}if(p.opening){return}p.opening=true;var f='<a class="btn_ico btn_sq" e-name="closeBlog" href="javascript:;"><img e-name="b" width="49" height="20" align="absmiddle" title="收起" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif"></a>'+(m.dig_id?"":'<a class="btn_ico btn_alltxt" href="'+(m.bhref||"javascript:;")+'" target="_blank"><img width="64" height="20" align="absmiddle" title="阅读全文" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif"></a>');Lib.sendSuda(function(){try{SUDA.log("","getfeedarticle")}catch(q){}});Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/feed/getFeedArticle.php",{GET:{blog_id:m.blogid},onComplete:function(q){if(q&&q.data){a(q.data)}p.opening=false},onException:function(){winDialog.alert("展开内容失败，请稍候再试",{icon:"01"});p.opening=false}});m.bhref.indexOf("/s/")>0&&commonLog("http://hits.blog.sina.com.cn/hits?act=4&ref=http%3A%2F%2Fi.blog.sina.com.cn&aid="+m.blogid);function a(v){var u=parseInt(v.type)||-1;if(u<2||u>5){return}Evter.data(p,{type:u});var r="";switch(u){case 3:r=v.body+f;break;case 2:r=b(v);break;case 4:r=d(v);break}var t=j("feedText","div",p)[0];if(u===5){i(t.children,v);return}var q=k.createElement('<div class="feedText"></div>');q.innerHTML=r;t.style.display="none";t.parentNode.insertBefore(q,t.nextSibling);if(u===3){q.onclick=function(z){z=z||window.event;var y=z.srcElement||z.target;if(y.nodeName.toUpperCase()==="IMG"&&y.className==="imgZoomOut"){Evter.fire("closeBlog",p)}};if($IE6){Mojie.checkImageSize(j("imgZoomOut","img",q),function(y){if(y.width>588){y.oriImg.width=588}y=null})}}else{if(u===4){n(q)}}}function b(u){var t="",v;for(var r=0,q=u.body.length;r<q;r++){v=u.body[r];t+='<p class="feedPic_b"><img src="'+v.article_pic+'" e-name="closeBlog" class="imgZoomOut" /></p>'+v.description}return t+u.descrp+f}function d(r){var q='<div class="feedPic_video" e-data="\''+r.swf_url.replace(/[<>'"]/g,"")+'\'">正在打开视频...</div><div class="feedPic_text"><p>'+r.body.replace(/<p>/ig,"").replace(/<\/p>/ig,"")+f+'</p></div><div class="clearit"></div>';return q}function i(q,r){q[1].innerHTML='<img class="imgZoomOut" width="420" src="'+(q[0].children[0].src||"").replace("_150150","_420420")+'" alt="" e-name="closeBlog" />';q[3].innerHTML="<p>"+r.body.replace(/<p.*?>/ig,"").replace(/<\/p>/ig,"")+f+"</p>";o(q)}function o(q){q[0].style.display="none";q[4].style.display="none";q[1].style.display="";q[3].style.display=""}function n(q){var u=j("feedPic_video","div",q)[0];var r=Evter.data(u);var t=new Utils.Flash.swfObject(r,"video",500,365,"9","#00ff00");t.addParam("quality","high");t.addParam("wmode","transparent");t.addParam("allowScriptAccess","never");t.addParam("flashvars","isAutoPlay=true&auto=1&autoPlay="+(r.indexOf("sina.com.cn")>-1?"1":"true"));t.write(u)}});Evter.add("closeBlog",function(c){var d=Core.Dom;var k=d.parent(c,"li");var g=Evter.data(k);var f=d.byClass("feedText","div",k);if(g&&g.type===5){var a=f[0].children;a[0].style.display="";a[4].style.display="";a[1].style.display="none";a[3].style.display="none"}else{f[0].style.display="";f[1].style.display="none";if(g&&g.type===4){var b=d.byClass("feedPic_video","div",f[1]);b[0].innerHTML=""}}var j=d.getXY(k),i=document.body.scrollTop||document.documentElement.scrollTop;if(j[1]<i){document.body.scrollTop=document.documentElement.scrollTop=j[1]}});Utils.Io.TimeoutJsLoad=function(a,b){this._opts={url:"",charset:"utf-8",noreturn:false,noencode:false,timeout:-1,GET:{},onComplete:null,onException:null,type:"blogScript",jsonpParamName:"callback"};if(!a||typeof a!=="string"){throw new Error("url参数不能为空!")}this._opts.url=a;this.isAborted=false;this.scriptIdentifier="";this.varname="";this.loadComplete=false;this.timeObj;Core.System.parseParam(this._opts,b);this.loadScript()};Utils.Io.TimeoutJsLoad.prototype={constructor:Utils.Io.TimeoutJsLoad,__jsonpCounter:(new Date()).getTime(),loadScript:function(){var d=this._opts,a=$C("script"),b=$T(document,"head")[0],g=this,f=this._processUrl();a.async=true;a.src=d.url;a.charset=d.charset;a.id="script"+this.scriptIdentifier;if(d.type==="jsonp"){window[f]=c}else{if(d.type==="blogScript"){a.onload=a.onerror=a.onreadystatechange=c}}function c(j){var k=d.type;if(k==="blogScript"&&a&&a.readyState&&a.readyState!="loaded"&&a.readyState!="complete"){return}g.loadComplete=true;if(k==="jsonp"){window[f]=undefined;try{delete window[f]}catch(i){}}else{if(k==="blogScript"){a.onload=a.onreadystatechange=a.onerror=null}}b.removeChild(a);if(!g.isAborted&&typeof d.onComplete==="function"){g.timeObj&&clearTimeout(g.timeObj);d.onComplete(k==="blogScript"?window[g.varname]:j)}}b.insertBefore(a,b.firstChild);if(d.timeout>0){this.timeObj=setTimeout(function(){g.abortRequest()},d.timeout)}},abortRequest:function(){if(this.loadComplete){return}this.isAborted=true;if(/opera/i.test(navigator.userAgent)&&$E("script"+this.scriptIdentifier)){$E("script"+this.scriptIdentifier).src=""}typeof this._opts.onException==="function"&&this._opts.onException()},_processUrl:function(){var d=this._opts,a=d.url,i=d.GET,c,b=window.parseInt(Math.random()*100000000),g=new Utils.Url(a);for(c in i){g.setParam(c,d.noencode===true?i[c]:Core.String.encodeDoubleByte(i[c]))}this.scriptIdentifier=b;if(d.type==="blogScript"){this.varname=g.getParam("varname")||"requestId_"+b;d.noreturn!==true&&g.setParam("varname",this.varname)}else{if(d.type==="jsonp"){var f="jsonp"+this.constructor.prototype.__jsonpCounter++;g.setParam(d.jsonpParamName,f)}}d.url=g.toString();return f}};Evter.add("playMusic",function(d,c){Core.Events.stopEvent(c);var f=Evter.data(d);if(f.shorturl){var b=d.parentNode.parentNode;var g=b.innerHTML;b.innerHTML="正在打开音乐...";var a=function(){b.innerHTML=g;winDialog.alert("打开失败，请稍候再试",{icon:"01"})};new Utils.Io.TimeoutJsLoad("http://api.t.sina.com.cn/widget/show.jsonp?source=1617465124",{GET:{short_url:f.shorturl,lang:"zh_cn",template_name:$IE?"qingobj":"qingebd",vers:3},type:"jsonp",jsonpParamName:"jsonp",onComplete:function(i){if(i&&i.result){b.innerHTML=i.result}else{a()}},onException:a})}});Utils.template=function(l,j,q){if(!j||!j.length){return""}l=l.replace(/[\r\n\t]/g,"").replace(/\'/g,"\\'").split("{");var n="",k=q!==undefined,g,m=l.length,c,f,a="return '"+l[0]+"'",o,d,b;for(g=1;g<m;g++){f=l[g].split("}");a=a+(f[0].indexOf("$")===-1?"+$."+f[0]:"+("+f[0].replace(/\[|\]/g,"'")+")")+"+'"+f[1]+"'"}c=new Function("$",a);for(g=0,m=j.length;g<m;g++){o=j[g];if(k){d=q(o,g);for(b in d){o[b]=d[b]}}n+=c(o)}return n};Evter.add("like",function(d,c){Core.Events.stopEvent(c);d.blur();var g=Core.Dom;var k=g.parent(d,"li");var i=Evter.data(k);var f=g.byClass("blog_txtlist","div",k);var j=f[0];if(Evter.data(j)===3){Mojie.slideShow(j,80,0,0.4);Evter.data(j,"");if(f.length>1){f[1].style.display=""}return}if(d.className.indexOf("loveon")>-1){b()}else{if(k.liking){return}k.liking=true;Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/admin/digg/post_digg.php",{GET:{action:"0",res_type:1,res_id:i.blogid},onComplete:function(p){if(p&&p.code==="A00006"){d.className="love loveon";var o=$T(d,"em")[0];var l=o.innerHTML.match(/(\d+)/);var n=l?parseInt(l[1]):0;o.innerHTML="("+(n+1)+")"}else{if("A00800"===p.code){var q="对不起，您短时间点击喜欢过多，请多休息，注意身体！感谢您对新浪博客的支持和关注！";winDialog.alert(q,{icon:"01",width:400})}}b();k.liking=false},onException:function(){b();k.liking=false}})}function b(){Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/riaapi/digg/get_digg.php",{GET:{res_id:i.blogid},onComplete:function(l){if(l&&l.data){a(l.data)}},onException:function(){}})}function a(m){if(!m.length){return}var l='<div class="arrow"></div><h6>他们喜欢此内容</h6><div class="piclist">'+Utils.template('<a href="http://blog.sina.com.cn/u/{action_uid}" title="{action_uname}" target="_blank"><img src="{action_img}" alt="" height="40" width="40" /></a>',m)+'</div><div class="clearit"></div>';j.innerHTML=l;Evter.data(j,3);if(f.length>1){f[1].style.display="none"}Mojie.slideShow(j,0,80,0.4)}});App.getArticlesSort=function(a){var b=$C("script");Lib.checkAuthor();b.src="http://hits.blog.sina.com.cn/acate?varname=x&uid="+$UID;b.charset="utf-8";b.onload=b.onerror=b.onreadystatechange=Core.Function.bind2(function(){if(b&&b.readyState&&b.readyState!="loaded"&&b.readyState!="complete"){return}App.ArticlesSort=x;if(a!=null){a(App.ArticlesSort)}b.onload=b.onreadystatechange=b.onerror=null;b.src="";b.parentNode.removeChild(b);b=null},this);document.getElementsByTagName("head")[0].appendChild(b)};Core.Dom.addHTML=function(a,b){a.insertAdjacentHTML("beforeend",b)};if(!$C("div").insertAdjacentHTML){Core.Dom.addHTML=function(b,c){var d=b.ownerDocument.createRange();d.setStartBefore(b);var a=d.createContextualFragment(c);b.appendChild(a)}}var cateDialog=Core.Class.create();cateDialog.prototype={initialize:function(a){this.action=a||false},show:function(){if(typeof editor!="undefined"){editor.blur()}this.initDialog();this.dialog.show();this.dialog.setFixed(true);this.dialog.setAreaLocked(true);this.dialog.setMiddle()},initDialog:function(){var d=this;var f={width:492,height:0,url:"http://control.blog.sina.com.cn/admin/article/article_class_list.php?"+(this.action?"action=editor":"")};Lib.checkAuthor();this.url="http://control.blog.sina.com.cn/admin/article/article_class_save2.php?uid="+$UID+(this.action?"&action=editor":"");this.id=Core.Math.getUniqueId();this.manage=null;this.manage=new cateMng(this.id,this.itemTpl);this.manage.onSuccess=function(j){d.onSuccess(j)};var a=new Ui.Template("<div style='width: #{width}px; height: #{height}px;' id='category_"+this.id+"'></div>");var g={ad:false,drag:true,title:"分类管理",content:a.evaluate(f),shadow:1,width:f.width,height:f.height};var c={};var b=winDialog.createCustomsDialog(g,c);b.addEventListener("hidden",function(){this.destroy()});this.dialog=b;$E("category_"+this.id).innerHTML=this.tpl.join("");var i=this;this.dialog.nodes.btnClose.href="javascript:;";this.dialog.nodes.btnClose.onclick=function(){if(i.manage.getEdit()){winDialog.confirm("是否保存此更改？",{funcOk:function(){i.manage.saveHandler(i.url)},funcCancel:function(){i.close()},funcClose:function(){i.dialog.show()},textOk:"是",textCancel:"否"})}else{i.close()}};this.initEvent()},initEvent:function(){this.manage.nameEvent();this.manage.createEvent();this.manage.dataProvider();this.manage.saveEvent(this.url)},hidden:function(){this.dialog.hidden()},close:function(){this.dialog.hidden()},showOld:function(){this.dialog.show()},reset:function(){window.CateDialog.dialog.setCloseEvent(true);window.CateDialog.dialog.hidden();window.CateDialog.dialog=null;window.CateDialog.init=false},setSize:function(b,a){var c=this.dialog.nodes.content.firstChild;this.dialog.setSize(b,a);c.style.width=b+"px";c.style.height=a+"px"},setCloseEvent:function(a){trace("123123123")},getDialog:function(){return this.dialog},getId:function(){return this.id},getDataList:function(){return this.manage.list},onSuccess:function(a){},init:false,dialog:null,tpl:['<div id="categoryBody">','<div id="categoryTitle">',"</div>",'<div id="categoryHead">',"<table>","<tr>",'<td><input type="text" maxlength="28" value="最多可输入14个中文字符" id="categoryName"/></td>','<td width="80"><a id="categoryCreate" href="javascript:void(0);" class="SG_aBtn SG_aBtnB SG_aBtn_sub"><cite>创建分类</cite></a></td>','<td><span class="SG_txtc">请用中文、英文或数字。</span></td>',"</tr>","</table>",'<div id="errTips"></div>',"</div>",'<form method="post" id="categoryForm" name="form">','<div id="categoryList">','<ul class="clearfix" id="datalist">&nbsp;</ul>','<div class="SG_j_linedot"></div>',"</div>",'<div id="categoryBottom" style="text-align:center">','<a id="categorySave" href="javascript:void(0);" class="SG_aBtn SG_aBtnB SG_aBtn_sub"><cite>保存设置<input type="button" value="保存设置"/></cite></a>',"</div>","</form>","</div>"],itemTpl:['<li class="{class}">','<span class="htit" style="color:#000000" id="cate_{index}">{cate}</span>','<input type="hidden" value="{cate}" name="typename[]" class="catName"/>','<input type="hidden" value="{id}" name="number[]"/>','<span id="ctrl_{index}" class="control">','<div class="manage">','<a class="CP_a_fuc" id="edit_{index}" href="javascript:;" onclick="javascript:window.CateDialog.manage.editCate(this);">[<cite>编辑</cite>]</a>','<a class="CP_a_fuc" id="del_{index}" index="{index}" href="javascript:;" onclick="javascript:window.CateDialog.manage.delCate(this);">[<cite>删除</cite>]</a>',"</div>",'<div class="arrow">','<a id="up_{index}" class="{up_class}" href="javascript:;" onclick="javascript:window.CateDialog.manage.upHandler(this);"/>','<a id="down_{index}" class="{down_class}" href="javascript:;" onclick="javascript:window.CateDialog.manage.downHandler(this);"/>',"</div>","</span>",'<div id="editctrl_{index}" class="writeinfo" style="display:none">','<input id="new_{index}" type="text" value="" /><a class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;"><cite>确定</cite></a><a class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;"><cite>取消</cite></a></div>',"<div/>","</li>"]};var cateMng=Core.Class.create();cateMng.prototype={list:null,edit:false,initialize:function(b,a){this.id=b;this.itemTpl=a;Array.prototype.remove=function(c){if(isNaN(c)||c>this.length){return false}this.splice(c,1)}},nameEvent:function(){var a=this;$E("categoryName").onfocus=function(){if(this.value=="最多可输入14个中文字符"){this.value=""}};$E("categoryName").onblur=function(){var b=/[ ><\\\'\;\"`\|\t\r\n|\u3000]/ig;this.value=this.value.replace(b,"");if(Core.String.trim($E("categoryName").value)==""){this.value="最多可输入14个中文字符";this.edit=false}else{this.edit=true}a.showTips("")};$E("categoryName").onkeyup=function(){var b=Core.String.trim(this.value);if(Core.String.byteLength(b)>28){this.value=Core.String.leftB(b,28)}else{if(b!=this.value){this.value=b}}};a.showTips("")},createEvent:function(){var c=this;var b="";$E("categoryCreate").onclick=function(){if(a()&&$E("categoryName").edit){var d={id:-1,name:$E("categoryName").value};$E("categoryName").value="最多可输入14个中文字符";$E("categoryName").edit=false;c.list.push(d);c.update()}c.showTips(b)};function a(){var f=Core.String.trim($E("categoryName").value);b="";if(f==""||f=="最多可输入14个中文字符"){b="分类名称不能为空"}else{if(f.indexOf("&")!=-1||f.indexOf("＆")!=-1){b="分类名称不能包含&符号"}else{if(c.list.length>=15){b="抱歉！最多可创建15条分类"}else{if(Core.String.byteLength(f)>28){b="最多可输入14个中文字符"}}}}for(var d=0;d<c.list.length;d++){if(c.list[d].name==f){b="您已经添加过此分类";break}}if(b!=""){return false}else{return true}}},saveEvent:function(a){Core.Events.stopEvent();var b=this;$E("categorySave").onclick=function(){b.saveHandler(a)}},saveHandler:function(url){var _this=this;var length=_this.list.length;var cateName=[];var cateId=[];for(var i=0;i<length;i++){var item=_this.list[i];cateName.push(item.name);cateId.push(item.id)}Utils.Io.Ijax.request(url+"&r="+Math.random(),{POST:{typename:cateName.join("|"),number:cateId.join("|")},onComplete:function(res){eval("var result = "+res);try{try{if($E("module_3")){Lib.Component.refresh(3,{width:scope.catedialogwidth||210})}if($E("module_7")){location.reload()}}catch(error){trace(error)}try{window.ArticleCateFuncs.reloadCate(result.msg)}catch(error){}window.CateDialog.hidden()}catch(e){}var r;eval("r="+res);_this.onSuccess(r.msg)},onException:function(res){}})},editCate:function(g){var i=this;var d=g.id.split("_")[1];var b=$E("cate_"+d).innerHTML;var a=$E("cate_"+d).parentNode;$E("ctrl_"+d).className="control hide";a.className=d%2==0?"editName":"cline editName";var c='<div id="editctrl_'+d+'" class="writeinfo"><input id="new_'+d+'" type="text" value="'+b+'"><a class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;"><cite>确定</cite></a><a class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;"><cite>取消</cite></a></div>';a.innerHTML=c;$E("new_"+d).onkeyup=function(){var j=/[ >&<\\\'\,\;\"`\|\t\r\n|\u3000]/ig;var k=Core.String.trim(this.value.replace(j,""));if(k!=this.value){this.value=k}if(k==""){$E("editctrl_"+d).childNodes[1].disabled=true}else{$E("editctrl_"+d).childNodes[1].disabled=false}};$E("new_"+d).onblur=function(){if(Core.String.byteLength(this.value)>=28){this.value=Core.String.leftB(this.value,28)}};$E("editctrl_"+d).childNodes[1].onclick=function(){if($E("new_"+d).value==b){f(b,2)}else{f($E("new_"+d).value,1)}};$E("editctrl_"+d).childNodes[2].onclick=function(){f(b,2)};function f(o,l){var p=o;var n="";if(Core.String.byteLength(p)>28){p=Core.String.leftB(p,28)}if(l==1){for(var k=0;k<i.list.length;k++){if(i.list[k].name==p){n="您已经添加过此分类";break}}}if(n!=""){if(!$E("err_"+d)){Core.Dom.addHTML($E("editctrl_"+d),'<div id="err_'+d+'" class="errTips">'+n+"</div>");a.style.height="60px"}else{$E("err_"+d).value=n}}else{i.list[d].name=p;var j=i.itemTpl.join("");j=j.replace('<li class="{class}">',"");j=j.replace("</li>");var m=i.list[d];j=j.replace(/\{cate\}/ig,m.name);j=j.replace(/\{id\}/ig,m.id);j=j.replace(/\{index\}/ig,d);j=j.replace(/\{up_class\}/,d==0?"up_disabled":"up");j=j.replace(/\{down_class\}/,d==i.list.length-1?"down_disabled":"down");a.innerHTML=j;a.className=d%2==0?"":"cline";a.style.height="30px";if(l==1){i.edit=true}}n=""}},delCate:function(b){var c=this;var a=b.id.split("_")[1];winDialog.confirm("确实要删除此分类吗？删除后不可恢复。",{textOk:"删除",funcOk:function(){c.list.remove(a);c.update()}})},upHandler:function(c){var b=c.id.split("_")[1];if(b>0){var a=this.list[b];this.list[b]=this.list[b-1];this.list[b-1]=a;this.update()}},downHandler:function(d){var b=d.id.split("_")[1];if(b<this.list.length-1){var c=b*1+1;var a=this.list[c];this.list[c]=this.list[b];this.list[b]=a;this.update()}},showTips:function(a){$E("errTips").innerHTML=a},dataProvider:function(){var a=this;App.getArticlesSort(function(f){a.list=f.data;$E("datalist").innerHTML="";for(var c=0;c<a.list.length;c++){var b=a.itemTpl.join("");var d=a.list[c];b=b.replace(/\{cate\}/ig,d.name);b=b.replace(/\{class\}/ig,c%2==0?"":"cline");b=b.replace(/\{id\}/ig,d.id);b=b.replace(/\{index\}/ig,c);b=b.replace(/\{up_class\}/,c==0?"up_disabled":"up");b=b.replace(/\{down_class\}/,c==a.list.length-1?"down_disabled":"down");Core.Dom.addHTML($E("datalist"),b)}})},update:function(){$E("datalist").innerHTML="";for(var b=0;b<this.list.length;b++){var a=this.itemTpl.join("");var c=this.list[b];a=a.replace(/\{cate\}/ig,c.name);a=a.replace(/\{class\}/ig,b%2==0?"":"cline");a=a.replace(/\{id\}/ig,c.id);a=a.replace(/\{index\}/ig,b);a=a.replace(/\{up_class\}/,b==0?"up_disabled":"up");a=a.replace(/\{down_class\}/,b==this.list.length-1?"down_disabled":"down");Core.Dom.addHTML($E("datalist"),a)}if(!this.edit){this.edit=true}},getEdit:function(){return this.edit},onSuccess:function(a){}};var ReblogSuccess=Core.Class.create();ReblogSuccess.prototype={interfaceSave:null,box:null,nodes:null,onClose:null,memoNullText:"说点什么...",articleID:"",initialize:function(){Lib.checkAuthor();this.interfaceSave=new Interface("http://control.blog.sina.com.cn/riaapi/article/quto_onetime.php","ijax");!window.CateDialog&&(window.CateDialog=new cateDialog())},show:function(b,c,a){this.box=c;this.onClose=a;this._initDialog();this.articleID=b||""},save:function(){var b=this,a=this.nodes;this.interfaceSave.request({POST:{version:7,new_cat:a.selCate.value,blog_id:b.articleID,reship:a.txtMemo.value===b.memoNullText?"":a.txtMemo.value},onSuccess:function(c){b.close();b._initLayer()},onError:function(c){winDialog.alert(c.data)},onFail:function(){}})},close:function(){this.onClose&&this.onClose()},_initDialog:function(){var b=this;var a='<div class="arrow"></div><p class="reproduced"><span class="b"></span>你还可以写评论...</p><div class="commentbox"><textarea id="#{txtMemo}" style="color:#c8c8c8;" name="" cols="" rows="">'+this.memoNullText+'</textarea></div><div class="ct_float ct_float_no"><div class="ct_floatL">分类<select id="#{selCate}"><option value="00">默认文章分类</option></select><a id="#{btnShowCate}" href="javascript:;">创建分类</a></div><div class="ct_floatR"><a id="#{btnSave}" href="javascript:;" class="SG_aBtn SG_aBtn_ico"><cite>转载</cite></a></div></div><div class="clearit"></div>';this.box[0].innerHTML="";this.nodes=Utils.insertTemplate(this.box[0],a,"AfterBegin");Core.Events.addEvent(this.nodes.btnSave,function(){b.verified()&&b.save()});Core.Events.addEvent(this.nodes.btnShowCate,function(){window.CateDialog.onSuccess=function(f,g){Core.Events.stopEvent(g);b.nodes.selCate.length=1;var j=f||[],d,c=j.length;for(d=0;d<c;d++){b.addCate(j[d].value,j[d].label)}b.addCate("0","私密博文")};window.CateDialog.show()});this.nodes.txtMemo.onblur=function(){if(this.value.replace(/\s/g,"")===""){this.style.color="#c8c8c8";this.value=b.memoNullText}};this.nodes.txtMemo.onfocus=function(){if(this.value===b.memoNullText){this.style.color="#000000";this.value=""}};this._initCateList()},_initLayer:function(){var b='<div class="pop_reserved" id="layerWrap" style="display:none;"><img src="http://simg.sinajs.cn/blog7style/images/center/newversion/ico_reserved.jpg" width="20" height="17" alt="" />转载成功！</div>';var d={css:{"z-index":"5002",position:$IE6?"absolute":"fixed",top:"50%",left:"50%"}};var a=new BackShadow(0.4);a.show();if(!$E("layerWrap")){Utils.insertTemplate(document.body,b,"BeforeEnd");var c=$E("layerWrap");c.style.display="";if($IE6){Core.Events.addEvent(window,function(){f(c)},"scroll")}f(c)}else{$E("layerWrap").style.display=""}setTimeout(function(){a.destroy();$E("layerWrap").style.display="none";s},1000);function f(j){var g=190,i=110;j.style.marginLeft=g/2*(-1)+"px";if($IE6){j.style.top=document.documentElement.scrollTop+parseInt(Math.abs((document.documentElement.offsetHeight-i)/2),10);delete d.css.top}else{j.style.marginTop=i/2*(-1)+"px"}Core.Dom.setStyle2(j,d.css)}},verified:function(){var a=this.nodes;if(Core.String.byteLength(a.txtMemo.value)>2000){winDialog.alert("评论内容必须是1000中文或2000字符以内，请重新输入。");return false}return true},_initCateList:function(c){Core.Events.stopEvent(c);var a=this.nodes,b=this;a.selCate.length=1;App.getArticlesSort(function(){var g=x.data,f,d=g.length;for(f=0;f<d;f++){b.addCate(g[f].id,g[f].name)}b.addCate("0","私密博文")})},addCate:function(f,a,b){var c=this.nodes.selCate;var d=$C("option");d.value=f;d.innerHTML=a;c.appendChild(d)}};Evter.add("reblog",function(a){var f=Core.Dom;var k=f.parent(a,"li");var g=Evter.data(k);var b=f.byClass("blog_txtlist","div",k);var i=b[0];if(Evter.data(i)===1){Mojie.slideShow(i,150,0);Evter.data(i,"");if(b.length>1){b[1].style.display=""}return}var j=Core.Dom.getXY(k);var c=Core.Dom.getXY(a);d();function d(){var l=new ReblogSuccess();l.show(a.getAttribute("sblogid")||g.blogid,b,function(){var p=$T(a,"em")[0];var n=p.innerHTML.match(/(\d+)/);var o=n?parseInt(n[1]):0;p.innerHTML="("+(o+1)+")";i.style.display="none";Evter.data(i,"");if(b.length>1){b[1].style.display=""}$E("feedWrap").style.zoom=1});var m=f.byClass("arrow","div",k);m[0].style.right=600-(c[0]-j[0])+"px";Evter.data(i,1);if(b.length>1){b[1].style.display="none"}Mojie.slideShow(i,0,150)}$E("feedWrap").style.zoom=1});Core.String.encodeHTML=function(a){var b=document.createElement("div");b.appendChild(document.createTextNode(a));return b.innerHTML.replace(/\s/g,"&nbsp;")};var Tabs=Core.Class.create();Tabs.prototype={initialize:function(a,c){c=c||{};var b=c.className||"";this.tabsArr=[];this.htmlEle=$C("ul");this.htmlEle.className=b;a.appendChild(this.htmlEle)},add:function(a){this.tabsArr.push(a);this.htmlEle.appendChild(a.element);Core.Events.addEvent(a.element,Core.Function.bind3(this.swapTags,this,[a]))},swapTags:function(b){if(b.isFocus==false){for(var a=0;a<this.tabsArr.length;a++){this.tabsArr[a].setAbort()}b.setFocus()}else{return}}};var Tab=Core.Class.create();Tab.prototype={isShow:true,initialize:function(c,b){this.id=Core.Math.getUniqueId();this.option=b||{};var a=b.isFocus||false;this.className=b.className||"";this.focus=b.onfocus?[b.onfocus]:[];this.abotrts=b.onabort?[b.onabort]:[];this.element=$C("li");if(b.cls){this.element.className=b.cls}a?this.setFocus():this.setAbort();this.element.innerHTML=c},setAbort:function(){if(this.isFocus==false){return}if(this.option.cls){this.element.className=this.option.cls}else{this.element.className=""}this.isFocus=false;this.onabort()},setFocus:function(){this.element.className=this.className;this.isFocus=true;this.onfocus()},onabort:function(){for(var a=0;a<this.abotrts.length;a++){this.abotrts[a]()}},onfocus:function(){for(var a=0;a<this.focus.length;a++){this.focus[a]()}},addOnAbort:function(a){this.abotrts.push(a)},addOnFocus:function(a){this.focus.push(a)},hidden:function(){this.element.style.display="none"},hidden:function(){this.element.style.display="none";this.isShow=false},show:function(){this.element.style.display="block";this.isShow=true}};scope.faceTemplate=['<table id="#{entity}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">插入表情</strong>','<cite><a id="#{btnClose}" href="javascript:;" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">','<div class="faceItemContent">','<div class="bigface">','<div id="#{faceTab}" class="faceSidebar">',"</div>",'<div id="#{faceContent}" class="faceShowAll">',"</div>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join("");Lib.Face=Core.Class.create();Lib.Face.prototype={dialog:null,dialogNodes:null,tabs:null,faceConfig:null,template:null,txtContentArea:null,x:0,y:0,isShowed:false,_isInitDialog:false,insertImageFile:"",initialize:function(a,b){var c=this;this.txtContentArea=a;this.template=b;window.$insertFace=function(f,d){c.insertFace(f,d)}},load:function(){var a=this;this.dialog=new Dialog(this.template||scope.faceTemplate);this.dialogNodes=this.dialog.getNodes();this.tabs=new Tabs(this.dialogNodes.faceTab);Core.Events.addEvent(this.dialog.entity,function(){Core.Events.stopEvent()},"mousedown");Core.Events.addEvent(document.body,function(){a.hidden()},"mousedown");this.initFaceConfig(function(){if(a.tabs.tabsArr[0]){a.tabs.tabsArr[0].setFocus()}Core.Events.addEvent(a.dialogNodes.btnClose,function(){a.hidden()},"mousedown");a.onInitialized()});this._isInitDialog=true},initFaceConfig:function(a){var b=this;Utils.Io.JsLoad.request("http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig.js?varname=smileConfig&"+(new Date()).getTime(),{onComplete:function(c){b.faceConfig=c;b.initFaceData();if(a){a()}},charset:"gb2312"})},initFaceData:function(){var a,b=this;for(a in this.faceConfig){this.addTab(a,this.faceConfig[a]["name"],this.faceConfig[a]["data"])}},onInitialized:function(){},textWatchOn:function(){var a=this.txtContentArea;var b=function(){if(a.createTextRange){a.caretPos=document.selection.createRange().duplicate()}};Core.Events.addEvent(a,b,"keyup");Core.Events.addEvent(a,b,"focus");Core.Events.addEvent(a,b,"select");Core.Events.addEvent(a,b,"click")},addTab:function(b,d,a){var f=this;var c=new Tab('<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+b+'.gif" height="20" width="20" align="absmiddle"><span><a href="#" onclick="return false;">'+d+"</a></span><em>("+a.length+")</em>",{isFocus:false,className:"cur"});c.addOnAbort(function(){c.content.style.display="none"});c.addOnFocus(function(){if(!c.isShowed){c.isShowed=true;c.content=$C("ul");c.content.innerHTML=f._getTabContent(b,a);f.dialogNodes.faceContent.appendChild(c.content)}c.content.style.display=""});this.tabs.add(c)},_getTabContent:function(d,b){var g=[],f;var c,a=b.length;for(c=0;c<a;c++){f=b[c]["name"];f=Core.String.byteLength(f)>8?Core.String.leftB(f,6)+"...":f;g.push("<li><a onclick=\"$insertFace('"+b[c]["code"]+"','"+b[c]["name"]+'\');return false;" href="#"><img style="width:50px;height:50px;" title="'+b[c]["name"]+'" src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+b[c]["code"]+'T.gif"/></a><span>'+f+"</span></li>")}return g.join("")},insertFace:function(d,c){this.insertImageFile=d+"T.gif";this.onInsert();if(!this.txtContentArea){return}var a="[emoticons="+d+"]"+c+"[/emoticons]";if($IE){if(this.txtContentArea.createTextRange&&this.txtContentArea.caretPos){var b=this.txtContentArea.caretPos;b.text=b.text.charAt(b.text.length-1)==" "?a+" ":a;this.txtContentArea.focus()}else{this.txtContentArea.value+=a;this.txtContentArea.focus()}}else{if(this.txtContentArea.setSelectionRange){var i=this.txtContentArea.selectionStart;var g=this.txtContentArea.selectionEnd;var j=this.txtContentArea.value.substring(0,i);var f=this.txtContentArea.value.substring(g);this.txtContentArea.value=j+a+f}else{this.txtContentArea.value+=a}}this.hidden();return false},onInsert:function(){},setPosition:function(a,b){this.x=a;this.y=b;this.dialog.setPosition({x:a,y:b})},show:function(){!this._isInitDialog&&this.load();this.dialog.show();this.isShowed=true},hidden:function(){this.isShowed=false;this.dialog.hidden()}};App.insertSmile=Core.Class.create();App.insertSmile.prototype={initialize:function(a,b,c){this.btnShowFaceEditor=$E(b);this.txtComment=$E(a);this.callback=c;this.faceEditor=new Lib.Face(this.txtComment)},set:function(b,c){this.btnShowFaceEditor=$E(c);this.txtComment=$E(b);var g=this;g.faceEditor.txtContentArea=this.txtComment;if(g.faceEditor.isShowed){g.faceEditor.hidden()}else{if(!g.faceEditor.isLoad){g.faceEditor.load();g.initFace();g.faceEditor.isLoad=true}var d="cmscnt_"+g.txtComment.id.split("_")[2];var a=Core.Dom.getLeft($E(d));var f=Core.Dom.getTop(g.btnShowFaceEditor)+g.btnShowFaceEditor.offsetHeight+10;g.faceEditor.setPosition(a,f);g.faceEditor.show()}if(g.faceEditor.txtContentArea.isWatched==null){g.faceEditor.textWatchOn();g.faceEditor.txtContentArea.isWatched=true}},initFace:function(){var a=this;Core.Events.addEvent(this.faceEditor.dialogNodes.btnClose,function(){a.faceEditor.hidden()},"mousedown");Core.Events.addEvent(document.body,function(){a.faceEditor.hidden()},"mousedown");Core.Events.addEvent(this.faceEditor.dialog.entity,function(){Core.Events.stopEvent()},"mousedown")}};Core.Math.getRandomNumber=function(c,b){if(isNaN(c)||isNaN(b)||c<0&&b<0){return null}var d=Math.ceil(Math.min(c,b));var a=Math.floor(Math.max(c,b));d=d>0?d:0;return Math.round(d+Math.random()*(a-d))};App.textareaAutoHeight=function(b,a){$E(b).setAttribute("fakeClass",a);var c;if($E("fakeTextarea")==null){c=$C("textarea");c.id="fakeTextarea";c.className=a;document.body.appendChild(c)}var d=function(j){var g=Core.Events.getEvent();var k=g.target||g.srcElement;var f=k.getAttribute("fakeClass");var i=$E("fakeTextarea");if(i.className!=f){i.className=f}setTimeout(function(){i.value=k.value;!isNaN(i.scrollHeight)&&(k.style.height=Math.max(i.scrollHeight,39)+"px")},10)};Core.Events.addEvent(b,d,"keyup");Core.Events.addEvent(b,d,"propertychange");Core.Events.addEvent(b,d,"input")};$SYSMSG.extend({B36001:"操作失败，此博文不存在或被删除。",B36002:"验证码错误，请重新输入。",B36003:"请输入昵称。",B36004:"登录名或密码错误。",B36005:"呢称不能使用此类特殊词汇，请重新输入。",B36006:"昵称必须是8个中文或16个字符以内，且不能为纯数字，请重新输入。",B36007:"呢称不能使用此类特殊词汇，请重新输入。",B36008:"不能3秒内连续发评论，请梢后再试。",B36009:"不能发内容重复的评论。",B36020:"暂无评论。",B36021:"暂无评论。",B36022:"评论内容必须是1000中文或2000字符以内，请重新输入。",B36023:"对不起，黑名单已达到上限",B36024:"对方拒绝了你的评论。",B36031:"操作失败，此评论不存在或被删除。",B36032:"操作失败，此评论不存在或被删除。",B36033:"操作失败，此评论不存在或被删除。",B36041:"请输入回复内容。",B36042:"回复内容必须是1000中文或2000字符以内，请重新输入。",B36043:"操作失败，自己不能回复自己的评论。",B36101:"操作失败，此博文不存在或被删除。",B36102:"评论发布失败，此博文设置不允许评论。",B36103:"操作失败，此评论不存在或被删除。",B36104:"评论已发布，需要审核后才能显示，请稍候…",B36113:"博主已关闭匿名评论，请登录后再评论",B36105:"请输入评论内容。",B36106:"请输入验证码。",B36107:"请输入登录名。",B36108:"请输入密码。",B36109:"读取中，请稍候…",B36110:"读取失败，请刷新。",B36111:"确定要删除此评论吗？删除后不可恢复。",B36112:"确定要删除此回复吗？删除后不可恢复。",B36201:"确定要删除此评论吗？删除后不可恢复。",B36202:"确定要删除此回复吗？删除后不可恢复。",B36203:"请选择要删除的内容。",B36204:"已回复该评论，请勿重复提交。",B36998:"系统维护中，服务暂不可用。",B36999:"对不起，您短时间发表的留言过多，请多休息会，注意身体！感谢您对新浪博客的支持和关注！","36999":"对不起，您短时间发表的留言过多，请多休息会，注意身体！感谢您对新浪博客的支持和关注！",B90001:"抱歉，该文章不允许评论。",A20013:"您已经发送多条相似内容了哦，请先休息一下吧~",A20014:"已经有很多博主发过相似评论了，换个内容会更精彩~",B36205:"请登录后在回复评论",B36206:"对不起，您已被对方列入黑名单，无法发评论。",B36207:"请登录后在删除评论",B36208:"评论内容必须是140中文或280字符以内，请重新输入",B36209:"此条评论已被原博主删除",B36210:"博主已关闭评论功能",B36211:"此博文已被博主设为私密",A00004:"此评论不存在或已被博主删除"});Comment2TSina=Core.Class.create();Comment2TSina.prototype={aid:0,data:null,initialize:function(b,a){this.aid=b||0;this.data=a||{};scope.$temp_commCtt=this.data.weibo_content;scope.$temp_commId=this.data.blog_id},writeCommTips:function(){if(!$E("bb_share_"+this.aid)){return}var b="";var a=$E("writeComm_tips_"+this.aid);if(!a){var c=$C("div");c.className="writeComm_tips_box";c.style.display="none";c.innerHTML='<span class="writeComm_tips" id="writeComm_tips_'+this.aid+'"><strong></strong><cite><a href="javascript:;">关闭</a></cite></span>';var g=$E("cms_input_"+this.aid);if(g){g.parentNode.insertBefore(c,g)}else{return}a=c.firstChild;Core.Events.addEvent(a.lastChild,function(){c.style.display="none"},"click");this.bindTipsEvents(a)}var f=a.parentNode,d=a.firstChild;f.style.display="none";if(this.data.re_weibo==="success"){d.innerHTML='评论成功同步到微博，<a href="http://weibo.com/'+this.data.t_sina+'/profile" target="_blank">点此查看</a>';f.style.display="block"}else{if(this.data.re_weibo==="no_bind"){d.innerHTML='评论分享失败，您需要先<a href="javascript:void(0);">绑定微博</a>';f.style.display="block"}}},bindTipsEvents:function(a){Core.Events.addEvent(a.firstChild,function(c){Core.Events.stopBubble(c);if(Core.Events.getEventTarget(c).tagName.toLowerCase()!="a"){return}var b=a.firstChild.lastChild.innerHTML;if(b==="点此查看"){a.parentNode.style.display="none"}else{if(b==="绑定微博"){a.parentNode.style.display="none";this.bindToTSina()}}}.bind2(this),"click")},openStep:function(){var me=this;Utils.Io.Ijax.request("http://control.blog.sina.com.cn/riaapi/tshow/send_cms_weibo.php",{POST:{uid:$UID,blog_id:scope.$temp_commId,content:scope.$temp_commCtt,isphoto:0},onComplete:function(data){data=eval("("+data+")")||{};if(data.code==="A00006"){var tips=$E("writeComm_tips_"+me.aid);tips.parentNode.style.display="block";tips.firstChild.innerHTML='评论成功同步到微博，<a href="http://weibo.com/'+data.data+'/profile" target="_blank">点此查看</a>'}else{if(data.code==="B00001"){winDialog.alert("您的博客还未绑定新浪微博，现在绑定？",{icon:"04",funcOk:function(){me.bindToTSina()}})}else{if(data.code==="A00004"||data.code==="A11007"){me.shareToT()}else{trace("data.code="+data.code);winDialog.alert("网络繁忙，请稍后再试。",{icon:"01"})}}}},onException:function(msg,url){trace("msg="+msg+", url="+url);winDialog.alert("网络繁忙，请稍后再试。",{icon:"01"})}})},bindToTSina:function(){var b=this;var a="http://control.blog.sina.com.cn/t_sina_blog/bind_weibo_form.php?from=js&domain="+document.domain;window.open(a,"mb","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2);window.tOkBack=function(){trace("微博绑定回调ok函数！");winDialog.alert("绑定微博成功",{icon:"03",funcOk:function(){b.openStep()},funcClose:function(){b.openStep()}})};window.tFailBack=function(){trace("微博绑定 fail");winDialog.alert("网络繁忙，请稍后再试。",{icon:"01"})}},shareToT:function(){var g=scope.$temp_commCtt;if(g){var i=encodeURIComponent(g);var d="http://v.t.sina.com.cn/share/share.php?",c="新浪-博客",a="http://blog.sina.com.cn",b="http://v.t.sina.com.cn/share/share.php?searchPic=false&title="+i+"&url="+encodeURIComponent(document.location)+"&source="+c+"&sourceUrl="+encodeURIComponent(a)+"&content=utf-8&appkey=1617465124";window.open(b,"selectionshare","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2)}else{winDialog.alert("分享的内容不能为空",{icon:"01"})}$E("writeComm_tips_"+this.aid).parentNode.style.display="none"}};var showUpTips=function(){winDialog.alert('您可以在<a href="http://get.adobe.com/flashplayer/" target="_blank">此处下载免费的Adobe flash player installer</a>。成功安装程序后，可返回此处查看。',{icon:"01"})};scope.magicCfg={};window.$magicFacePlay=function(f){var i;if(!scope.flashVersion){scope.flashVersion=deconcept.SWFObjectUtil.getPlayerVersion()}i=scope.flashVersion;if(i.major<9){showUpTips();return}Core.Events.stopEvent();var g={alphaNodeId:"alphaNode",containerDiv:"magicFaceCon"};var d=['<div id="magicFaceCon" title="" alt="" style="height:360px; width:360px;">',"</div>"].join("");scope.magicCfg.layer=new Lib.Panel();scope.magicCfg.layer.setTemplate('<div style="position:absolute;z-index:2000;" id="#{panel}" title="" alt="">'+d+"</div>");scope.magicCfg.layer.show();var c="magicFace";var b=function(){scope.magicCfg.shadow=new BackShadow(0.4);scope.magicCfg.shadow.entity.setAttribute("title","点击关闭动画");scope.magicCfg.shadow.entity.setAttribute("alt","点击关闭动画");scope.magicCfg.shadow.entity.onclick=k;Core.Events.addEvent(document,j,"keydown");scope.magicCfg.shadow.show();var q=Core.System.winSize();var l=Core.System.getScrollPos(document);var o=q.width/2-360/2+l[1];var n=q.height/2-360/2+l[0];scope.magicCfg.layer.setPosition(o,n);var p=document.createElement("div");p.id="___flashOverlay";p.style.cssText="cursor:pointer;visibility:hidden;background:white;;z-index:3000;position:absolute;width:360px;height:360px;top:"+n+"px;left:"+o+"px";document.body.appendChild(p);if(document.all){p.style.filter="Alpha(Opacity=0)"}else{p.style.opacity=0}p.style.visibility="visible";Core.Events.addEvent(p,function(){window.open("http://blog.sina.com.cn/myshow2010")});p=null;var m=new Utils.Flash.swfObject("http://www.sinaimg.cn/uc/myshow/blog/misc/gif/"+f+"?t="+Core.Math.getUniqueId(),c,360,360,9,"#FFFFFF");m.addParam("quality","high");m.addParam("wmode","transparent");m.addParam("allowScriptAccess","always");m.write(g.containerDiv)};var k=function(){trace("swf remove!!!");var l=$E(g.containerDiv);if(l){l.innerHTML=""}window.clearInterval(a);Core.Events.removeEvent(document,j,"keydown");try{scope.magicCfg.shadow.close();scope.magicCfg.layer.close();Core.Events.stopEvent()}catch(m){}if($E("___flashOverlay")){document.body.removeChild($E("___flashOverlay"))}};var j=function(l){var m=l.keyCode||l.which||l.charCode;if(m===27){k();Core.Events.removeEvent(document,j,"keydown");Core.Events.stopEvent();return false}};b();var a=window.setInterval(function(){trace("……追踪 进度……");var q=$E(c);var m=0;if(q&&q.PercentLoaded()==100){q.onclick=function(){Core.Events.stopEvent()};trace("swf 加载完毕了………………");var n=q.parentNode;var l=Core.System.getScrollPos(document);var r=Core.System.winSize();var p=r.width/2-n.offsetWidth/2+l[1];var o=r.height/2-n.offsetHeight/2+l[0];scope.magicCfg.layer.setPosition(p,o);scope.magicCfg.layer.show();trace("flash size x="+n.offsetWidth+"  y="+n.offsetHeight);window.clearInterval(a);a=window.setInterval(function(){var v=q.CurrentFrame();var t;try{t=q.TotalFrames()}catch(u){t=q.TotalFrames}if(v<0){return}if(v<t&&m<=v){m=v}else{k()}},80)}},100)};App.smilesTemplate=['<table id="#{entity}" class="CP_w faceItemContent" style="visibility: visible;">','<thead id="#{titleBar}"><tr><th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">插入表情</strong><cite><a id="#{btnClose}"',' href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th></tr></thead>','<tfoot><tr><td class="tLeft"><span></span></td><td class="tMid"><span></span></td>','<td class="tRight"><span></span></td></tr></tfoot>',"<tbody><tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">','<div class="insertface">','<div class="insertface_top">','<h3>热门动漫表情</h3><div class="insertface_search">','<input id="#{searchText}" type="text" class="SG_input" value="输入关键字、动漫形象"',' style="color:#9b9b9a;" maxlength="20" /><a id="#{searchBtn}" href="#" onclick="return false;" ','hidefocue="true" class="SG_aBtn SG_aBtnB"><cite>查找表情</cite></a></div>','<div class="clearit"></div>',"</div>",'<div class="insertface_hot">','<span class="insertface_keyword">热门关键字：<span id="#{hotKeyword}"></span></span>','<span class="insertface_hotslider"></span>',"</div>",'<div class="bigface">','<div class="faceSidebar">','<div id="#{keyCtrl}" class="facekeyword" style="display:none;">','<p><< <a id="#{keyCtrlBack}" href="#" onclick="return false;">返回全部关键字</a></p>','<p>关键字：<span id="#{keyWord}"></span></p></div>','<h3 id="#{allSort}" class="facetitle" style="font-weight:600;"><a href="#"',' onclick="return false;">全部</a></h3>','<div id="#{sortList}" class="facelist"></div>','<div id="#{sortCtrl}" class="facearrow"></div>',"</div>",'<div class="faceShowAll">','<div id="#{smileEmpty}" class="faceShownone" style="display:none;"><p>找不到和关键字相符的表情。','<br /><br /><a id="#{smileEmptyBack}" href="#" onclick="return false;">&lt;&lt;返回首页</a></p></div>','<ul class="faceShowAll_list" id="#{smileList}"></ul>','<div class="SG_page"><ul class="SG_pages">','<li id="#{smilePagePrev}" class="SG_s_pgprev"></li>','<li id="#{smilePageShow}" class="SG_s_pgnum"></li>','<li id="#{smilePageNext}" class="SG_s_pgnext"></li>','<li class="play" id="#{magicTip}">点击<img align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/img_arrow_r.gif">预览动画效果</li>',"</ul></div>","</div>","</div>","</div>",'</td><td class="tRight"><span></span></td>',"</tr></tbody></table>"].join("");App.smilesDialog2=Core.Class.create();App.smilesDialog2.prototype={pageSize:24,defaultConfig:{sortId:"0",htmlTpl:App.smilesTemplate,callback:function(){}},initialize:function(c){this.option=c||{};for(var a in this.defaultConfig){if(this.option[a]==null){this.option[a]=this.defaultConfig[a]}}this.dialog=new Dialog(this.option.htmlTpl);this.dialog.setAreaLocked(true);this.dialogNodes=this.dialog.getNodes();this.getKeyWord();if(scope.smilesData!=null){this.data=scope.smilesData;this.dataSettle();this.eventListen()}else{var b=this;var d=Utils.Io.JsLoad.request([{url:"http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig8.js?varname=smileConfig"}],{onComplete:function(f){scope.smilesData=f;b.data=f;b.dataSettle();b.eventListen()},onException:function(){}})}return this},dataSettle:function(g,b){g=g||this.data;b=b||9;this.tabsData=[];this.allData=[];for(var f in g){var d=g[f];d.sortId=f;this.tabsData.push(d);for(var c=0,a=d.data.length;c<a;c++){d.data[c].sid=f;d.data[c].sname=d.name}this.allData=this.allData.concat(d.data)}if(this.allDataBack==null&&this.allData.length>0){this.allDataBack=this.allData.slice(0)}this.showTab(1,b);if(this.dialogNodes.smileList.childNodes.length==0){this.showAll()}},children:function(b){var c=[];for(var a=0;b[a];a++){if(b[a].nodeType==1){c.push(b[a])}}return c},showTab:function(f,b){f=f||1;b=b||9;this.dialogNodes.sortList.innerHTML="";this.dialogNodes.smileList.innerHTML="";Core.Dom.setStyle(this.dialogNodes.sortList,"height",b==9?"279px":"217px");this.tabs=new Tabs(this.dialogNodes.sortList);this.tabsObject={};var j=this;for(var g=0;g<b;g++){var m=(f-1)*b;if(this.tabsData[m+g]==null){break}var k=this.tabsData[m+g].sortId;var l=this.tabsData[m+g].name;var c=this.tabsData[m+g].data;var d=new Tab('<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+k+'.gif" height="20" width="20" align="absmiddle"><div><span><a href="#" onclick="return false;" title="'+l+'">'+l+"</a></span><em>("+c.length+")</em></div>",{isFocus:false,className:"cur"});d.addOnAbort(Core.Function.bind3(function(i){},null,[d]));d.addOnFocus(Core.Function.bind3(function(p,o,r,i){j.showSmile(r,1,j.pageSize);j.currentTab=p;j.dialogNodes.allSort.style.fontWeight=400;if(!j.isFromUp){var n=scope.$pageid;if(n){var q=scope.isFromtheCommonhzh;if(q){v7sendLog($_GLOBAL.faceChooseTable[n][q]+"_16_020_"+i,n,"")}}}j.isFromUp=null},null,[d,m+g,c,k]));this.tabsObject[k]=d;this.tabs.add(d)}var a=Math.ceil(this.tabsData.length/b);if(a>0){this.showTabPage(f||1,a,b)}else{this.dialogNodes.sortCtrl.innerHTML=""}},showSmile:function(b,g,a){var n=this;a=a||this.pageSize;var p=this;var c=b;var q=c.length;var r=Math.ceil(q/a);var t=document.createDocumentFragment();var k;this.dialogNodes.smileList.innerHTML="";this.dialogNodes.magicTip.style.cssText="display:none;";for(var f=0;f<a;f++){var m=c[(g-1)*a+f];if(m==null){break}var j=$C("li");var o=$C("a");o.href="#";o.onclick=function(){return false};o.onmousedown=Core.Function.bind3(function(i,v,u){p.hide();p.option.callback(i,v,u)},null,[m.code,m.name,m.swf||null]);o.innerHTML='<img style="width:50px;height:50px;" src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+m.code+'T.gif" alt="'+m.name+'" title="'+m.name+'" />';j.appendChild(o);o.setAttribute("key",m.code);var l=$C("span");l.title=m.name;l.innerHTML=Core.String.byteLength(m.name)>8?Core.String.leftB(m.name,6)+"…":m.name;j.appendChild(l);if(m.swf){var d=$C("div");d.innerHTML='<a href="#"   onclick="window.$magicFacePlay(\''+m.swf+'\');return false;"><img height="13" title="播放表情" align="absmiddle" width="14" alt="" src="http://simg.sinajs.cn/blog7style/images/common/img_arrow_r.gif"></a>';d.className="arr_r";j.appendChild(d);this.dialogNodes.magicTip.style.cssText="display:block;"}t.appendChild(j);Core.Events.addEvent(o,(function(i){return function(){var u=scope.$pageid;if(u){var v=scope.isFromtheCommonhzh;if(v){v7sendLog($_GLOBAL.faceChooseTable[u][v]+"_16_010_"+i.getAttribute("key"),u,"")}}}})(o),"mousedown")}this.dialogNodes.smileList.appendChild(t);if(q>a){if(g==1){this.dialogNodes.smilePagePrev.innerHTML="上一页"}else{this.dialogNodes.smilePagePrev.innerHTML="";k=$C("a");k.href="#";k.onclick=function(){return false};k.onmousedown=function(){p.showSmile(c,g-1,a)};k.innerHTML="上一页";this.dialogNodes.smilePagePrev.appendChild(k)}this.dialogNodes.smilePageShow.innerHTML=g+"/"+r;if(g>=r){this.dialogNodes.smilePageNext.innerHTML="下一页"}else{this.dialogNodes.smilePageNext.innerHTML="";k=$C("a");k.href="#";k.onclick=function(){return false};k.onmouseup=function(){p.showSmile(c,g+1,a)};k.innerHTML="下一页";this.dialogNodes.smilePageNext.appendChild(k)}}else{this.dialogNodes.smilePagePrev.innerHTML="";this.dialogNodes.smilePageShow.innerHTML="";this.dialogNodes.smilePageNext.innerHTML=""}},showTabPage:function(d,c,f){this.dialogNodes.sortCtrl.innerHTML="";this.dialogNodes.smilePagePrev.innerHTML="";this.dialogNodes.smilePageShow.innerHTML="";this.dialogNodes.smilePageNext.innerHTML="";var b=this;var a;if(d==1){if(d!=c){this.dialogNodes.sortCtrl.innerHTML='<a href="#" onclick="return false;" title="向上" class="up_off"></a>';a=$C("a");a.href="#";a.onclick=function(){return false};a.title="向下";a.className="down";a.onmousedown=function(){b.showTab(d+1,f);b.showAll()};this.dialogNodes.sortCtrl.appendChild(a)}else{}}else{if(d<c){a=$C("a");a.href="#";a.onclick=function(){return false};a.title="向上";a.className="up";a.onmousedown=function(){b.showTab(d-1,f);b.showAll()};this.dialogNodes.sortCtrl.appendChild(a);a=$C("a");a.href="#";a.onclick=function(){return false};a.title="向下";a.className="down";a.onmousedown=function(){b.showTab(d+1,f);b.showAll()};this.dialogNodes.sortCtrl.appendChild(a)}else{a=$C("a");a.href="#";a.onclick=function(){return false};a.title="向上";a.className="up";a.onmousedown=function(){b.showTab(d-1,f);b.showAll()};this.dialogNodes.sortCtrl.appendChild(a);Core.Dom.addHTML(this.dialogNodes.sortCtrl,'<a href="#" onclick="return false;" title="向下" class="down_off"></a>')}}},eventListen:function(){var d=this;var c=d.dialogNodes.searchText;var i=d.dialogNodes.searchBtn;var f=d.dialogNodes.keyCtrlBack;var a=d.dialogNodes.allSort;var b=d.dialogNodes.smileEmptyBack;Core.Events.addEvent(document.body,function(k){var j=Core.Events.getEvent(),l=($IE)?j.srcElement:j.target;if(d.dialogNodes.entity!=null&&(Core.Dom.contains(d.dialogNodes.entity,l)==false||k==true)){d.hide()}});Core.Events.addEvent(this.dialogNodes.btnClose,function(){d.hide()});Core.Events.addEvent(c,function(){if(Core.String.trim(c.value)=="输入关键字、动漫形象"){c.value="";c.style.color="#000"}c.select()},"focus");Core.Events.addEvent(c,function(){if(Core.String.trim(c.value)==""){c.value="输入关键字、动漫形象";c.style.color="#9b9b9a"}},"blur");Core.Events.addEvent(c,function(l){var j=Core.Events.getEvent();var k=j.which||j.keyCode;var m=Core.String.trim(c.value);if(k==13&&m!=""){d.searchKey(m)}},"keydown");Utils.Form.limitMaxLen(c,20);Core.Events.addEvent(i,function(){if(c.value=="输入关键字、动漫形象"||c.value==""){}else{d.searchKey(c.value);c.focus()}});var g=function(){d.dataSettle(d.data,9);d.dialogNodes.keyCtrl.style.display="none";d.dialogNodes.smileEmpty.style.display="none";d.dialogNodes.smileList.style.display="";d.dialogNodes.searchText.value="输入关键字、动漫形象";d.dialogNodes.searchText.style.color="#9b9b9a"};Core.Events.addEvent(f,g);Core.Events.addEvent(b,g);Core.Events.addEvent(a,function(){d.showAll()})},showAll:function(){this.showSmile(this.allData,1,this.pageSize);this.dialogNodes.allSort.style.fontWeight=600;if(this.currentTab!=null){this.currentTab.setAbort()}},setSort:function(a,b){this.isFromUp=a;this.option.sortId=a;this.option.callback=b;if(a==0){this.dialogNodes.allSort.style.fontWeight=600;this.dataSettle()}else{this.dataSettle();this.tabs.swapTags(this.tabsObject[a])}},getKeyWord:function(){if(this.keywordData!=null){return}var a=this;var b=Utils.Io.JsLoad.request("http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileKeywordConfig.js?varname=smileKeywordConfig",{onComplete:function(c){a.keywordData=c;var d=c.E___00000000000||"顶|路过|哭|啦啦|美女";var n=document.createDocumentFragment();d=d.split("|");for(var f=0,l=d.length;f<l;f++){var k=$C("a");k.href="#";k.onclick=function(){return false};k.onmousedown=Core.Function.bind3(function(i){a.searchKey(i)},null,[d[f]]);k.innerHTML=d[f];if(d[f]=="魔法表情"){var g=$C("img");g.style.cssText="height:15px; width:15px;";g.setAttribute("align","absmiddle");g.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif";g.className="SG_icon SG_icon68 img_m";n.appendChild(g)}n.appendChild(k)}if(a.dialogNodes.hotKeyword.innerHTML==""){a.dialogNodes.hotKeyword.appendChild(n)}var j="";for(var m in c){if(m!="E___00000000000"){j+="∑"+m+"§"+c[m]}}a.keywordStr=j},onException:function(){}})},searchKey:function(f){var d=f.replace(/([\\^$*+?{}.|])/gi,"\\$1");var l=new RegExp("∑([^§]+)§[^∑]*"+d+"[^∑]*","gi");var b=[];this.keywordStr.replace(l,function(o,i){b.push(i)});b=b.join(",");var k={};var a=this.allDataBack;var n=a.length;var m=0;for(var g=0;g<n;g++){if(b.indexOf(a[g].code)!=-1||a[g].sname.indexOf(f)!=-1||a[g].name.indexOf(f)!=-1){if(k[a[g].sid]==null){k[a[g].sid]={name:a[g].sname,data:[]}}k[a[g].sid].data.push(a[g]);m++}}var j=scope.$pageid;if(m==0){this.dialogNodes.smileEmpty.style.display="";this.dialogNodes.smileList.style.display="none";if(j){var c=scope.isFromtheCommonhzh;if(c){v7sendLog($_GLOBAL.faceChooseTable[j][c]+"_16_030_"+encodeURIComponent(f),j,"")}}}else{this.dialogNodes.smileList.style.display="";this.dialogNodes.smileEmpty.style.display="none";if(j){var c=scope.isFromtheCommonhzh;if(c){v7sendLog($_GLOBAL.faceChooseTable[j][c]+"_16_031_"+encodeURIComponent(f),j,"")}}}this.dataSettle(k,7);this.dialogNodes.keyCtrl.style.display="";this.dialogNodes.keyWord.innerHTML=f.split("").join("<wbr/>");Core.Dom.setStyle(this.dialogNodes.sortList,"height","217px")},setPosition:function(a,b){this.x=a;this.y=b;this.dialog.setPosition({x:a,y:b})},show:function(){this.dialogNodes.searchText.value="输入关键字、动漫形象";this.dialogNodes.searchText.style.color="#9b9b9a";this.dialog.show()},hide:function(){this.dialog.hidden();this.dialogNodes.keyCtrl.style.display="none"}};App.insertSmilesForm2=Core.Class.create();App.insertSmilesForm2.prototype={defalutConfig:{sortCount:6,clickCallback:function(){},recommCount:8},initialize:function(b){this.option=b||{};if(this.option.sortNode==null){return}for(var a in this.defalutConfig){if(this.option[a]==null){this.option[a]=this.defalutConfig[a]}}if(scope.smilesData==null){this.getSmilesData()}else{this.data=scope.smilesData;this.renderUI()}},getSmilesData:function(){var a=this;var b=Utils.Io.JsLoad.request([{url:"http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig8.js?varname=smileConfig"}],{onComplete:function(c){scope.smilesData=c;a.data=c;a.renderUI()},onException:function(){}})},renderUI:function(){var b=this;var c=1;var n=[];var o=[];var v;var g=document.createDocumentFragment();var a=$C("div");var u=$C("span");var t=$C("div");a.className="facestyle";for(var y in this.data){if(c==1){v=this.data[y]||{data:{}};v=v.data}if(c<=this.option.sortCount){var f=this.data[y].name;var m=$C("a");m.href="#";m.setAttribute("key",y);m.onclick=function(){Core.Events.stopEvent();return false};m.onmousedown=Core.Function.bind3(function(i){App.insertSmilesDialog2(i,b.option.clickCallback,b.option.positionNode,b.option.arrPosPix)},null,[y]);m.hideFocus=true;m.innerHTML='<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+y+'-25.gif" alt="'+f+'" title="'+f+'" />';a.appendChild(m);c++}else{break}}var q=new Date().getTime();a.id="recomm_"+q;g.appendChild(a);u.className="SG_more";var j=$C("a");j.href="#";j.onclick=function(){Core.Events.stopEvent();return false};j.onmousedown=(function(i){return function(){App.insertSmilesDialog2(0,b.option.clickCallback,b.option.positionNode,b.option.arrPosPix);var z=scope.$pageid;if(z){var A=i.parentNode.parentNode.id.split("_")[0];if(A){scope.isFromtheCommonhzh=$_GLOBAL.faceCountMoreLinkTable[z][A][1];v7sendLog($_GLOBAL.faceCountMoreLinkTable[z][A][0]+"_07_000_000",z,"")}}}})(j);j.innerHTML="更多>>";u.appendChild(j);g.appendChild(u);t.className="clearit";g.appendChild(t);$E(this.option.sortNode).appendChild(g);if($E(this.option.recommNode)!=null){g=document.createDocumentFragment();for(var p=0;p<this.option.recommCount;p++){f=v[p].name;var l=v[p].code;var r=v[p].swf;m=$C("li");(function(i){m.onclick=Core.Function.bind3(function(A,C,B){b.option.clickCallback(A,C,B);var z=scope.$pageid;if(z){i+="";i=i.length==1?"0"+i:i;v7sendLog($_GLOBAL.faceCountRecommLinkTable[z]+"_"+i+"_010_"+A,z,"")}Core.Events.stopEvent();return false},null,[l,f,r])})(p+8);m.hideFocus=true;var k='<a href="#"><img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+l+'T.gif" alt="'+f+'" title="'+f+'" height="50" width="50"/></a>';if(r){k=k+'<div class="arr"><a href="#" onclick="window.$magicFacePlay(\''+r+'\');return false;" ><img src="http://simg.sinajs.cn/blog7style/images/common/img_arrow_r.gif" width="14" height="13" title="播放表情" alt="" align="absmiddle" /></a></div>'}m.innerHTML=k;g.appendChild(m)}$E(this.option.recommNode).appendChild(g)}var d=Lib.children($E("recomm_"+q).childNodes);for(var p=0;d[p];p++){Core.Events.addEvent(d[p],(function(i,z){return function(){var A=scope.$pageid;if(A){var B=i.parentNode.parentNode.id.split("_")[0];if(B){scope.isFromtheCommonhzh=$_GLOBAL.faceCountMoreLinkTable[A][B][1];v7sendLog($_GLOBAL.faceCountMoreLinkTable[A][B][0]+"_0"+z+"_020_"+i.getAttribute("key"),A,"")}}}})(d[p],(p+1)),"mousedown")}c=n=o=v=g=a=u=j=t=l=y=f=m=null}};Lib.children=function(b){var c=[];for(var a=0;b[a];a++){if(b[a].nodeType==1){c.push(b[a])}}return c};App.insertSmilesDialog2=function(d,g,c,b){App.insertSmilesDialog2.callback=g;if(scope.smileDialog==null){scope.smileDialog=new App.smilesDialog2()}scope.smileDialog.setSort(d,g);var f=Core.Dom.getXY($E(c));var a=f[0]+b[0];var i=f[1]+b[1];scope.smileDialog.setPosition(a,i);scope.smileDialog.show()};App.insertSmilesDialog3=function(c,i,a,d,g,l,b,f){fCall=function(n,o,p){setTimeout(function(){var q='<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+n+'T.gif" alt="'+o+'" title="'+o+'"width="50" height="50" />';if(p){q='<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+n+'T.gif" alt="'+o+'" title="'+o+'" swfname="'+p+'"  width="50" height="50" />'}scope.commEditor.insertHTML(b,q)},20)};App.insertSmilesDialog2.callback=fCall;if(scope.smileDialog==null){scope.smileDialog=new App.smilesDialog2()}scope.smileDialog.setSort(0,fCall);var m=Core.Dom.getXY($E(g));var k=m[0]+l[0];var j=m[1]+l[1];scope.smileDialog.setPosition(k,j);scope.smileDialog.show()};App.formInsertSmile2=function(d,k,b,g,j,l,c,i){var a=$E(d);var f=function(){if(a.createTextRange){a.caretPos=document.selection.createRange().duplicate()}};if(!scope.commEditor){scope.commEditor=new commEditor()}scope.commEditor.append(c,d,i);Core.Events.addEvent(a,f,"keyup");Core.Events.addEvent(a,f,"focus");Core.Events.addEvent(a,f,"select");Core.Events.addEvent(a,f,"click");new App.insertSmilesForm2({sortNode:k,clickCallback:function(m,n,o){setTimeout(function(){var p='<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+m+'T.gif" alt="'+n+'" title="'+n+'"width="50" height="50" />';if(o){p='<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+m+'T.gif" alt="'+n+'" title="'+n+'" swfname="'+o+'"  width="50" height="50" />'}scope.commEditor.insertHTML(c,p)},20);if(g){g()}},recommNode:b,positionNode:j||k,arrPosPix:l||[0,0]})};var commEditor=function(b,a){this.fids=[];this.areas={};this.wins={};this.docs={};this.intervals={};this.actions={}};commEditor.prototype={init:function(b,a){var d=this.docs[b];try{d.body.designMode="on"}catch(c){}d.open();d.writeln(this.getEditorHTML("",a));d.body.contentEditable=true;d.close()},lazyInit:function(b,a){var c=this;return function(){var d=c.docs[b];if(d.body.getAttribute("inited")){return}trace("执行一次:"+b);c.init(b,a);c.bindListener(b);d.body.setAttribute("inited","yes")}},append:function(b,a,g){g=g||{};g.cssStr=g.cssStr||"";if(!g.interval){g.interval={}}if(!g.interval.before){g.interval.before=function(){}}if(!g.interval.after){g.interval.after=function(){}}var f=$E(b);this.wins[b]=f.contentWindow;this.actions[b]=g;var c=this;function d(){try{c.docs[b]=f.contentWindow.document;c.areas[b]=$E(a);if($IE){c.docs[b].body.onclick=c.lazyInit(b,g.cssStr)}else{(c.lazyInit(b,g.cssStr))()}}catch(i){setTimeout(d,150)}}d()},frameFilter:function(a){var c=false;var b=a.innerHTML;b=b.replace(/<script[\s\S]*<\/script>/ig,"");b=b.replace(/<style[\s\S]*<\/style>/ig,"");b=b.replace(/<!-{2,}[\s\S]*?-{2,}>/g,"");b=b.replace(/<([^>]+).*?>/ig,function(f,g){var d=g.split(" ")[0].toLowerCase();switch(d){case"/p":return"<br>";case"br":return f;case"img":if(f.toLowerCase().indexOf("http://www.sinaimg.cn/uc/myshow/blog")>0||f.toLowerCase().indexOf("http://simg.sinajs.cn/blog7style/images/common")>0){if(f.toLowerCase().indexOf("t.gif")==-1&&f.toLowerCase().indexOf("img_arrow_r.gif")==-1){return""}return f}else{return""}default:return""}});b=b.replace(/\n/g,"");a.innerHTML=b},bindListener:function(a){var g=this.docs[a];var d=this.areas[a];var f=this.wins[a];var i=this.actions[a];var c=this;if($IE){g.onkeydown=function(){var j=f.event;if(j.keyCode==8){var k=c.getFocusElement(a);if(k&&k.tagName.toUpperCase()=="IMG"){k.parentNode.removeChild(k);j.keyCode=0;j.returnValue=false}}}}Core.Events.addEvent(g.body,(function(j){return function(k){c.intervals[a]=setInterval(function(){i.interval.before(a,d);c.clearFrameHTML(j);var m=j.getElementsByTagName("img");for(var l=0;m[l];l++){m[l].removeAttribute("style");m[l].removeAttribute("height");m[l].removeAttribute("width")}i.interval.after(a,d)},400)}})(g.body),"focus");Core.Events.addEvent(g.body,(function(j){return function(k){clearInterval(c.intervals[a])}})(g.body),"blur");if(i.normal){for(var b in i.normal){Core.Events.addEvent(g.body,i.normal[b],b)}}},clearFrameHTML:function(j){var f=this;var c=["a","input"];var k=false;for(var a=0;c[a];a++){if(j.getElementsByTagName(c[a]).length>0){k=true;break}}if(k){f.frameFilter(j)}else{var b=j.getElementsByTagName("img");for(var a=0;b[a];a++){var g=b[a].src.indexOf("http://www.sinaimg.cn/uc/myshow/blog");var l=b[a].src.toLowerCase().indexOf("t.g");var d=b[a].src.indexOf("http://simg.sinajs.cn/blog7style/images/common/img_arrow_r.gif");if((g==-1||l==-1)&&d==-1){f.frameFilter(j);break}}}},getFocusElement:function(c){if($MOZ){var a=this.win.getSelection();var b=a.getRangeAt(0);var d=b.commonAncestorContainer;if(d.tagName){if(d.tagName.toLowerCase()=="body"){return d}}if(!b.collapsed){if(b.startContainer==b.endContainer||(1&&b.startContainer==b.endContainer.parentNode)){if(b.startOffset-b.endOffset<2||1){if(b.startContainer.hasChildNodes()){return b.startContainer.childNodes[b.startOffset]}}}return d.parentNode}else{return d.parentNode}}else{var b=this.docs[c].selection.createRange();return b.item?b.item(0):b.parentElement()}},clearHTML:function(a){var b=this.docs[a];b.body.innerHTML="";b.body.setAttribute("contenteditable",false);b.body.setAttribute("contenteditable",true)},insertHTML:function(b,i){if($IE){(this.lazyInit(b))()}var g=this.wins[b];var f=this.docs[b];if($IE){try{g.focus();var c=f.selection.createRange();if(f.selection.type.toLowerCase()=="control"){var a=f.body.createTextRange();a.moveToElementText(c.item(0));c=a}c.pasteHTML(i);c.collapse(false);c.select()}catch(d){}}else{if(($CHROME||$SAFARI)&&(encodeURIComponent(f.body.innerHTML)=="%0A"||f.body.innerHTML=="")){f.body.focus()}this.execCommand("insertHTML",i,b);if(!$CHROME&&!$SAFARI){f.body.focus()}}},execCommand:function(c,b,a){var f=this.wins[a];var d=this.docs[a];f.focus();d.execCommand(c,"",b);f.focus()},handleChange:function(b){var a=this.docs[b].body;this.areas[b].value=this.getHandledStr(a)},getHandledStr:function(a){var c=[];if(a.hasChildNodes()){a=a.childNodes;for(var b=0;a[b];b++){c.push(this.handleDom(a[b]))}}else{c.push(this.handleDom(a))}return c.join("").replace(/\u00A0/ig," ")},handleDom:function(d){if(d.nodeType==3){var g=d.nodeValue;if(!Core.String.trim(g)){return""}return this.reEscapeHTML(g)}else{if(d.nodeType==1){if(d.hasChildNodes()&&((d.childNodes.length!=1)||(d.childNodes.length==1&&d.childNodes[0].tagName))){var c=[];if(d.tagName){var k=d.tagName.toUpperCase();if(k=="DIV"||k=="P"){c.push("\n")}}d=d.childNodes;for(var b=0;d[b];b++){c.push(this.handleDom(d[b]))}return c.join("")}else{var k=d.tagName.toUpperCase();if(k=="IMG"){if(d.src.indexOf("http://www.sinaimg.cn/uc/myshow/blog")!=-1){if(d.src.indexOf("T.g")==-1){return""}var a=d.src.split("T.g")[0];a=a.substring(a.lastIndexOf("/")+1,a.length);var f=d.getAttribute("title");var j=d.getAttribute("swfname");if(!j&&a[0]=="W"){j=a+"S.swf"}if(f){if(j){return"[magicemoticons="+a+" swfname="+j+"]"+f+"[/magicemoticons]"}else{return"[emoticons="+a+"]"+f+"[/emoticons]"}}}else{return""}}else{if(k=="BR"){return"\n"}else{if(k=="DIV"||k=="P"){var g=d.innerHTML||"";return"\n"+this.reEscapeHTML(g)}else{if(k=="SCRIPT"||k=="STYLE"){return""}else{g=d.innerHTML||d.value||"";return this.reEscapeHTML(g)}}}}}}}return""},reEscapeHTML:function(a){a=a.replace(/\n/g,"");a=a.replace(/&nbsp;/g," ");a=a.replace(/&quot;/g,'"');a=a.replace(/&lt;/g,"<");a=a.replace(/&gt;/g,">");a=a.replace(/&amp;/g,"&");return a},getEditorHTML:function(b,c){var a="";a+="<html>";a+="<head>";a+='<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />';a+="<style>		p {			*margin:0.2em auto;		}		body {			margin: 0;			scrollbar-face-color: #ffffff;			scrollbar-highlight-color: #ffffff;			scrollbar-shadow-color: #c0c1bb;			scrollbar-3dlight-color: #c0c1bb;			scrollbar-arrow-color: #c9cbb6;			scrollbar-track-color: #f4f5f0;			scrollbar-darkshadow-color: #ffffff;			scrollbar-base-color: #ffffff;			padding: 10px;			word-wrap: break-word;			overflow: scroll;			overflow-x: auto;			height: 90%;			font-size: 14px;		}		body, td, textarea, input, br, div, span{			font-family:Verdana,'宋体',sans-serif;			line-height:1.5;		}		img{			border: 0;		}		html{			height: 100%;			cursor: text;		}		pre{			white-space:normal;		}		form{margin: 0;}		body table{font-size: 14px;}		.border{ border:1px dashed #cfcfcf;}		</style>		<script>document.domain='sina.com.cn';<\/script>		";a+="</head>";a+="<body style='"+c+"'>";a+=b;a+="</body>";a+="</html>";return a}};var FeedComment=Core.Class.create();FeedComment.prototype={contentLength:2000,Interface:new Interface("http://control.blog.sina.com.cn/riaapi/profile/comment_new.php","jsload"),initialize:function(c,b,a){Lib.checkAuthor();if(!$isAdmin){new Lib.Login.Ui().login(function(){location.reload()});return}this.aid=c;this.count=+b;this.box=a;this.initHTML()},initHTML:function(){var a='<div class="arrow"></div><h6 class="noline"><a href="javascript:;"><img id="cms_smile_#{aid}" title="插入表情" src="http://simg.sinajs.cn/blog7style/images/center/newversion/ico_small.jpg" class="img_yzm" align="absmiddle" height="16" width="17"></a>发评论</h6><div class="commentbox"><textarea style="display:none;" id="cms_content_#{aid}" fakeClass="fake_textarea"></textarea><iframe id="cms_frame_#{aid}" onclick="this.contentWindow.focus();" frameBorder="0" scrolling="no" style="height:60px; background-color: #FFFFFF; border: 1px solid #C7C7C7; width:542px;*width:544px;" src="http://blog.sina.com.cn/main_v5/ria/blank.html"></iframe></div><div class="ct_float"><div class="ct_floatL">分享<a href="javascript:;"><img id="cms_share_#{aid}" title="点击将取消评论分享至微博" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon51" align="absmiddle" height="17" width="17"></a></div><input type="hidden" id="bb_share_#{aid}" value="1" /><div class="ct_floatR"><a id="cms_pub_#{aid}" href="javascript:;" onclick="return false;" class="SG_aBtn SG_aBtn_ico"><cite>发布</cite></a><input id="cms_check_#{aid}" type="text" size="5" class="ipt" type="text" /><span>验证码：</span></div></div><div class="clearit"></div><p class="commentnum" id="tip_#{aid}">还没有评论，快抢沙发吧！</p><ul class="revertlist" id="list_#{aid}" onmouseover="Core.Events.stopEvent(event);" onmouseout="Core.Events.stopEvent(event);"></ul><div class="more_r" id="more_#{aid}"></div>';this.box[0].innerHTML=a.replace(/#\{aid\}/g,this.aid);if(this.count>0){$E("tip_"+this.aid).innerHTML='评论<a href="http://blog.sina.com.cn/s/blog_'+this.aid+'.html#comment" target="_blank">共'+this.count+"条</a>";if(this.count>4){$E("more_"+this.aid).innerHTML='<a href="http://blog.sina.com.cn/s/blog_'+this.aid+'.html#comment" target="_blank">查看更多&gt;&gt;</a></div>'}}this.getComment();this.initUserEvent();return false},getComment:function(){var a=this;this.Interface.request({GET:{cms_id:this.aid},onSuccess:function(c){var b='<li><div class="ct_revert_cont"><p><span class="revert_tit"><a href="http://blog.sina.com.cn/u/{uid}" target="_blank">{uname}:</a></span><span class="revert_time">{cms_pubdate}</span></p><div class="revert_inner">{cms_body}</div></div></li>';$E("list_"+a.aid).innerHTML=Utils.template(b,c)},onError:function(b){showError(b.code)},onFail:function(){}})},initUserEvent:function(){var b=this;var f=Core.Events.addEvent;Core.Dom.insertHTML($E("cms_check_"+this.aid),'<img id="cms_checkimg_'+this.aid+'" class="img_yzm" src="http://interface.blog.sina.com.cn/riaapi/checkwd_image.php?'+Math.random()+'" align="absmiddle" title="点击刷新验证码" />',"BeforeBegin");var g=$E("bb_share_"+this.aid),d=$E("cms_share_"+this.aid);if(Utils.Cookie.getCookie("acp_bb")=="1"){g.value=0;d.className="SG_icon SG_icon86";d.title="点击将评论分享至微博"}f($E("cms_share_"+this.aid),function(i){Core.Events.stopEvent(i);if(g.value=="1"){g.value=0;d.className="SG_icon SG_icon86";d.title="点击将评论分享至微博"}else{g.value=1;d.className="SG_icon SG_icon51";d.title="点击将取消评论分享至微博"}});f($E("cms_pub_"+this.aid),function(i){Core.Events.stopEvent(i);b.postComment();v7sendLog("94_01_03_"+scope.$uid,scope.$pageid,"")});f("cms_check_"+this.aid,function(i){Core.Events.stopEvent(i);b.refreshCheck()},"focus");f("cms_check_"+this.aid,function(k){var i=Core.Events.getEvent(k);var j=i.which||i.keyCode;if(j==13){b.postComment()}},"keyup");f("cms_checkimg_"+this.aid,function(i){Core.Events.stopEvent(i);b.refreshCheck()});if(scope.smile==null){scope.smile=new App.insertSmile("cms_content_"+this.aid,"cms_smile_"+this.aid,function(){})}var c=this;var a={interval:{after:function(j,i){scope.commEditor.handleChange(j);var k=$E(j).contentWindow.document;if(k.body.scrollHeight>k.body.offsetHeight){if(k.body.scrollHeight>410){return}$E(j).style.height=k.body.scrollHeight+"px"}}},cssStr:"padding:0px;overflow-y:auto;font-size: 12px;"};setTimeout(function(){if(!scope.commEditor){scope.commEditor=new commEditor()}scope.commEditor.append("cms_frame_"+c.aid,"cms_content_"+c.aid,a);f("cms_smile_"+c.aid,function(){Core.Events.stopEvent();var i=[-325,14+($IE?-2:0)];App.insertSmilesDialog3("cms_content_"+c.aid,null,null,null,"cms_smile_"+c.aid,i,"cms_frame_"+c.aid,a)})},800)},refreshCheck:function(){$E("cms_checkimg_"+this.aid).src="http://interface.blog.sina.com.cn/riaapi/checkwd_image.php?"+Math.random()},postComment:function(){Core.Events.stopEvent();var b=this;var d=Core.String.trim($E("cms_content_"+b.aid).value);if(d==""){showError($SYSMSG.B36105);return}var a=new Interface("http://control.blog.sina.com.cn/admin/comment/comment_post.php?version=7","ijax");var c={article_id:this.aid,comment:d,uid:scope.$uid,check:$E("cms_check_"+this.aid).value,login_name:$nick,is_photo:"0",t:1,is_t:0,fromicp:1};if($E("bb_share_"+this.aid)){if($E("bb_share_"+this.aid).value=="1"){c.is_t=1;if(Utils.Cookie.getCookie("acp_bb")=="1"){Utils.Cookie.setCookie("acp_bb","",-1,"/",".blog.sina.com.cn")}}else{if(Utils.Cookie.getCookie("acp_bb")!="1"){Utils.Cookie.setCookie("acp_bb","1",2400,"/",".blog.sina.com.cn")}}}if($E(this.aid+"_v2")){c.v2=$E(this.aid+"_v2").value}if($E(this.aid+"_v1")){c.v1=$E(this.aid+"_v1").value}c.v3=2;a.request({POST:c,onSuccess:function(f){b.refreshCheck();b.fakeRender($E("cms_content_"+b.aid).value);$E("cms_check_"+b.aid).value="";scope.commEditor.clearHTML("cms_frame_"+b.aid);$E("cms_content_"+b.aid).value="";$E("cms_frame_"+b.aid).style.height="60px";b.count=b.count+1;$E("tip_"+b.aid).innerHTML='评论<a href="http://blog.sina.com.cn/s/blog_'+b.aid+'.html#comment" target="_blank">共'+b.count+"条</a>";Evter.fire("updataCmsNum"+b.aid,b.count);var g=new Comment2TSina(b.aid,f);g.writeCommTips()},onError:function(f){b.refreshCheck();$E("cms_check_"+b.aid).value="";showError($SYSMSG[f.code])},onFail:function(){showError($SYSMSG.A00001)}})},fakeRender:function(b){if(b==null||b==""){return}var d=/\[emoticons=(E___\w*)\]([^\[]*)\[\/emoticons\]/gi;b=Core.String.encodeHTML(b);b=b.replace(d,function(i,g,j){return'<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+g+'T.gif" style="margin:1px;cursor:pointer;" onclick="window.open(\'http://control.blog.sina.com.cn/admin/myshow/myshow.php?code='+g+'\')" border="0" title="'+j+'" />'});var f=/\[magicemoticons=([E|W]___\w*)\&nbsp\;swfname=(\w+\.swf)\]([^[]*)\[\/magicemoticons\]/gi;var c=['<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/$1T.gif" style="margin:1px;','cursor:pointer;" onclick="window.$magicFacePlay(\'$2\');return false;"',' border="0" title="$3" width="50" height="50"/>'].join("");b=b.replace(f,c);if(b.length>0){var a='<li><div class="ct_revert_cont"><p><span class="revert_tit"><a href="http://blog.sina.com.cn/u/'+scope.$uid+'" target="_blank">'+$nick+':</a></span><span class="revert_time">1分钟前</span></p><div class="revert_inner">'+b+"</div></div></li>";Core.Dom.insertHTML($E("list_"+this.aid),a,"AfterBegin")}}};Evter.add("comment",function(c,a){Core.Events.stopEvent(a);var i=Core.Dom;var m=i.parent(c,"li");var j=Evter.data(m);var d=i.byClass("blog_txtlist","div",m);var k=d[0];if(Evter.data(k)===2){Mojie.slideShow(k,150,0);Evter.data(k,"");if(d.length>1){d[1].style.display=""}Evter.remove("updataCmsNum"+j.blogid);return}var n=$T(c,"em")[0];var b=n.innerHTML.match(/(\d+)/);var l=Core.Dom.getXY(m);var f=Core.Dom.getXY(c);new FeedComment(j.blogid,b?b[1]:0,d);var g=i.byClass("arrow","div",m);g[0].style.right=600-(f[0]-l[0])+"px";Evter.data(k,2);if(d.length>1){d[1].style.display="none"}Mojie.slideShow(k,0,150);Evter.add("updataCmsNum"+j.blogid,function(o){n.innerHTML="("+o+")"})});Evter.add("delete",function(b){var d=Core.Dom;var a=d.parent(b,"li");var c=Evter.data(a);winDialog.confirm("确定要删除此篇博文吗?",{subText:"",funcOk:function(){var f=new Interface("http://control.blog.sina.com.cn/admin/article/article_del_recycle.php","ijax");f.request({POST:{"blog_id[]":c.blogid,uid:scope.$uid},onSuccess:function(j){var i=a.offsetHeight;a.style.overflow="hidden";var g=new Ui.TweenStrategy(i,0,0.7,Ui.Transition.regularEaseOut);g.onTween=function(k){a.style.height=parseInt(k,10)+"px"};g.onEnd=function(){Core.Dom.removeNode(a)};$IE?g.onEnd():g.start()},onError:function(g){winDialog.alert(g.data)},onFail:function(){}})}})});$registJob("feed",function(){var a=Core.Dom.byClass;SinaEx.enterLeave($E("feedWrap"),function(b){var c=a("feeddate","span",b);if(!c){return}c[0].style.display="";c.length>1&&(c[1].style.display="")},function(b){var c=a("feeddate","span",b);if(!c){return}c[0].style.display="none";c.length>1&&(c[1].style.display="none")},200);Mojie.checkImageSize(a("for_check_size","img",$E("feedWrap")),Mojie.loadImgCallback);Evter.add("videoIconHeight",function(){var g=a("videoMicro","div",$E("feedWrap"));var b=[],f;for(var d=0;d<g.length;d++){var c=g[d].children[1];b.push(c)}Mojie.checkImageSize(b,function(i){f=parseInt(i.height);i.oriImg.style.height=f+"px";i.oriImg.previousSibling.style.top=Math.floor(f/2-8)+"px"})});Evter.fire("videoIconHeight")});$registJob("checkNewFeed",function(){var c=$E("guanbofeedout"),d=$E("newFeedTips");setInterval(function(){Utils.Io.JsLoad.request("http://i.blog.sina.com.cn/blog_rebuild/riaapi/profile/feed/getNewFeedNum.php",{GET:{time:$E("lastTime").value},onComplete:function(k){if(k&&k.code==="A00006"){if(k.data&&k.data.count){var l=$E("newFeedTips");l.innerHTML="有"+k.data.count+"条新内容，请点击查看";l.style.display="";c.style.marginBottom="6px"}}}})},180000);var j=setInterval(i,5000);function i(){if(d.style.display!="none"){Mojie.feedTypeList(24,23,21)}else{return}}var a=$E("select"),g=$E("allfeed");var f=a.children[1],b=a.children[0];Evter.add("-getNewFeed",function(k){scope.feedView(0,0,1);k.innerHTML="正在加载数据...";setTimeout(function(){Mojie.feedTypeList(24,23,21)},1000);f.innerHTML="全部";b.className="ct_icon ct_icon17";g.innerHTML="全部"})});$registJob("pages",function(){scope.feedView=function(a,b,c,d){Lib.sendSuda(function(){try{SUDA.log("","blog_iblogfeed_page")}catch(f){}});Lib.checkAuthor();if(!$isAdmin){new Lib.Login.Ui().login(function(){location.reload()});return}new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/feed/getFeedByPage.php","jsload").request({GET:{tj:$E("tj").value,"class":a||"0",type:b||"0",page:c},onSuccess:function(g){var f=$E("feedWrap");f.innerHTML=g.html;f.style.zoom=1;if(d){f.parentNode.parentNode.scrollIntoView(true)}$E("pagerWrap").innerHTML=g.pager||"";$E("tj").value=g.tj||"";if(c===1){$E("lastTime").value=g.lastTime;Evter.free($E("newFeedTips"),"getNewFeed");$E("newFeedTips").style.display="none";$E("guanbofeedout").style.marginBottom="21px"}Mojie.checkImageSize(Core.Dom.byClass("for_check_size","img",f),Mojie.loadImgCallback);Evter.fire("videoIconHeight")},onError:function(f){showError(f.code)}})}});$registJob("dragTag",function(){var f=Core.Events.addEvent,n=Core.Events.removeEvent,j=Core.Events.stopEvent;var c=145;var a,g,m,b,k,d=true,q=false;var o=function(r){r=r||window.event;j(r);if(d){d=false;if(k){k.onclick=function(){return false};k.style.cursor="col-resize"}}b.style.left=(a+(r.clientX||r.pageX||r.x||0)-g)+"px"};var i=function(r){r=r||window.event;j(r);if(!d){d=true;if(k){setTimeout(function(){k.onclick=null;k.style.cursor="pointer";k=null},10)}}var t=parseInt(b.style.left)||0;if(t>2){p(t,0)}else{if(t<m){p(t,m)}else{b=null}}n(document,o,"mousemove");n(document,i,"mouseup")};f($E("feedWrap"),function(r){if(q){return}r=r||window.event;b=r.target||r.srcElement;var t=false;if(b.parentNode.className==="tagList"){t=true;k=b;b=b.parentNode}if(t||b.className==="tagList"){j(r);m=l(b).w;if(m<c){return}m=c-m;g=r.clientX||r.pageX||r.x||0;a=parseInt(b.style.left)||0;f(document,o,"mousemove");f(document,i,"mouseup")}},"mousedown");function l(t){var u,r;if(t.getBoundingClientRect){u=t.getBoundingClientRect();r={w:u.right-u.left}}return r||{w:t.offsetWidth}}function p(t,u){var r=new Ui.TweenStrategy(t,u,0.8);r.onTween=function(y){b.style.left=y+"px"};r.onEnd=function(){b=null;q=false};q=true;r.start()}});$registJob("goToTop",function(){var c=Core.Events.addEvent,f=Core.Dom.opacity;var a=new Ui.Panel(),j='<div class="arr_top"><a id="#{goToTop}" title="返回顶部" href="javascript:;"><img width="59" height="59" src="http://simg.sinajs.cn/blog7style/images/center/newversion/arr_top.gif" alt="" /></a></div>';a.setTemplate('<div id="#{panel}">'+j+"</div>").setFixed(true);a.entity.style.zIndex=500;var i;var d=false;if($E("module_980")){i=Core.Dom.getXY($E("module_980"));i[0]+=280}g();if((document.documentElement.scrollTop||document.body.scrollTop)>0){b()}c(window,function(){var l=document.documentElement.scrollTop||document.body.scrollTop;if(!d&&l>380){b()}if(d&&l<380){k()}},"scroll");c(a.nodes.goToTop,function(){var l=new Ui.TweenStrategy(document.documentElement.scrollTop||document.body.scrollTop,0,0.8,function(n,m,p,o){return -p*((n=n/o-1)*n*n*n-1)+m});l.onTween=function(m){document.documentElement.scrollTop=document.body.scrollTop=m};l.start()});c(window,g,"resize");function b(){d=true;if($IE){a.show();return}f(a.entity,0);a.show();var l=new Ui.TweenStrategy(0,100,0.5);l.onTween=function(m){f(a.entity,m)};l.start()}function k(){d=false;if($IE){a.hidden();return}var l=new Ui.TweenStrategy(100,0,0.5);l.onTween=function(m){f(a.entity,m)};l.onEnd=function(){a.hidden()};l.start()}function g(){var m=document.documentElement.clientWidth,l=document.documentElement.clientHeight;if(!i){i=[];i[0]=m-80}if(parseInt(m)<930){a.setPosition({x:(parseInt(m)-100),y:l-80})}else{a.setPosition({x:i[0],y:l-80})}}});Core.System.parseURL=function(g){var d=/^(?:([A-Za-z]+):(\/{0,3}))?([0-9.\-A-Za-z]+\.[0-9A-Za-z]+)?(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/;var j=["url","scheme","slash","host","port","path","query","hash"];var f=d.exec(g);var b={};for(var c=0,a=j.length;c<a;c+=1){b[j[c]]=f[c]||""}return b};Core.System.queryToJson=function(g,b){g=Core.String.trim(g);if(!g){return{}}var d=g.split("&"),n={},a=function(i){return b?decodeURIComponent(i):i};for(var j=0,k=d.length;j<k;j++){var c=d[j];if(c){var f=c.split("="),m=f[0],l=f[1];if(f.length<2){l=m;m="$nullName"}if(!n[m]){n[m]=a(l)}else{(n[m] instanceof Array)!=!0&&(n[m]=[n[m]]);n[m].push(a(l))}}}return n};Core.System.jsonToQuery=function(f,c){var g=[],b=function(i){return c?encodeURIComponent(i):i};if(typeof f=="object"){for(var j in f){if(j==="$nullName"){g=g.concat(f[j]);continue}if(f[j] instanceof Array){for(var d=0,a=f[j].length;d<a;d++){g.push(j+"="+b(f[j][d]))}}else{(typeof f[j]!="function")&&g.push(j+"="+b(f[j]))}}}return g.length?g.join("&"):""};Lib.register("util.hideContainer",function(){var a=$C("div");a.style.display="none";document.body.appendChild(a);return a});Lib.register("historyM",function(g){var y={};var A=g.util.hideContainer;var F=[];var I=Core.Events.addEvent;var u=Core.System.parseURL;var C=Core.System.queryToJson;var i=Core.System.jsonToQuery;var f=new Core.Events.EventDispatcher(y);var b=Core.Array.foreach;var z,G=true,a=!!history.pushState,d=("onhashchange" in window)&&((typeof document.documentMode==="undefined")||document.documentMode==8);var p,E,v,H,k=parseInt(Math.random()*1000),q="_history$"+k;if(!d&&($IE6||$IE7)){try{p=$C("iframe");p.id=q;A.appendChild(p)}catch(D){}v=function(K){K=encodeURIComponent(K);var L='<html><head></head><body><script>document.domain="'+document.domain+'";document.body.onload = function(){parent.Lib&&parent.Lib.historyM&&parent.Lib.historyM.hashFrameChangeHash&&parent.Lib.historyM.hashFrameChangeHash("'+K+'");};<\/script><body></html>';p.src="javascript:void((function(){var d=document;d.open('text/html');d.domain='"+document.domain+"';d.write('"+L+"');d.close()})())"};H=function(K){K=decodeURIComponent(K);if(!H.first){H.first=1;return}window.location.hash=K;if(K!="#!"+z){m(z=K.substr(2),true)}else{trace(K)}}}var m=function(K,L){v&&(!L)&&v("#!"+K);f.dispatchEvent("popstate",[K,G]);G=true};var J=function(){return decodeURIComponent(window.location.toString())};var o=function(L){var K=u(L||J());return{host:K.host,path:"/"+K.path,query:K.query&&("?"+K.query),hash:K.hash&&("#"+K.hash)}};var n=function(){var K=u(J());if(/^!/.test(K.hash)){return u("http://"+K.host+K.hash.substr(1))}return K};var r=function(K,M){if(!/^\//.test(K)){trace("地址:("+K+") 不为正确的路径,请使用绝对路径; 例：/directory/page.php?params#hash");return}M=Lib.apply({callChange:true,callChangeOnSame:true},M);G=M.callChange;if(a){K=K.replace(/#.*$/,"");if(z==K){if(!M.callChangeOnSame){return}}else{history.pushState(null,null,z=K)}m(K);return}var L="#!"+K;K=K.replace(/#.*$/,"");if(z==K){if(M.callChangeOnSame){m(K)}}else{window.location.hash=L}};var t=function(P,M){if(!P){return}M=M||false;var L=n();var O=C(L.query);for(var N in P){if(P[N]===null){delete O[N]}else{O[N]=P[N]}}L.query=i(O);var K=["/",L.path,(L.query=="")?"":"?",L.query,(L.hash=="")?"":"#",L.hash].join("");r(K,{callChange:M})};var B=function(K,N){if(typeof K=="string"&&!/^!/.test(K)){var O=u(window.location.toString()).hash,M,L=window.location.toString().replace(/#.*$/,"");if(/^!/.test(O)){O=O.replace(/#.*$/,"");M="#"+O+"#"+K}else{M="#"+K}if(N){window.location.hash=M}else{window.location.replace(L+M)}}return j};var c=function(K){K&&F.push(K);return j};z=J().replace(/^http:\/\/.*?\//,"/").replace(/#.*$/,"");if(a){I(window,function(){setTimeout(function(){var K=o(),L=K.path+K.query;if(z!=L){m(z=L)}})},"popstate")}else{var l=function(){var L,K=o();if(/^#!/.test(K.hash)){L=K.hash.substr(2).replace(/#.*$/,"")}else{L=K.path+K.query}if(z!=L){m(z=L)}};if(d){I(window,function(){l()},"hashchange")}else{setInterval(function(){l()},200)}}v&&v("#!"+z);var j={parseURL:n,getURL:o,pushState:r,setQuery:t,setPlainHash:B,onpopstate:c,removePopstate:function(L){var K=Core.Array.findit(L,F);if(K>-1){F.splice(K,1)}},hashFrameChangeHash:H};f.addEventListener("popstate",function(M,K,L){b(F,function(N){try{N(K,L)}catch(O){trace("popstate error: ",O,N)}})});return j});Mojie.renderFeedTypeModule=function(b,g){var c=$E("feedWrap"),a=$E("select"),j=$E("allfeed");c.innerHTML=['<div id="loading" style="text-align:center;padding-top:100px; height:200px">','<img src="http://simg.sinajs.cn/blog7style/images/common/loading.gif">加载中…',"</div>"].join("");var i='<div class="SG_page"><ul id="pagerWrap" class="SG_pages"><li class="SG_pgnext"><a href="javascript:scope.feedView(0,\''+b+'\',2,1);" title="跳转至第2页">下一页&nbsp;&gt;</a></li></ul></div>';var f=a.children[0],d=a.children[1];switch(b){case"all":f.className="ct_icon ct_icon17";d.innerHTML="全部";j.innerHTML="全部";break;case"article":f.className="ct_icon ct_icon21";d.innerHTML="博文";j.innerHTML="博文";break;case"photo":f.className="ct_icon ct_icon19";d.innerHTML="图片";j.innerHTML="图片";break;case"tag":f.className="ct_icon ct_icon22";d.innerHTML="标签";j.innerHTML="标签";break;case"like":f.className="ct_icon ct_icon20";d.innerHTML="喜欢";j.innerHTML="喜欢";break;case"other":f.className="ct_icon ct_icon18";d.innerHTML="其它";j.innerHTML="其它";break}new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/feed/getFeedByPage.php","jsload").request({GET:{tj:$E("tj").value,type:b||"0",page:g},onSuccess:function(l){if(!l.pager&&$E("pagerWrap")){$E("pagerWrap").innerHTML=""}else{if(l.pager&&!$E("pagerWrap")){Utils.insertTemplate(c,i,"AfterEnd")}else{if($E("pagerWrap")){$E("pagerWrap").innerHTML='<li class="SG_pgnext"><a href="javascript:scope.feedView(0,\''+b+'\',2,1);" title="跳转至第2页">下一页&nbsp;&gt;</a></li>'}}}c.innerHTML=l.html;if($E("loading")){var k=$E("loading");Core.Dom.removeNode(k)}c.style.zoom=1},onError:function(k){showError(k.code)}})};$registJob("feedType",function(){var j=$E("allfeed");var g=Lib.historyM;var a,d;var c=$E("subtype");c.onclick=f;if($IE){window.location.hash=""}function f(m,l){var n=(m&&m.target)||(window.event&&window.event.srcElement);if(n&&n.tagName&&n.tagName.toLowerCase()=="a"){var k=n.getAttribute("tabItemType")}else{return}if(!k){return}i();if(d!=k){switch(k){case"all":g.setQuery({type:"all"});break;case"article":g.setQuery({type:"article"});break;case"photo":g.setQuery({type:"photo"});break;case"tag":g.setQuery({type:"tag"});break;case"like":g.setQuery({type:"like"});break;case"other":g.setQuery({type:"other"});break}}else{return}}g.onpopstate(function(){var l=g.parseURL();var k=Core.System.queryToJson(l.query).type;b(k)});function b(k){switch(k){case"all":Mojie.renderFeedTypeModule("all",1);break;case"article":Mojie.renderFeedTypeModule("article",1);break;case"photo":Mojie.renderFeedTypeModule("photo",1);break;case"tag":Mojie.renderFeedTypeModule("tag",1);break;case"like":Mojie.renderFeedTypeModule("like",1);break;case"other":Mojie.renderFeedTypeModule("other",1);break}}function i(){a=window.location.href;if(a){a=a.match(/(type=).*/g);if(a){var k=a.toString().indexOf("=");d=a.toString().substr(k+1)}}}});$registJob("loginStatus",function(){Lib.checkAuthor();var b=Utils.Cookie.getCookie;var d=Utils.Cookie.setCookie;var a=b("_s_loginStatus");var f=b("_s_loginuid");if($isLogin){if(f===$UID){return}}else{if(!a||(a===f)){return}}d("_s_loginuid",$UID||a,(24-new Date().getHours()),"","blog.sina.com.cn");var c="http://control.blog.sina.com.cn/blog_rebuild/riaapi/padblog/padInfo.php?rnd="+Math.random();Utils.Io.JsLoad.request(c,{onComplete:function(){},onException:function(){}})});$registJob("suda",function(){var a=scope&&scope.$pageid&&scope.$pageid==="profile_index";if(typeof _S_pSt=="function"){if(a){v7sendLog("42_01_11")}return}if(a){v7sendLog("42_01_11")}Lib.sendSuda(function(){try{_S_pSt("")}catch(b){}if(a){v7sendLog("42_01_12")}})});$registJob("uatrack",function(){var a=scope.$pageid;var b=Core.Dom.byClass;switch(a){case"editor":var c=b("msnTips_lx","div");if(c){v7sendLog("41_01_05");SUDA.uaTrack("blog_post","v_post1")}break;case"article":case"articleM":var c=$E("module_911");if(c){v7sendLog("41_01_03");SUDA.uaTrack("blog_blogpage","v_qingmodulebj")}break;case"profile_index":var c=b("ad_top","div");if(c){v7sendLog("41_01_01");SUDA.uaTrack("blog_iblog","v_iblog")}}});if(window!=parent){parent.location.href=window.location.href}function main(){v7sendLog("42_01_13");var a=new Jobs();a.add("checkAccount");a.add("tray");a.add("suda");a.add("trayTipsAd");a.add("loginStatus");a.add("feed");a.add("checkNewFeed");a.add("pages");a.add("dragTag");a.add("goToTop");a.add("feedType");a.add("index");a.add("dynaRecomm");a.add("write");a.add("render_push");a.add("insertDynaMoban");a.add("profileUserGuide");a.add("delAttentionTags");a.add("attenBlogerRank");a.add("templateClone",3);a.add("modify_tip");a.add("moduleBind");a.add("errorTips");a.add("baby_headPhoto");a.add("uatrack");a.start()};